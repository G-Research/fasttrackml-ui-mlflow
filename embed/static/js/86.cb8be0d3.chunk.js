"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[86],{13086:function(e,t,n){n.r(t),n.d(t,{ExperimentPage:function(){return ds},default:function(){return cs}});var r=n(91604),a=n(5710),i=n(74116),l=n(26530),s=n(74403),o=n(97206),d=n(93946),c=n(65069);const u=(0,r.createContext)(null),p=e=>{let{children:t,actions:n}=e;const[a,i]=(0,r.useState)([]),[p,m]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null),f=(0,d.Z)(),v=(0,r.useCallback)((e=>{g(null),(()=>{const t=e.map((e=>{const t=n.getExperimentApi(e);return f(t).catch((e=>{l.default.logErrorAndNotifyUser(e)})),t.meta.id}));i((e=>(0,s.isEqual)(t,e)?e:t))})()}),[n,f]),y=(0,r.useMemo)((()=>({fetchExperiments:v,isLoadingExperiment:p,requestError:h,actions:n})),[n,v,p,h]);return(0,c.tZ)(u.Provider,{value:y,children:(0,c.tZ)(o.ZP,{shouldOptimisticallyRender:!0,requestIds:a,children:(e,n,r)=>(m(r.some((e=>a.includes(e.id)&&e.active))),h||r.forEach((e=>{e.error&&g(e.error)})),t)})})};var m=n(98061),h=n(97267),g=n(46276),f=n(72914);var v=n.p+"static/media/permission-denied-lock.16036747d57cd663d7df223781a447b2.svg",y=n(40922);function b(e){let{errorMessage:t}=e;const{theme:n}=(0,y.u)();return(0,c.BX)("div",{className:"center",children:[(0,c.tZ)("img",{style:{height:300,marginTop:80},src:v,alt:"permission denied"}),(0,c.tZ)("h1",{style:{paddingTop:10},children:"Permission Denied"}),(0,c.tZ)("h2",{"data-testid":"error-message",css:(0,f.iv)({color:n.colors.textSecondary},""),children:t||"The current user does not have permission to view this page."})]})}var C=n(25222);const x=e=>{let{artifactLocation:t}=e;return(0,c.tZ)(c.HY,{children:t})},Z=r.memo((e=>{let{experiment:t}=e;return(0,c.BX)("div",{css:w.container,children:[(0,c.BX)(y.T.Text,{color:"secondary",children:[(0,c.tZ)(C.Z,{id:"PZGZHV",defaultMessage:"Experiment ID"}),": ",t.experiment_id]}),(0,c.BX)(y.T.Text,{color:"secondary",children:[(0,c.tZ)(C.Z,{id:"8/7V3S",defaultMessage:"Artifact Location"}),": ",(0,c.tZ)(x,{artifactLocation:t.artifact_location})]})]})})),w={container:e=>({display:"flex",gap:e.spacing.lg})};var S=n(5625),k=n(78064),R=n(98328),M=n(15660),E=n(86169);const T=()=>{const e=(0,r.useContext)(u);if(!e)throw new Error("Trying to use GetExperimentsContext actions outside of the context!");return e},B=r.memo((e=>{let{experiment:t}=e;const n=(0,S.v9)((e=>{const n=(0,M.aq)(t.experiment_id,e);return n?(e=>{var t;return(null===(t=Object.values(e).find((e=>e.getKey()===E._)))||void 0===t?void 0:t.value)||void 0})(n):""})),[a,i]=(0,r.useState)(!1),{actions:{setExperimentTagApi:l}}=T(),s=(0,d.Z)(),o=(0,r.useCallback)((e=>{const n=l(t.experiment_id,E._,e);s(n).then((()=>i(!1)))}),[t.experiment_id,l,s]);return(0,c.tZ)(k.a,{title:(0,c.BX)("span",{css:A.collapsibleSectionHeader,children:[(0,c.tZ)(C.Z,{id:"wDwAdX",defaultMessage:"Description"})," ",!a&&(0,c.tZ)(y.B,{type:"link",onClick:()=>i(!0),children:(0,c.tZ)(C.Z,{id:"2YEXRM",defaultMessage:"Edit"})})]}),forceOpen:a,defaultCollapsed:!n,"data-test-id":"experiment-notes-section",children:(0,c.tZ)(R.U,{defaultMarkdown:n,onSubmit:o,onCancel:()=>i(!1),showEditor:a})})})),A={collapsibleSectionHeader:{height:"32px",lineHeight:"32px"}};var I=n(75677);const L=e=>{let{experiment:t}=e;const n=(0,a.Z)();return(0,c.tZ)(y.T.Text,{size:"xl",dangerouslySetAntdProps:{copyable:{text:t.name,icon:(0,c.tZ)(m.TIy,{}),tooltips:[n.formatMessage({id:"A7R0ii",defaultMessage:"Copy path"}),n.formatMessage({id:"JCboZ7",defaultMessage:"Path copied"})]}}})};var D={name:"1739oy8",styles:"z-index:1"};const N=e=>{let{copyText:t,showLabel:n=!0,icon:a}=e;const[i,l]=(0,r.useState)(!1);return(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"X+boXI",defaultMessage:"Copied"}),dangerouslySetAntdProps:{visible:i},children:(0,c.tZ)(y.B,{type:"primary",onClick:()=>{navigator.clipboard.writeText(t),l(!0),setTimeout((()=>{l(!1)}),3e3)},onMouseLeave:()=>{l(!1)},icon:a,css:D,children:n&&(0,c.tZ)(C.Z,{id:"1Iq+NW",defaultMessage:"Copy"})})})};var O={name:"490tlg",styles:"display:flex;gap:4px"};const P=e=>{let{copyText:t}=e;return(0,c.BX)("div",{css:O,children:[(0,c.tZ)(y.h,{readOnly:!0,value:t,"data-test-id":"copy-box"}),(0,c.tZ)(N,{copyText:t})]})},H=e=>{let{visible:t,onCancel:n,link:r}=e;return(0,c.tZ)(m.u_l,{title:(0,c.tZ)(C.Z,{id:"ktiuki",defaultMessage:"Get Link"}),visible:t,onCancel:n,children:(0,c.tZ)(P,{copyText:r})})},X=()=>{const[e,t]=(0,r.useState)(!1);return(0,c.BX)(c.HY,{children:[(0,c.tZ)(H,{link:window.location.href,visible:e,onCancel:()=>t(!1)}),(0,c.tZ)(y.B,{type:"primary",onClick:()=>t(!0),"data-test-id":"share-button",children:(0,c.tZ)(C.Z,{id:"2oFAO4",defaultMessage:"Share"})})]})};var z=n(3969);var U={name:"ny5p0o",styles:"margin-left:16px"},_={name:"158icaa",styles:"margin-left:4px"};const V=r.memo((e=>{let{experiment:t}=e;const n=(0,r.useMemo)((()=>t.name.split("/").pop()),[t.name]),a=(0,z.E)();return(0,c.tZ)(I.m,{title:(0,c.BX)("div",{css:F.headerWrapper,children:[n," ",(0,c.tZ)(L,{experiment:t})," ",a&&(0,c.BX)("a",{href:a,target:"_blank",rel:"noreferrer",children:[(0,c.tZ)(y.B,{css:U,type:"link",size:"small",children:(0,c.tZ)(C.Z,{id:"d78wwA",defaultMessage:"Provide Feedback"})}),(0,c.tZ)(y.X,{css:_})]})]}),breadcrumbs:[],children:(0,c.tZ)(X,{})})})),F={sendFeedbackPopoverContent:{display:"flex",maxWidth:250,flexDirection:"column",alignItems:"flex-end"},headerWrapper:e=>({display:"inline-flex",gap:e.spacing.sm,alignItems:"center"})},W=r.memo((e=>{let{experiments:t}=e;const n=(0,r.useMemo)((()=>(0,c.tZ)(C.Z,{id:"Dhn7Mb",defaultMessage:"Displaying Runs from {numExperiments} Experiments",values:{numExperiments:t.length}})),[t.length]);return(0,c.tZ)(I.m,{title:n,breadcrumbs:[],children:(0,c.tZ)(X,{})})}));var K=n(53033),j=n(13558);const $=(e,t)=>{const{experiments:n}=t,r=n.map((e=>e.experiment_id)),a=r.length>1,i=Object.values(e.entities.runInfosByUuid).filter((e=>{let{experiment_id:t}=e;return r.includes(t)})).map((e=>{let{run_uuid:t}=e;return t})),{modelVersionsByRunUuid:l,runUuidsMatchingFilter:s}=e.entities,o=((e,t,n)=>{let{lifecycleFilter:r=K.VW.ACTIVE,modelVersionFilter:a=K.CN.ALL_RUNS,datasetsFilter:i=[]}=n;const{modelVersionsByRunUuid:l}=t.entities;return e.map((e=>[(0,M.hQ)(e,t),(0,M._g)(e,t)])).filter((e=>{let[t,n]=e;return r===K.VW.ACTIVE?"active"===t.lifecycle_stage:"deleted"===t.lifecycle_stage})).filter((e=>{let[t,n]=e;return a===K.CN.ALL_RUNS||(a===K.CN.WITH_MODEL_VERSIONS?t.run_uuid in l:a===K.CN.WTIHOUT_MODEL_VERSIONS?!(t.run_uuid in l):(console.warn("Invalid input to model version filter - defaulting to showing all runs."),!0))})).filter((e=>{let[t,n]=e;return!i||0===i.length||!!n&&n.some((e=>{const t=e.dataset.name,n=e.dataset.digest,r=e.tags?e.tags.find((e=>"mlflow.data.context"===e.key)):void 0;return i.some((e=>{let{name:a,digest:i,context:l}=e;return a===t&&i===n&&(r?l===r.value:void 0===l)}))}))})).map((e=>{let[t,n]=e;return t}))})(i,e,t),d=new Set,c=new Set,u=o.map((t=>e.entities.runDatasetsByUuid[t.run_uuid])),p=o.map((t=>{const n=(0,j.nQ)(t.run_uuid,e),r=Object.values(n||{});return r.forEach((e=>{d.add(e.key)})),r})),m=o.map((t=>{const n=Object.values((0,M.Qf)(t.run_uuid,e));return n.forEach((e=>{c.add(e.key)})),n})),h=o.map((t=>(0,M.Ml)(t.run_uuid,e))),g=r[0];return{modelVersionsByRunUuid:l,experimentTags:a?{}:(0,M.aq)(g,e),runInfos:o,paramsList:m,tagsList:h,metricsList:p,runUuidsMatchingFilter:s,datasetsList:u,metricKeyList:Array.from(d.values()).sort(),paramKeyList:Array.from(c.values()).sort()}};var Y=n(73409),q=n(2570);var Q=n(97150),G=n(54419),J=n(68294);class ee extends r.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.deleteRunApi(t))})),Promise.all(e).catch((()=>{this.props.openErrorModal("While deleting an experiment run, an error occurred.")}))}render(){const e=this.props.selectedRunIds.length;return(0,c.tZ)(J.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Delete Experiment ${l.default.pluralize("Run",e)}`,helpText:(0,c.BX)("div",{children:[(0,c.tZ)("p",{children:(0,c.BX)("b",{children:[e," experiment ",l.default.pluralize("run",e)," will be deleted."]})}),""]}),confirmButtonText:"Delete"})}}const te={deleteRunApi:i.Gd,openErrorModal:i.yQ};var ne=(0,S.$j)(null,te)(ee),re=n(96648);class ae extends r.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.restoreRunApi(t))})),Promise.all(e).catch((e=>{let t="While restoring an experiment run, an error occurred.";e.textJson&&"RESOURCE_LIMIT_EXCEEDED"===e.textJson.error_code&&(t=t+" "+e.textJson.message),this.props.openErrorModal(t)}))}render(){const e=this.props.selectedRunIds.length;return(0,c.tZ)(J.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Restore Experiment ${l.default.pluralize("Run",e)}`,helpText:`${e} experiment ${l.default.pluralize("run",e)} will be restored.`,confirmButtonText:"Restore"})}}const ie={restoreRunApi:i.Y1,openErrorModal:i.yQ};var le=(0,S.$j)(null,ie)(ae),se=n(33871),oe=n.n(se);const de=()=>{const e=(0,Q.UO)(),t=(0,Q.TH)(),n=(0,r.useMemo)((()=>decodeURIComponent(t.search)),[t.search]),a=(0,r.useMemo)((()=>{const e=oe().parse(n.substring(1));if(e.experiments){const t=e.experiments;return(null===t||void 0===t?void 0:t.toString())||""}return""}),[n]);return(0,r.useMemo)((()=>{if(null!==e&&void 0!==e&&e.experimentId)return[null===e||void 0===e?void 0:e.experimentId];if(a)try{return JSON.parse(a)}catch{return l.default.logErrorAndNotifyUser(`Could not parse experiment query parameter ${a}`),""}return[]}),[a,null===e||void 0===e?void 0:e.experimentId])};var ce=n(77909);const ue=e=>{const{lifecycleFilter:t,datasetsFilter:n,modelVersionFilter:r,searchFilter:a,startTime:i,orderByAsc:l,orderByKey:s}=new me;return{...e,lifecycleFilter:t,datasetsFilter:n,modelVersionFilter:r,searchFilter:a,startTime:i,orderByAsc:l,orderByKey:s}},pe=e=>{const{lifecycleFilter:t,modelVersionFilter:n,datasetsFilter:r,searchFilter:a,startTime:i}=e;return Boolean(t!==Y.FJ||n!==Y.oj||0!==r.length||a||i!==Y.wi)};class me{constructor(){this.searchFilter="",this.orderByKey=Y.gB,this.orderByAsc=Y.yG,this.startTime=Y.wi,this.lifecycleFilter=Y.FJ,this.datasetsFilter=[],this.modelVersionFilter=Y.oj,this.selectedColumns=(()=>{const e=[(0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.SOURCE),(0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.MODELS)];return(0,ce.GW)()&&e.push((0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.DATASET)),e})(),this.runsExpanded={},this.runsPinned=[],this.runsHidden=[],this.compareRunsMode=void 0,this.compareRunCharts=void 0}}var he=n(96120),ge=n(39270);const fe={ALL:null,LAST_HOUR:36e5,LAST_24_HOURS:864e5,LAST_7_DAYS:6048e5,LAST_30_DAYS:2592e6,LAST_YEAR:31104e6},ve=(e,t,n,r)=>{const a=t.lifecycleFilter===K.VW.ACTIVE?ge.bW.ACTIVE_ONLY:ge.bW.DELETED_ONLY,{runsPinned:i}=t,l=(e=>{let{orderByKey:t,orderByAsc:n}=e;return t?n?[t+" ASC"]:[t+" DESC"]:[]})(t),s=((e,t)=>{let{startTime:n}=e;const r=fe[n];return n&&r&&"ALL"!==n?"attributes.start_time >= "+(t-r):null})(t,n),o=(e=>{let{datasetsFilter:t}=e;return 0===t.length?null:`dataset.name IN (${t.map((e=>`'${e.name}'`)).join(",")}) AND dataset.digest IN (${t.map((e=>`'${e.digest}'`)).join(",")})`})(t),d=((e,t,n)=>{let{searchFilter:r}=e;const a=[];if(r&&a.push(r),t&&a.push(t),n&&a.push(n),0!==a.length)return a.join(" and ")})(t,s,o),c=(e=>{let{orderByKey:t,searchFilter:n}=e;return!t&&!n||t===Y.XZ.DATE})(t);return{experimentIds:e,filter:d,runViewType:a,orderBy:l,shouldFetchParents:c,pageToken:r,runsPinned:i}};var ye=n(77616),be=n(71186);const Ce=e=>(0,s.isArray)(e)?e.join():e,xe={searchFilter:{deserializeLocalStorage:Ce,deserializeQueryString:Ce},datasetsFilter:{serializeQueryString(e){const t=e.map((e=>{let{name:t,digest:n,context:r}=e;return{name:t,digest:n,context:r}}));return(0,be.g4)(JSON.stringify(t))},deserializeQueryString(e){try{const t=JSON.parse((0,be.DL)(e));return Array.isArray(t)?t:[]}catch{return[]}}},compareRunCharts:{serializeQueryString(e){return(0,be.g4)(JSON.stringify(e))},deserializeQueryString(e){try{const t=JSON.parse((0,be.DL)(e));if(!Array.isArray(t))return;return t}catch{return}}},compareRunsMode:{serializeLocalStorage(){}}},Ze=e=>{const t={...e};for(const r of Object.keys(t)){var n;const e=null===(n=xe[r])||void 0===n?void 0:n.serializeQueryString;e&&(t[r]=e(t[r]))}return t},we=e=>{const t={...e};for(const r of Object.keys(t)){var n;const e=null===(n=xe[r])||void 0===n?void 0:n.serializeLocalStorage;e&&(t[r]=e(t[r]))}return t},Se=Object.keys(new me),ke=(e,t,n,r)=>{if("value"===r){if("true"===e)return!0;if("false"===e)return!1;if(void 0===e)return""}return t(e)},Re=(e,t)=>Object.assign(new me,{...e,...t});function Me(e,t){const n=ye.Z.getStoreForComponent("ExperimentPage",t),r=we(e);n.saveComponentState(r)}function Ee(e){const t=Ze(e);return oe().stringify(t,{addQueryPrefix:!0,arrayFormat:"comma",encodeValuesOnly:!0})}function Te(e,t){let n={...new me};try{const e=ye.Z.getStoreForComponent("ExperimentPage",t).loadComponentState();if((!(r=e).runsExpanded||(0,s.isObject)(r.runsExpanded))&&(!r.selectedColumns||(0,s.isArray)(r.selectedColumns))){const t=(e=>{const t={...e};for(const r of Object.keys(t)){var n;const e=null===(n=xe[r])||void 0===n?void 0:n.deserializeLocalStorage;e&&(t[r]=e(t[r]))}return t})(e);n=Re(n,t)}}catch{l.default.logErrorAndNotifyUser(`Error: malformed persisted search state for experiment(s) ${t}`)}var r;const a=decodeURIComponent(e),i=oe().parse(a,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:ke}),{restData:o,stateData:d}=function(e){const t={},n={};for(const r in e)if(e.hasOwnProperty(r)){const a=Se.includes(r);Object.assign(a?t:n,{[r]:e[r]})}return{stateData:t,restData:n}}(i),c=(e=>{const t={...e};for(const r of Object.keys(t)){var n;const e=null===(n=xe[r])||void 0===n?void 0:n.deserializeQueryString;e&&(t[r]=e(t[r]))}return t})(d);if(!(Object.keys(c).length<1)){const e=Object.assign(new me,c);n=Re(n,e)}return Me(n,t),{state:n,queryString:Ee({...o,...n})}}const Be=(0,r.createContext)(null),Ae=e=>{let{children:t,actions:n}=e;const a=(0,Q.s0)(),i=de(),u=(0,d.Z)(),p=(0,Q.TH)(),[m,h]=(0,r.useState)(""),[g,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)(""),[b,C]=(0,r.useState)(!1),[x,Z]=(0,r.useState)(null),w=(0,r.useMemo)((()=>JSON.stringify(i.sort())),[i]),S=(0,r.useRef)(""),[k,R]=(0,r.useState)(new me),M=(0,r.useRef)([]),E=(0,r.useRef)(""),T=(0,r.useRef)(""),B=(0,r.useRef)(!0),A=(0,r.useCallback)((()=>B.current),[]),I=(0,r.useCallback)((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),a=arguments.length>3?arguments[3]:void 0;const i=Boolean(a);i||(T.current=r);const o=(i?n.loadMoreRunsApi:n.searchRunsApi)(ve(t,e,r,a||void 0));f(!0);const d=u(o).then((e=>{const{value:t}=e;return E.current=t.next_page_token,C(Boolean(t.next_page_token)),((e,t,n)=>{const r=e.filter((e=>e.data.tags.some((e=>e.key===q.vf))));(0,s.chunk)(r,he.mc).forEach((e=>{const r=t({run_id:e.map((e=>e.info.run_id))});n(r)}))})(t.runs||[],n.searchModelVersionsApi,u),M.current.some((e=>e.id===o.meta.id&&!e.active))&&f(!1),t.runs||[]})).catch((e=>{l.default.logErrorAndNotifyUser(e,0),f(!1)}));return h(o.meta.id),d}),[u,n]),L=(0,r.useCallback)((()=>I(k,i,T.current||void 0,E.current||void 0)),[I,k,i]),D=(0,r.useCallback)((()=>{I(k,i)}),[i,I,k]),N=(0,r.useCallback)(((e,t)=>{const n=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=oe().parse(n,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:ke});return Me(e,t),Ee({...r,...e})}(e,w,p.search);S.current=n,p.search!==n&&a(`${p.pathname}${n}`,{replace:t})}),[a,p,w]),O=(0,r.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{forceRefresh:n=!1,preservePristine:r=!1,replaceHistory:a=!1}=t;R((t=>{const r=(0,s.isFunction)(e)?e(t):{...t,...e};var l,o;return!n&&(l=t,o=r,(0,s.isEqual)(l.searchFilter,o.searchFilter)&&(0,s.isEqual)(l.orderByAsc,o.orderByAsc)&&(0,s.isEqual)(l.orderByKey,o.orderByKey)&&(0,s.isEqual)(l.lifecycleFilter,o.lifecycleFilter)&&(0,s.isEqual)(l.startTime,o.startTime)&&(0,s.isEqual)(l.datasetsFilter,o.datasetsFilter))||I(r,i),N(r,a),r})),r||(B.current=!1)}),[i,I,N]),P=(0,r.useCallback)((()=>O({},{forceRefresh:!0,preservePristine:!0})),[O]);(0,r.useEffect)((()=>{if(p.search&&S.current===p.search)return;const{state:e}=Te(p.search,w);O(e,{replaceHistory:!0,forceRefresh:!0,preservePristine:!0})}),[p.search,O,w]);const H=(0,r.useMemo)((()=>({actions:n,searchFacetsState:k,fetchExperimentRuns:D,updateSearchFacets:O,loadMoreRuns:L,requestError:x,isLoadingRuns:g,moreRunsAvailable:b,isPristine:A,refreshRuns:P})),[n,k,D,L,x,g,O,b,A,P]);return(0,c.tZ)(Be.Provider,{value:H,children:(0,c.tZ)(o.ZP,{shouldOptimisticallyRender:!0,requestIds:m?[m]:[],children:(e,n,r)=>(M.current=r,r.forEach((e=>{Z(e.error)})),t)})})},Ie=()=>{const e=(0,r.useContext)(Be);if(!e)throw new Error("Trying to use SearchExperimentRunsContext actions outside of the context!");return e},Le=e=>{let{showDeleteRunModal:t,showRestoreRunModal:n,showRenameRunModal:a,runsSelected:i,onCloseDeleteRunModal:l,onCloseRestoreRunModal:s,onCloseRenameRunModal:o,renamedRunName:d}=e;const{updateSearchFacets:u}=Ie(),p=Object.entries(i).filter((e=>{let[,t]=e;return t})).map((e=>{let[t]=e;return t})),m=(0,r.useCallback)((()=>u({},{forceRefresh:!0,preservePristine:!0})),[u]);return(0,c.BX)(c.HY,{children:[(0,c.tZ)(ne,{isOpen:t,onClose:l,selectedRunIds:p}),(0,c.tZ)(le,{isOpen:n,onClose:s,selectedRunIds:p}),(0,c.tZ)(re.UQ,{runUuid:p[0],onClose:o,runName:d,isOpen:a,onSuccess:()=>m()})]})},De=e=>{let{children:t}=e;return(0,c.tZ)(c.HY,{children:t})},Ne=r.memo((e=>{let{viewState:t,runsData:n,searchFacetsState:a}=e;const{runsSelected:i}=t,{runInfos:l}=n,{lifecycleFilter:s}=a,o=(0,Q.s0)(),[d,u]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!1),[h,g]=(0,r.useState)(!1),[f,v]=(0,r.useState)(""),b=(0,r.useCallback)((()=>{const e=Object.keys(i),t=l.find((t=>t.run_uuid===e[0]));t&&(v(t.run_name),g(!0))}),[l,i]),x=(0,r.useCallback)((()=>{const e=Object.keys(i),t=l.filter((t=>{let{run_uuid:n}=t;return e.includes(n)})).map((e=>{let{experiment_id:t}=e;return t}));o(G.ZP.getCompareRunPageRoute(e,[...new Set(t)].sort()))}),[o,l,i]),Z=(0,r.useCallback)((()=>u(!0)),[]),w=(0,r.useCallback)((()=>m(!0)),[]),S=(0,r.useCallback)((()=>u(!1)),[]),k=(0,r.useCallback)((()=>m(!1)),[]),R=(0,r.useCallback)((()=>g(!1)),[]),M=Object.values(t.runsSelected).filter(Boolean).length,E=M>0,T=1===M,B=M>1;return(0,c.BX)(c.HY,{children:[(0,c.BX)("div",{css:Oe.controlBar,children:[(0,c.tZ)(y.B,{"data-testid":"run-rename-button",onClick:b,disabled:!T,children:(0,c.tZ)(C.Z,{id:"oWPgX7",defaultMessage:"Rename"})}),s===Y.VW.ACTIVE?(0,c.tZ)(y.B,{"data-testid":"runs-delete-button",disabled:!E,onClick:Z,danger:!0,children:(0,c.tZ)(C.Z,{id:"3Rb4sG",defaultMessage:"Delete"})}):null,s===Y.VW.DELETED?(0,c.tZ)(y.B,{"data-testid":"runs-restore-button",disabled:!E,onClick:w,children:(0,c.tZ)(C.Z,{id:"Potju2",defaultMessage:"Restore"})}):null,(0,c.tZ)("div",{css:Oe.buttonSeparator}),(0,c.tZ)(De,{children:(0,c.tZ)(y.B,{"data-testid":"runs-compare-button",disabled:!B,onClick:x,children:(0,c.tZ)(C.Z,{id:"RaGnOQ",defaultMessage:"Compare"})})})]}),(0,c.tZ)(Le,{runsSelected:i,onCloseRenameRunModal:R,onCloseDeleteRunModal:S,onCloseRestoreRunModal:k,showDeleteRunModal:d,showRestoreRunModal:p,showRenameRunModal:h,renamedRunName:f})]})})),Oe={buttonSeparator:e=>({borderLeft:`1px solid ${e.colors.border}`,marginLeft:e.spacing.xs,marginRight:e.spacing.xs,height:"100%"}),controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center"})},Pe=r.forwardRef(((e,t)=>{const{pressed:n,onClick:r,icon:a,onBlur:i,onFocus:l,onMouseEnter:s,onMouseLeave:o}=e,{theme:d}=(0,y.u)();return(0,c.tZ)("button",{onClick:r,css:(0,f.iv)({cursor:"pointer",width:d.general.heightSm,height:d.general.heightSm,borderRadius:d.borders.borderRadiusMd,lineHeight:d.typography.lineHeightBase,padding:0,border:0,display:"flex",alignItems:"center",justifyContent:"center",background:n?d.colors.actionDefaultBackgroundPress:"transparent",color:n?d.colors.actionDefaultTextPress:d.colors.textSecondary,"&:hover":{background:d.colors.actionDefaultBackgroundHover,color:d.colors.actionDefaultTextHover}},""),ref:t,onBlur:i,onFocus:l,onMouseEnter:s,onMouseLeave:o,children:a})}));var He=n(4942),Xe=n(71002),ze=n(87462),Ue=n(3017),_e=n(55819),Ve=n.n(_e),Fe=n(47337),We=n(75356),Ke=n(29439);function je(e){var t,n=e.prefixCls,a=e.value,i=e.current,l=e.offset,s=void 0===l?0:l;return s&&(t={position:"absolute",top:"".concat(s,"00%"),left:0}),r.createElement("span",{style:t,className:Ve()("".concat(n,"-only-unit"),{current:i})},a)}function $e(e,t,n){for(var r=e,a=0;(r+10)%10!==t;)r+=n,a+=n;return a}function Ye(e){var t,n,a=e.prefixCls,i=e.count,l=e.value,s=Number(l),o=Math.abs(i),d=r.useState(s),c=(0,Ke.Z)(d,2),u=c[0],p=c[1],m=r.useState(o),h=(0,Ke.Z)(m,2),g=h[0],f=h[1],v=function(){p(s),f(o)};if(r.useEffect((function(){var e=setTimeout((function(){v()}),1e3);return function(){clearTimeout(e)}}),[s]),u===s||Number.isNaN(s)||Number.isNaN(u))t=[r.createElement(je,(0,ze.Z)({},e,{key:s,current:!0}))],n={transition:"none"};else{t=[];for(var y=s+10,b=[],C=s;C<=y;C+=1)b.push(C);var x=b.findIndex((function(e){return e%10===u}));t=b.map((function(t,n){var a=t%10;return r.createElement(je,(0,ze.Z)({},e,{key:t,value:a,offset:n-x,current:n===x}))})),n={transform:"translateY(".concat(-$e(u,s,g<o?1:-1),"00%)")}}return r.createElement("span",{className:"".concat(a,"-only"),style:n,onTransitionEnd:v},t)}var qe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},Qe=function(e){var t=e.prefixCls,n=e.count,a=e.className,i=e.motionClassName,l=e.style,s=e.title,o=e.show,d=e.component,c=void 0===d?"sup":d,u=e.children,p=qe(e,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),m=(0,r.useContext(Fe.E_).getPrefixCls)("scroll-number",t),h=(0,ze.Z)((0,ze.Z)({},p),{"data-show":o,style:l,className:Ve()(m,a,i),title:s}),g=n;if(n&&Number(n)%1===0){var f=String(n).split("");g=f.map((function(e,t){return r.createElement(Ye,{prefixCls:m,count:Number(n),value:e,key:f.length-t})}))}return l&&l.borderColor&&(h.style=(0,ze.Z)((0,ze.Z)({},l),{boxShadow:"0 0 0 1px ".concat(l.borderColor," inset")})),u?(0,We.Tm)(u,(function(e){return{className:Ve()("".concat(m,"-custom-component"),null===e||void 0===e?void 0:e.className,i)}})):r.createElement(c,h,g)},Ge=n(22446);function Je(e){return-1!==Ge.Y.indexOf(e)}var et=function(e){var t,n=e.className,a=e.prefixCls,i=e.style,l=e.color,s=e.children,o=e.text,d=e.placement,c=void 0===d?"end":d,u=r.useContext(Fe.E_),p=u.getPrefixCls,m=u.direction,h=p("ribbon",a),g=Je(l),f=Ve()(h,"".concat(h,"-placement-").concat(c),(t={},(0,He.Z)(t,"".concat(h,"-rtl"),"rtl"===m),(0,He.Z)(t,"".concat(h,"-color-").concat(l),g),t),n),v={},y={};return l&&!g&&(v.background=l,y.color=l),r.createElement("div",{className:"".concat(h,"-wrapper")},s,r.createElement("div",{className:f,style:(0,ze.Z)((0,ze.Z)({},v),i)},r.createElement("span",{className:"".concat(h,"-text")},o),r.createElement("div",{className:"".concat(h,"-corner"),style:y})))},tt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},nt=function(e){var t,n,a=e.prefixCls,i=e.scrollNumberPrefixCls,l=e.children,s=e.status,o=e.text,d=e.color,c=e.count,u=void 0===c?null:c,p=e.overflowCount,m=void 0===p?99:p,h=e.dot,g=void 0!==h&&h,f=e.size,v=void 0===f?"default":f,y=e.title,b=e.offset,C=e.style,x=e.className,Z=e.showZero,w=void 0!==Z&&Z,S=tt(e,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","showZero"]),k=r.useContext(Fe.E_),R=k.getPrefixCls,M=k.direction,E=R("badge",a),T=u>m?"".concat(m,"+"):u,B=null!==s&&void 0!==s||null!==d&&void 0!==d,A="0"===T||0===T,I=g&&!A||B,L=I?"":T,D=(0,r.useMemo)((function(){return(null===L||void 0===L||""===L||A&&!w)&&!I}),[L,A,w,I]),N=(0,r.useRef)(u);D||(N.current=u);var O=N.current,P=(0,r.useRef)(L);D||(P.current=L);var H=P.current,X=(0,r.useRef)(I);D||(X.current=I);var z=(0,r.useMemo)((function(){if(!b)return(0,ze.Z)({},C);var e={marginTop:b[1]};return"rtl"===M?e.left=parseInt(b[0],10):e.right=-parseInt(b[0],10),(0,ze.Z)((0,ze.Z)({},e),C)}),[M,b,C]),U=null!==y&&void 0!==y?y:"string"===typeof O||"number"===typeof O?O:void 0,_=D||!o?null:r.createElement("span",{className:"".concat(E,"-status-text")},o),V=O&&"object"===(0,Xe.Z)(O)?(0,We.Tm)(O,(function(e){return{style:(0,ze.Z)((0,ze.Z)({},z),e.style)}})):void 0,F=Ve()((t={},(0,He.Z)(t,"".concat(E,"-status-dot"),B),(0,He.Z)(t,"".concat(E,"-status-").concat(s),!!s),(0,He.Z)(t,"".concat(E,"-status-").concat(d),Je(d)),t)),W={};d&&!Je(d)&&(W.background=d);var K=Ve()(E,(n={},(0,He.Z)(n,"".concat(E,"-status"),B),(0,He.Z)(n,"".concat(E,"-not-a-wrapper"),!l),(0,He.Z)(n,"".concat(E,"-rtl"),"rtl"===M),n),x);if(!l&&B){var j=z.color;return r.createElement("span",(0,ze.Z)({},S,{className:K,style:z}),r.createElement("span",{className:F,style:W}),r.createElement("span",{style:{color:j},className:"".concat(E,"-status-text")},o))}return r.createElement("span",(0,ze.Z)({},S,{className:K}),l,r.createElement(Ue.Z,{visible:!D,motionName:"".concat(E,"-zoom"),motionAppear:!1},(function(e){var t,n=e.className,a=R("scroll-number",i),l=X.current,o=Ve()((t={},(0,He.Z)(t,"".concat(E,"-dot"),l),(0,He.Z)(t,"".concat(E,"-count"),!l),(0,He.Z)(t,"".concat(E,"-count-sm"),"small"===v),(0,He.Z)(t,"".concat(E,"-multiple-words"),!l&&H&&H.toString().length>1),(0,He.Z)(t,"".concat(E,"-status-").concat(s),!!s),(0,He.Z)(t,"".concat(E,"-status-").concat(d),Je(d)),t)),c=(0,ze.Z)({},z);return d&&!Je(d)&&((c=c||{}).background=d),r.createElement(Qe,{prefixCls:a,show:!D,motionClassName:n,className:o,count:H,title:U,style:c,key:"scrollNumber"},V)})),_)};nt.Ribbon=et;var rt=nt;const at=r.memo((e=>{let{runInfos:t}=e;const{actions:{searchRunsPayload:n},updateSearchFacets:a}=Ie(),i=de(),[l,s]=(0,r.useState)(0),[o,d]=(0,r.useState)(0),u=(0,r.useCallback)((()=>a({},{forceRefresh:!0,preservePristine:!0})),[a]);return(0,r.useEffect)((()=>{d(0),s((()=>Date.now()))}),[t]),(0,r.useEffect)((()=>{if(!l)return;const e=setInterval((()=>{const e={experimentIds:i,filter:`attributes.start_time > ${l}`,maxResults:Y.mz};n(e).then((e=>{var t;const n=(null===(t=e.runs)||void 0===t?void 0:t.length)||0;d(n)}))}),Y.FK);return()=>clearInterval(e)}),[l,n,i]),(0,c.tZ)(rt,{count:o,offset:[-5,5],css:it.pill,overflowCount:Y.mz-1,children:(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"ag05Pe",defaultMessage:"Refresh"}),children:(0,c.tZ)(y.B,{onClick:u,"data-testid":"runs-refresh-button",icon:(0,c.tZ)(m.bnu,{})})})})})),it={pill:e=>({sup:{backgroundColor:e.colors.lime,zIndex:1}})},lt=(0,S.$j)((e=>({runInfos:e.entities.runInfosByUuid})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.runInfosByUuid===t.entities.runInfosByUuid})(at),st=e=>(0,r.useMemo)((()=>ye.Z.getStoreForComponent("ExperimentView",e)),[e]),ot=()=>(0,c.BX)("div",{className:"search-input-tooltip-content",children:[(0,c.tZ)(C.Z,{id:"kIlkgf",defaultMessage:"Search runs using a simplified version of the SQL {whereBold} clause.",values:{whereBold:(0,c.tZ)("b",{children:"WHERE"})}})," ",(0,c.tZ)(C.Z,{id:"nYKZy4",defaultMessage:"<link>Learn more</link>",values:{link:e=>(0,c.tZ)("a",{href:h.Kp,target:"_blank",rel:"noopener noreferrer",children:e})}}),(0,c.tZ)("br",{}),(0,c.tZ)(C.Z,{id:"U3btBc",defaultMessage:"Examples:"}),(0,c.tZ)("br",{}),"\u2022 metrics.rmse >= 0.8",(0,c.tZ)("br",{}),"\u2022 metrics.`f1 score` < 1",(0,c.tZ)("br",{}),"\u2022 params.model = 'tree'",(0,c.tZ)("br",{}),"\u2022 attributes.run_name = 'my run'",(0,c.tZ)("br",{}),"\u2022 tags.`mlflow.user` = 'myUser'",(0,c.tZ)("br",{}),"\u2022 metric.f1_score > 0.9 AND params.model = 'tree'",(0,c.tZ)("br",{}),"\u2022 dataset.name IN ('dataset1', 'dataset2')",(0,c.tZ)("br",{}),"\u2022 attributes.run_id IN ('a1b2c3d4', 'e5f6g7h8')",(0,c.tZ)("br",{}),"\u2022 tags.model_class LIKE 'sklearn.linear_model%'"]});const dt=["run_id","run_name","status","artifact_uri","user_id","start_time","end_time","created"].map((e=>({value:`attributes.${e}`})));var ct={name:"lugakg",styles:"font-weight:normal"};const ut=(e,t)=>{const n=e.split(RegExp(t.replace(".","\\."),"ig")),a=e.match(RegExp(t.replace(".","\\."),"ig"));return(0,c.tZ)("span",{css:ct,"data-test-id":e,children:n.map(((e,t)=>(0,c.BX)(r.Fragment,{children:[e,t!==n.length-1&&a&&(0,c.tZ)("b",{children:a[t]})]},t)))})};const pt="tooltipLastPopup";var mt={name:"1ua1wyk",styles:"width:560px"};const ht=e=>{const{runsData:t,searchFilter:n,requestError:a,onSearchFilterChange:i,onClear:l}=e,[o,d]=(0,r.useState)(""),[u,p]=(0,r.useState)(void 0),[h,g]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),b=(0,r.useRef)({metricNames:[],paramNames:[],tagNames:[]}),[C,x]=(0,r.useState)({Metrics:10,Parameters:10,Tags:10}),Z=(0,r.useRef)([]),[w,S]=(0,r.useState)(void 0);(0,r.useEffect)((()=>{d(n)}),[n]);const k=(0,r.useMemo)((()=>{const e=b.current,n=((e,t)=>{const n=(e,t)=>[...new Set([...e,...t])],r=e=>e.flatMap((e=>Object.keys(e)));return{metricNames:n(t.metricNames,e.metricKeyList),paramNames:n(t.paramNames,e.paramKeyList),tagNames:n(r(t.tagNames),r(e.tagsList)).filter((e=>!e.startsWith("mlflow."))).map((e=>e.includes('"')||e.includes(" ")||e.includes(".")?`\`${e}\``:e.includes("`")?`"${e}"`:e))}})(t,e);return b.current=n,[{label:"Metrics",options:(r=n).metricNames.map((e=>({value:`metrics.${e}`})))},{label:"Parameters",options:r.paramNames.map((e=>({value:`params.${e}`})))},{label:"Tags",options:r.tagNames.map((e=>({value:`tags.${e}`})))},{label:"Attributes",options:dt}];var r}),[t]);(0,r.useEffect)((()=>{const e=Z.current,t=(e=>{const t=/>|<|>=|<=|=|!=|like|ilike/gi,n=(e=>{const t=/and[\s]+/gi,n=[];let r,a;for(;a=t.lastIndex,r=t.exec(e);)n.push({clause:e.substring(a,r.index),startIndex:a});return n.push({clause:e.substring(a),startIndex:a}),n})(e),r=[];return n.forEach((e=>{const n=e.clause.split(t)[0],{startIndex:a}=e;r.push({name:n,startIndex:0+a,endIndex:n.length+a})})),r})(o);if(Z.current=t,f)return void v(!1);const n=t.map((e=>e.name)),r=e.map((e=>e.name));if(!(0,s.isEqual)(n,r)&&t.length>=e.length){let n=0;for(;n<t.length;){if(n>=e.length||t[n].name.trim()!==e[n].name.trim())return p(!0),void S(t[n]);n++}}p(!1)}),[o]);const R=(0,r.useMemo)((()=>w?((e,t,n)=>e.map((e=>{const r=e.options.filter((e=>e.value.toLowerCase().includes(t.name.toLowerCase().trim()))).map((e=>({value:e.value,label:ut(e.value,t.name.trim())}))),a=n[e.label],i=[...r.slice(0,a),...r.length>a?[{label:"...",value:`..._${e.label}`}]:[]];return{label:e.label,options:i}})).filter((e=>e.options.length>0)))(k,w,C):[]),[k,w,C]),M=(0,r.useCallback)(((e,t)=>{if(w)if(e.startsWith("...")){p(!0);const e=t.value.split("_")[1];x((t=>({...t,[e]:t[e]+10})))}else{const t=o.substring(0,w.startIndex),n=o.substring(w.endIndex);d(t+e+" "+n),v(!0),p(!1)}}),[o,d,w,p]),E=st(pt),[T,B]=(0,r.useState)((()=>{const e=Math.floor(Date.now()/1e3),t=E.getItem(pt);return!t||parseInt(t,10)<e-604800})),A=r.useRef(null);(0,r.useEffect)((()=>{if(a&&T){var e;const t=Math.floor(Date.now()/1e3);E.setItem(pt,t),B(!1),null===(e=A.current)||void 0===e||e.click()}}),[a]);const I=0===R.flatMap((e=>e.options)).length,L=u&&h&&!I,D=(0,r.useCallback)((e=>{"Enter"===e.key&&(L?p(!1):i(o)),"Escape"===e.key&&(e.preventDefault(),L&&p(!1))}),[L,o,i]);return(0,c.tZ)("div",{css:gt.searchBox,children:(0,c.tZ)(m.QcG,{dropdownMatchSelectWidth:560,css:mt,defaultOpen:!1,defaultActiveFirstOption:!0,open:L,options:R,onSelect:M,value:o,"data-test-id":"runs-search-autocomplete",dropdownRender:e=>(0,c.tZ)("div",{css:gt.dropdownOverride,children:e}),children:(0,c.tZ)(y.h,{value:o,prefix:(0,c.tZ)(m.W1M,{css:gt.searchBarIcon}),onKeyDown:D,onClick:()=>g(!0),onBlur:()=>g(!1),onChange:e=>d(e.target.value),placeholder:'metrics.rmse < 1 and params.model = "tree"',"data-test-id":"search-box",suffix:(0,c.BX)("div",{css:gt.searchInputSuffix,children:[o&&(0,c.tZ)(y.B,{onClick:l,type:"link","data-test-id":"clear-button",children:(0,c.tZ)(y.C,{})}),(0,c.tZ)(y.e,{title:(0,c.tZ)(ot,{}),placement:"right",dangerouslySetAntdProps:{overlayInnerStyle:{width:"150%"},trigger:"click"},children:(0,c.tZ)("div",{ref:A,children:(0,c.tZ)(y.f,{css:gt.searchBarIcon})})})]})})})})},gt={searchBox:e=>({display:"flex",gap:e.spacing.sm,width:430}),searchBarIcon:e=>({svg:{width:16,height:16,color:e.colors.textSecondary}}),searchInputSuffix:{display:"flex",gap:4,alignItems:"center"},dropdownOverride:{".du-bois-light-select-item-option-active:not(.du-bois-light-select-item-option-disabled)":{backgroundColor:"#e6f1f5"}}},ft=(e,t)=>e.digest===t.digest&&e.name===t.name&&e.context===t.context;var vt=n(54048),yt=n(94837),bt=n.n(yt),Ct=(0,vt.Z)(bt(),{});Ct.registerLanguage=function(e,t){return bt().register(t)};var xt=Ct,Zt=n(9319);var wt={'code[class*="language-"]':{fontFamily:'Consolas, Menlo, Monaco, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", "Courier New", Courier, monospace',fontSize:"14px",lineHeight:"1.375",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",background:"#2a2734",color:"#5DFAFC"},'pre[class*="language-"]':{fontFamily:'Consolas, Menlo, Monaco, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", "Courier New", Courier, monospace',fontSize:"14px",lineHeight:"1.375",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",background:"#2a2734",color:"#5DFAFC",padding:"1em",margin:".5em 0",overflow:"auto"},'pre > code[class*="language-"]':{fontSize:"1em"},'pre[class*="language-"]::-moz-selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"] ::-moz-selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"]::-moz-selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"] ::-moz-selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"]::selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"] ::selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"]::selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"] ::selection':{textShadow:"none",background:"#6a51e6"},':not(pre) > code[class*="language-"]':{padding:".1em",borderRadius:".3em"},comment:{color:"#6c6783"},prolog:{color:"#6c6783"},doctype:{color:"#6c6783"},cdata:{color:"#6c6783"},punctuation:{color:"#6c6783"},namespace:{Opacity:".7"},tag:{color:"#3AACE2"},operator:{color:"#3AACE2"},number:{color:"#3AACE2"},property:{color:"#5DFAFC"},function:{color:"#5DFAFC"},"tag-id":{color:"#eeebff"},selector:{color:"#eeebff"},"atrule-id":{color:"#eeebff"},"code.language-javascript":{color:"#c4b9fe"},"attr-name":{color:"#c4b9fe"},"code.language-css":{color:"#ffffff"},"code.language-scss":{color:"#ffffff"},boolean:{color:"#ffffff"},string:{color:"#ffffff"},entity:{color:"#ffffff",cursor:"help"},url:{color:"#ffffff"},".language-css .token.string":{color:"#ffffff"},".language-scss .token.string":{color:"#ffffff"},".style .token.string":{color:"#ffffff"},"attr-value":{color:"#ffffff"},keyword:{color:"#ffffff"},control:{color:"#ffffff"},directive:{color:"#ffffff"},unit:{color:"#ffffff"},statement:{color:"#ffffff"},regex:{color:"#ffffff"},atrule:{color:"#ffffff"},placeholder:{color:"#ffffff"},variable:{color:"#ffffff"},deleted:{textDecoration:"line-through"},inserted:{borderBottom:"1px dotted #eeebff",textDecoration:"none"},italic:{fontStyle:"italic"},important:{fontWeight:"bold",color:"#c4b9fe"},bold:{fontWeight:"bold"},"pre > code.highlight":{Outline:".4em solid #8a75f5",OutlineOffset:".4em"},".line-numbers.line-numbers .line-numbers-rows":{borderRightColor:"#2c2937"},".line-numbers .line-numbers-rows > span:before":{color:"#3c3949"},".line-highlight.line-highlight":{background:"linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))"}};var St={'code[class*="language-"]':{textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",color:"rgb(77, 77, 76)",background:"#fafafa",fontFamily:"Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace",fontSize:"12px",lineHeight:"1.5em",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",color:"rgb(77, 77, 76)",background:"#fafafa",fontFamily:"Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace",fontSize:"12px",lineHeight:"1.5em",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",overflow:"auto",position:"relative",margin:"0.5em 0",padding:"1.25em 1em"},'code[class*="language-"]::-moz-selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"]::-moz-selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"] ::-moz-selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"] ::-moz-selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"]::selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"]::selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"] ::selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"] ::selection':{background:"#cceae7",color:"#263238"},':not(pre) > code[class*="language-"]':{whiteSpace:"normal",borderRadius:"0.2em",padding:"0.1em"},".language-css > code":{color:"#f5871f"},".language-sass > code":{color:"#f5871f"},".language-scss > code":{color:"#f5871f"},'[class*="language-"] .namespace':{Opacity:"0.7"},atrule:{color:"#7c4dff"},"attr-name":{color:"#39adb5"},"attr-value":{color:"#f6a434"},attribute:{color:"#f6a434"},boolean:{color:"#7c4dff"},builtin:{color:"#39adb5"},cdata:{color:"#39adb5"},char:{color:"#39adb5"},class:{color:"#39adb5"},"class-name":{color:"#6182b8"},comment:{color:"#8e908c"},constant:{color:"#7c4dff"},deleted:{color:"#e53935"},doctype:{color:"#aabfc9"},entity:{color:"#e53935"},function:{color:"#4271ae"},hexcode:{color:"#f5871f"},id:{color:"#7c4dff",fontWeight:"bold"},important:{color:"#7c4dff",fontWeight:"bold"},inserted:{color:"#39adb5"},keyword:{color:"#8959a8"},number:{color:"#f5871f"},operator:{color:"#3e999f"},prolog:{color:"#aabfc9"},property:{color:"#39adb5"},"pseudo-class":{color:"#f6a434"},"pseudo-element":{color:"#f6a434"},punctuation:{color:"rgb(77, 77, 76)"},regex:{color:"#6182b8"},selector:{color:"#e53935"},string:{color:"#3ba85f"},symbol:{color:"#7c4dff"},tag:{color:"#e53935"},unit:{color:"#f5871f"},url:{color:"#e53935"},variable:{color:"#c72d4c"}};xt.registerLanguage("python",Zt.Z);const kt={light:St,duotoneDark:wt};function Rt(e){let{theme:t="light",language:n,actions:r,style:a,children:i,showLineNumbers:l,lineNumberStyle:o}=e;const d={border:"none",borderRadius:0,margin:0,padding:"24px",...a};return(0,c.tZ)(c.HY,{children:(0,c.tZ)(xt,{showLineNumbers:l,lineNumberStyle:o,language:n,style:kt[t],customStyle:d,codeTagProps:{style:(0,s.pick)(a,"backgroundColor")},children:i})})}var Mt={name:"1voqbl3",styles:"margin-top:0;font-weight:normal"};const Et=e=>{let{isOpen:t,closeModal:n,experimentId:r}=e;const{theme:a}=(0,y.u)(),i=`\nimport mlflow\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.ensemble import RandomForestRegressor\n\n# set the experiment id\nmlflow.set_experiment(experiment_id="${r}")\n\nmlflow.autolog()\ndb = load_diabetes()\n\nX_train, X_test, y_train, y_test = train_test_split(db.data, db.target)\n\n# Create and train models.\nrf = RandomForestRegressor(n_estimators=100, max_depth=6, max_features=3)\nrf.fit(X_train, y_train)\n\n# Use the model to make predictions on the test dataset.\npredictions = rf.predict(X_test)\n`.trimStart(),l=`\nimport mlflow\nimport openai\n\n# you must set the OPENAI_API_KEY environment variable\nassert (\n  "OPENAI_API_KEY" in os.environ\n), "Please set the OPENAI_API_KEY environment variable."\n\n# set the experiment id\nmlflow.set_experiment(experiment_id="${r}")\n\nsystem_prompt = (\n  "The following is a conversation with an AI assistant."\n  + "The assistant is helpful and very friendly."\n)\n\n# start a run\nmlflow.start_run()\nmlflow.log_param("system_prompt", system_prompt)\n\n# Create a question answering model using prompt engineering\n# with OpenAI. Log the model to MLflow Tracking\nlogged_model = mlflow.openai.log_model(\n    model="gpt-3.5-turbo",\n    task=openai.ChatCompletion,\n    artifact_path="model",\n    messages=[\n        {"role": "system", "content": system_prompt},\n        {"role": "user", "content": "{question}"},\n    ],\n)\n\n# Evaluate the model on some example questions\nquestions = pd.DataFrame(\n    {\n        "question": [\n            "How do you create a run with MLflow?",\n            "How do you log a model with MLflow?",\n            "What is the capital of France?",\n        ]\n    }\n)\nmlflow.evaluate(\n    model=logged_model.model_uri,\n    model_type="question-answering",\n    data=questions,\n)\nmlflow.end_run()\n`.trimStart(),s=18*(Math.min(...[i,l].map((e=>e.split("\n").length)))+1);return(0,c.tZ)(m.u_l,{visible:t,onCancel:n,onOk:n,footer:(0,c.tZ)("div",{css:(0,f.iv)({display:"flex",gap:a.spacing.sm,justifyContent:"flex-end"},""),children:(0,c.tZ)(y.B,{onClick:n,type:"primary",children:(0,c.tZ)(C.Z,{id:"ttyLD4",defaultMessage:"Okay"})})}),title:(0,c.BX)("div",{children:[(0,c.tZ)(y.T.Title,{level:2,css:(0,f.iv)({marginTop:a.spacing.sm,marginBottom:a.spacing.xs},""),children:(0,c.tZ)(C.Z,{id:"iF1UfU",defaultMessage:"New run using notebook"})}),(0,c.tZ)(y.T.Hint,{css:Mt,children:"Run this code snippet in a notebook or locally, to create an experiment run"})]}),children:(0,c.BX)(m.Tabs,{children:[(0,c.tZ)(m.Jml,{tab:(0,c.tZ)(C.Z,{id:"71dHIO",defaultMessage:"Classical ML"}),children:(0,c.tZ)(Rt,{style:{padding:"5px",height:s},language:"python",actions:(0,c.tZ)("div",{style:{marginTop:a.spacing.sm,marginRight:a.spacing.md},children:(0,c.tZ)(N,{copyText:i,showLabel:!1,icon:(0,c.tZ)(m.TIy,{})})}),children:i})},"classical-ml"),(0,c.tZ)(m.Jml,{tab:(0,c.tZ)(C.Z,{id:"xBVMQz",defaultMessage:"LLM"}),children:(0,c.tZ)(Rt,{style:{padding:"5px",height:s},language:"python",actions:(0,c.tZ)("div",{style:{marginTop:a.spacing.sm,marginRight:a.spacing.md},children:(0,c.tZ)(N,{copyText:l,showLabel:!1,icon:(0,c.tZ)(m.TIy,{})})}),children:l})},"llm")]})})};var Tt=n(42251),Bt=n(12048),At=n(57458),It=n(56401),Lt=n(36329);const Dt=[{type:"slider",name:"temperature",string:(0,Lt.Em)({id:"Jrri/Y",defaultMessage:"Temperature"}),helpString:(0,Lt.Em)({id:"5yWkFd",defaultMessage:"Increase or decrease the confidence level of the language model."}),max:1,min:0,step:.01},{type:"input",name:"max_tokens",string:(0,Lt.Em)({id:"qR3llD",defaultMessage:"Max tokens"}),helpString:(0,Lt.Em)({id:"cEwSR8",defaultMessage:"Maximum number of language tokens returned from evaluation."}),max:65536,min:1,step:1},{type:"list",name:"stop",string:(0,Lt.Em)({id:"FAfPOl",defaultMessage:"Stop Sequences"}),helpString:(0,Lt.Em)({id:"J2XCE/",defaultMessage:"Specify sequences that signal the model to stop generating text."})}],Nt={temperature:.01,max_tokens:100},Ot=()=>{const[e,t]=(0,r.useState)(Nt),n=(0,r.useCallback)(((e,n)=>{t((t=>({...t,[e]:n})))}),[]);return{parameterDefinitions:Dt,parameters:e,updateParameter:n}};var Pt=n(20402);var Ht={name:"151f7v8",styles:"span{font-weight:normal;}"};const Xt=e=>{let{disabled:t=!1,parameters:n,updateParameter:r}=e;const{parameterDefinitions:a}=Ot(),{theme:i}=(0,y.u)();return(0,c.BX)("div",{css:(0,f.iv)({marginBottom:i.spacing.lg},""),children:[(0,c.tZ)(m.lNd.Label,{css:(0,f.iv)({marginBottom:i.spacing.md},""),children:(0,c.tZ)(C.Z,{id:"N5FItx",defaultMessage:"Model parameters"})}),a.map((e=>(0,c.tZ)("div",{css:(0,f.iv)({marginBottom:i.spacing.md},""),children:(0,c.BX)(c.HY,{children:[(0,c.BX)(m.lNd.Label,{htmlFor:e.name,css:Ht,children:[(0,c.tZ)(C.Z,{...e.string}),(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{...e.helpString}),placement:"right",children:(0,c.tZ)(y.f,{css:(0,f.iv)({marginLeft:i.spacing.sm,verticalAlign:"text-top",color:i.colors.textSecondary},"")})})]}),(0,c.tZ)(m.lNd.Hint,{}),"temperature"===e.name&&(0,c.tZ)(Pt.O,{"data-testid":e.name,disabled:t,max:e.max,min:e.min,step:e.step,defaultValue:n[e.name]||0,handleLineSmoothChange:t=>r(e.name,t)}),"input"===e.type&&(0,c.tZ)(y.h,{"data-testid":e.name,type:"number",disabled:t,max:e.max,min:e.min,step:e.step,value:n[e.name]||0,onChange:t=>r(e.name,parseInt(t.target.value,10))}),"list"===e.type&&(0,c.tZ)(m.Select,{allowClear:!0,mode:"tags",style:{width:"100%"},open:!1,disabled:t,onChange:t=>r(e.name,t),value:n[e.name]||[],dangerouslySetAntdProps:{suffixIcon:null}})]})},e.name)))]})},zt=" }}",Ut="new_variable",_t=()=>{const[e,t]=(0,r.useState)(It.N3),n=(0,r.useRef)(),a=(0,r.useCallback)((()=>{t((e=>{const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.includes(Ut))return Ut;const t=(0,s.max)(e.map((e=>{var t;return parseInt((null===(t=e.match(/new_variable_(\d+)/))||void 0===t?void 0:t[1])||"1",10)})))||1;return`${Ut}_${t+1}`}((0,It.xN)(e)),r=`${e} {{ ${t}${zt}`;return requestAnimationFrame((()=>{const e=n.current;e&&(e.focus(),e.setSelectionRange(r.length-t.length-3,r.length-3))})),r}))}),[t]);return{savePromptTemplateInputRef:(0,r.useCallback)((e=>{var t;n.current=null===e||void 0===e||null===(t=e.resizableTextArea)||void 0===t?void 0:t.textArea}),[]),handleAddVariableToTemplate:a,promptTemplate:e,updatePromptTemplate:t}},Vt=(0,Lt.Em)({id:"lM0z8k",defaultMessage:"The following variable names contain spaces which is disallowed: {invalidNames}"}),Ft=e=>{let{violations:t}=e;const{namesWithSpaces:n}=t,{formatMessage:r}=(0,a.Z)();return(0,c.tZ)(c.HY,{children:n.length>0&&(0,c.tZ)(y.T.Text,{color:"warning",size:"sm","aria-label":r(Vt,{invalidNames:n.join(", ")}),children:(0,c.tZ)(C.Z,{...Vt,values:{invalidNames:(0,c.tZ)(c.HY,{children:n.map((e=>(0,c.tZ)("code",{children:e},e)))})}})})})};var Wt=n(52232);const Kt=[{prompt:["You are a marketing consultant for a technology company. Develop a marketing strategy report for {{ company_name }} aiming to {{ company_goal }}"],variables:[{name:"company_name",value:"XYZ Company"},{name:"company_goal",value:"Increase top-line revenue"}]},{prompt:['You are a helpful and friendly customer support chatbot. Answer the users question "{{ user_question }}" clearly, based on the following documentation: {{ documentation }}'],variables:[{name:"user_question",value:"Is MLflow open source?"},{name:"documentation",value:"MLflow is an open source platform for managing the end-to-end machine learning lifecycle."}]},{prompt:['Summarize the given text "{{ text }}" into a concise and coherent summary, capturing the main ideas and key points. Make sure that the summary does not exceed {{ word_count }} words.'],variables:[{name:"text",value:"Although C. septempunctata larvae and adults mainly eat aphids, they also feed on Thysanoptera, Aleyrodidae, on the larvae of Psyllidae and Cicadellidae, and on eggs and larvae of some beetles and butterflies. There are one or two generations per year. Adults overwinter in ground litter in parks, gardens and forest edges and under tree bark and rocks. C. septempunctata has a broad ecological range, generally living wherever there are aphids for it to eat. This includes, amongst other biotopes, meadows, fields, Pontic\u2013Caspian steppe, parkland, gardens, Western European broadleaf forests and mixed forests. In the United Kingdom, there are fears that the seven-spot ladybird is being outcompeted for food by the harlequin ladybird. An adult seven-spot ladybird may reach a body length of 7.6\u201312.7 mm (0.3\u20130.5 in). Their distinctive spots and conspicuous colours warn of their toxicity, making them unappealing to predators. The species can secrete a fluid from joints in their legs which gives them a foul taste. A threatened ladybird may both play dead and secrete the unappetising substance to protect itself. The seven-spot ladybird synthesizes the toxic alkaloids, N-oxide coccinelline and its free base precoccinelline; depending on sex and diet, the spot size and coloration can provide some indication of how toxic the individual insect is to potential predators."},{name:"word_count",value:"75"}]},{prompt:["Generate a list of ten titles for my book. The book is about {{ topic }}. Each title should be between {{ word_range }} words long.","### Examples of great titles ###","{{ examples }}"],variables:[{name:"topic",value:"my journey as an adventurer who has lived an unconventional life, meeting many different personalities and finally finding peace in gardening."},{name:"word_range",value:"two to five"},{name:"examples",value:'"Long walk to freedom", "Wishful drinking", "I know why the caged bird sings"'}]},{prompt:["Generate a SQL query from a user\u2019s question, using the information from the table.","Question: {{ user_question }}","Table Information: {{ table_information }}"],variables:[{name:"user_question",value:"Which product generated the most sales this month?"},{name:"table_information",value:"CREATE TABLE Sales (SaleID INT PRIMARY KEY, ProductID INT, SaleDate DATE, CustomerID INT, QuantitySold INT, UnitPrice DECIMAL(10, 2));"}]}],{TextArea:jt}=y.h,$t=e=>{let{isOpen:t,closeExamples:n,closeModal:r,updatePromptTemplate:a,updateInputVariableValue:i}=e;const{theme:l}=(0,y.u)();return(0,c.tZ)(m.u_l,{verticalSizing:"maxed_out",visible:t,onCancel:r,title:(0,c.tZ)("div",{children:(0,c.BX)(y.T.Title,{level:2,css:(0,f.iv)({marginTop:l.spacing.sm,marginBottom:l.spacing.xs},""),children:[(0,c.tZ)(y.B,{css:(0,f.iv)({marginRight:l.spacing.sm,marginBottom:l.spacing.sm},""),icon:(0,c.tZ)(m.Y4O,{}),onClick:n}),(0,c.tZ)(C.Z,{id:"KzC+38",defaultMessage:"Prompt template examples"})]})}),dangerouslySetAntdProps:{width:1200},children:Kt.map((e=>(0,c.BX)("div",{css:(0,f.iv)({display:"flex",flexDirection:"column",gap:l.spacing.md},""),children:[(0,c.BX)("div",{css:(0,f.iv)({boxSizing:"border-box",border:`1px solid ${l.colors.actionDefaultBorderDefault}`,borderRadius:l.borders.borderRadiusMd,background:l.colors.backgroundPrimary,padding:l.spacing.md,margin:0,overflow:"hidden",display:"flex",flexDirection:"column",gap:`${l.spacing.xs}px`},""),children:[(0,c.BX)(y.T.Title,{level:4,children:[(0,c.tZ)(C.Z,{id:"GDzD7I",defaultMessage:"Prompt Template"}),(0,c.tZ)(y.B,{type:"tertiary",size:"small",style:{float:"right"},onClick:()=>(e=>{a(e.prompt.join("\n")),e.variables.forEach((e=>{let{name:t,value:n}=e;i(t,n)})),n()})(e),children:(0,c.tZ)(C.Z,{id:"Np53PR",defaultMessage:"Try this template"})})]}),e.prompt.map((e=>(0,c.tZ)(y.T.Paragraph,{children:e},e))),(0,c.tZ)(Wt.Z,{css:(0,f.iv)({marginTop:l.spacing.xs,marginBottom:l.spacing.xs},"")}),e.variables.map((e=>{let{name:t,value:n}=e;return(0,c.BX)("div",{children:[(0,c.tZ)(y.T.Title,{level:4,children:t}),(0,c.tZ)(y.T.Paragraph,{children:n})]},t)}))]}),(0,c.tZ)(m.LZC,{})]},e.prompt.join("\n"))))})};const{TextArea:Yt}=y.h;var qt={name:"1ll9bqd",styles:"cursor:default"};const Qt=e=>{let{evaluationMetadata:t,isEvaluating:n,isOutputDirty:a,evaluationOutput:i,evaluationError:l,evaluateButtonTooltip:s,disabled:o,onEvaluateClick:d,onCancelClick:u}=e;const{theme:p}=(0,y.u)(),h=(0,r.useMemo)((()=>t?n?null:(0,c.BX)("div",{css:(0,f.iv)({display:"flex",gap:p.spacing.xs,alignItems:"center"},""),children:[It.h in t&&(0,c.BX)(y.T.Hint,{size:"sm",children:[Math.round(Number(t[It.h]))," ms","MLFLOW_total_tokens"in t?",":""]}),It.i7 in t&&(0,c.tZ)(y.T.Hint,{size:"sm",children:(0,c.tZ)(C.Z,{id:"/nPZbt",defaultMessage:"{totalTokens} total tokens",values:{totalTokens:t[It.i7]}})})]}):null),[t,n,p]);return(0,c.BX)(c.HY,{children:[(0,c.BX)("div",{css:(0,f.iv)({marginBottom:p.spacing.md},""),children:[(0,c.tZ)(y.e,{title:s,children:(0,c.tZ)(y.B,{"data-testid":"button-evaluate",icon:(0,c.tZ)(m.o1U,{}),onClick:d,disabled:o,loading:n,children:(0,c.tZ)(C.Z,{id:"72uGpl",defaultMessage:"Evaluate"})})}),n&&(0,c.tZ)(y.B,{"data-testid":"button-cancel",icon:(0,c.tZ)(m.wNq,{}),onClick:u,css:(0,f.iv)({marginLeft:p.spacing.sm},""),children:(0,c.tZ)(C.Z,{id:"CTEh+b",defaultMessage:"Cancel"})})]}),(0,c.BX)(m.lNd.Label,{children:[(0,c.tZ)(C.Z,{id:"ydoHrJ",defaultMessage:"Output"}),a&&(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"gc+GrI",defaultMessage:"Model, input data or prompt have changed since last evaluation of the output"}),children:(0,c.tZ)(m.aNP,{css:(0,f.iv)({marginLeft:p.spacing.xs},"")})})]}),(0,c.tZ)(m.lNd.Hint,{children:(0,c.tZ)(C.Z,{id:"JtQQMn",defaultMessage:"This is the output generated by the LLM using the prompt template and input values defined above."})}),!l&&n&&(0,c.tZ)("div",{css:(0,f.iv)({marginTop:p.spacing.sm},""),children:(0,c.tZ)(m.hM6,{lines:5})}),!n&&(0,c.tZ)(Yt,{rows:5,css:qt,"data-testid":"prompt-output",value:i,readOnly:!0}),!n&&l&&(0,c.tZ)(m.lNd.Message,{message:l,type:"error"}),(0,c.tZ)("div",{css:(0,f.iv)({marginTop:p.spacing.sm},""),children:h})]})};const{TextArea:Gt}=y.h;var Jt={name:"1voqbl3",styles:"margin-top:0;font-weight:normal"},en={name:"t691yx",styles:"display:grid;grid-template-columns:300px 1fr;gap:48px"},tn={name:"1d3w5wq",styles:"width:100%"},nn={name:"1eoy87d",styles:"display:flex;justify-content:space-between"};const rn=e=>{let{isOpen:t,closeModal:n,runBeingDuplicated:o,visibleRuns:d=[]}=e;const[u]=de(),{theme:p}=(0,y.u)(),{parameters:h,updateParameter:g}=Ot(),[v,b]=(0,r.useState)(""),[x,Z]=(0,r.useState)(""),[w,k]=(0,r.useState)(!1),[R,M]=(0,r.useState)(!1),[E,T]=(0,r.useState)(null),[B,A]=(0,r.useState)(""),[I,L]=(0,r.useState)({}),[D,N]=(0,r.useState)(!1),[O,P]=(0,r.useState)(!1),H=(0,r.useRef)(null),X=(0,S.I0)();(0,r.useEffect)((()=>{X((0,Tt.cL)()).catch((e=>{l.default.logErrorAndNotifyUser((null===e||void 0===e?void 0:e.message)||e)}))}),[X]);const z=(0,a.Z)(),{updateInputVariables:U,inputVariables:_,inputVariableValues:V,updateInputVariableValue:F,inputVariableNameViolations:W,clearInputVariableValues:K}=(()=>{const[e,t]=(0,r.useState)((0,It.xN)("")),[n,a]=(0,r.useState)({namesWithSpaces:[]}),[i,l]=(0,r.useState)(It.c$),o=(0,r.useCallback)((()=>l({})),[]),d=(0,r.useMemo)((()=>(0,s.debounce)((e=>{t((t=>{const n=(0,It.xN)(e);return(0,s.isEqual)(n,t)?t:n})),a((0,It.Iy)(e))}),250)),[]),c=(0,r.useCallback)(((e,t)=>{l((n=>({...n,[e]:t})))}),[]),u=(0,r.useMemo)((()=>(0,s.fromPairs)(Object.entries(i).filter((t=>{let[n]=t;return e.includes(n)})))),[i,e]);return{updateInputVariables:d,inputVariables:e,inputVariableValues:u,updateInputVariableValue:c,inputVariableNameViolations:n,clearInputVariableValues:o}})(),{handleAddVariableToTemplate:j,savePromptTemplateInputRef:$,promptTemplate:Y,updatePromptTemplate:q}=_t();(0,r.useEffect)((()=>{t&&!o&&Z((0,At.hM)())}),[t,o]),(0,r.useEffect)((()=>{U(Y)}),[Y,U]),(0,r.useEffect)((()=>{if(o){const{promptTemplate:e,routeName:t,parameters:n}=(0,It.rP)(o);(0,It.oV)(o),e&&q(e),n.temperature&&g("temperature",n.temperature),n.max_tokens&&g("max_tokens",n.max_tokens),t&&b(t),A(""),N(!1);const r=(0,At.HY)(o.runName,d.map((e=>{let{runName:t}=e;return t})));Z(r),K()}}),[o,K,g,q,d]);const Q=(0,S.v9)((e=>{let{modelGateway:t}=e;return t.modelGatewayRoutes})),G=(0,r.useMemo)((()=>(0,s.sortBy)(Object.values(Q).filter((e=>[Bt.nr.LLM_V1_COMPLETIONS,Bt.nr.LLM_V1_CHAT].includes(e.endpoint_type))),"name")),[Q]),J=(0,S.v9)((e=>{let{modelGateway:t}=e;return t.modelGatewayRoutesLoading}));(0,r.useEffect)((()=>{B&&N(!0)}),[V,Y,h,v]);const{refreshRuns:ee,updateSearchFacets:te}=Ie(),ne=(0,r.useCallback)((()=>{const e=Q[v],t=Math.random().toString(36);if(H.current=t,!e)throw new Error("No model route found!");T(null),M(!0);const n=(0,It.Ky)(Y,V);X((0,Tt.N)(e,{inputText:n,parameters:h})).then((e=>{let{value:n,action:r}=e;if(H.current===t){const{text:e,usage:a}=Bt.zT.parseEvaluationResponse(n),i=performance.now()-r.meta.startTime;A(e);const l={...a,latency:i},s=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return{...e,[`MLFLOW_${n}`]:r}}),{});L(s),N(!1),M(!1),H.current===t&&(H.current=null)}})).catch((e=>{const n=e.getGatewayErrorMessage()||e.getUserVisibleError(),r=z.formatMessage({id:"yC9GFP",defaultMessage:'MLflow deployment returned the following error: "{errorMessage}"'},{errorMessage:n});l.default.logErrorAndNotifyUser(r),M(!1),T(r),H.current===t&&(H.current=null)}))}),[X,V,Q,h,Y,v,z]),re=(0,r.useCallback)((()=>{H.current&&(M(!1),H.current=null)}),[M]),ae=z.formatMessage({id:"EOlibi",defaultMessage:"Model"}),ie=z.formatMessage({id:"vSjD2B",defaultMessage:"Select endpoint"}),le=Y.trim().length>0,se=(0,r.useMemo)((()=>_.every((e=>{var t;return null===(t=V[e])||void 0===t?void 0:t.trim()}))),[_,V]),oe=x.trim().length>0,ce=v&&le&&se,ue=Boolean(v&&le&&se&&B&&!D&&_.length>0&&oe&&!E),pe=(0,r.useMemo)((()=>v?le?se?B?D?z.formatMessage({id:"/K6wBr",defaultMessage:"Input data or prompt template have changed since last evaluation of the output"}):0===_.length?z.formatMessage({id:"z+0t/R",defaultMessage:"You need to define at least one input variable"}):oe?null:z.formatMessage({id:"dYbJha",defaultMessage:"Please provide run name"}):z.formatMessage({id:"gUhc5g",defaultMessage:"You need to evaluate the resulting output first"}):z.formatMessage({id:"flJNTA",defaultMessage:"You need to provide values for all defined inputs"}):z.formatMessage({id:"dHAuWp",defaultMessage:"You need to provide a prompt template"}):z.formatMessage({id:"ENTyzw",defaultMessage:"You need to select an endpoint from the MLflow deployment dropdown first"})),[se,_.length,z,D,B,le,v,oe]),me=(0,r.useMemo)((()=>v?le?se?null:z.formatMessage({id:"flJNTA",defaultMessage:"You need to provide values for all defined inputs"}):z.formatMessage({id:"dHAuWp",defaultMessage:"You need to provide a prompt template"}):z.formatMessage({id:"ENTyzw",defaultMessage:"You need to select an endpoint from the MLflow deployment dropdown first"})),[se,z,le,v]);return t&&O?(0,c.tZ)($t,{isOpen:t&&O,closeExamples:()=>P(!1),closeModal:n,updatePromptTemplate:q,updateInputVariableValue:F}):(0,c.BX)(m.u_l,{verticalSizing:"maxed_out",visible:t,onCancel:n,onOk:n,footer:(0,c.BX)("div",{css:(0,f.iv)({display:"flex",gap:p.spacing.sm,justifyContent:"flex-end"},""),children:[(0,c.tZ)(y.B,{onClick:n,children:(0,c.tZ)(C.Z,{id:"mqTFL+",defaultMessage:"Cancel"})}),(0,c.tZ)(y.e,{title:pe,children:(0,c.tZ)(y.B,{onClick:()=>{k(!0);const e=(0,It.Ky)(Y,V);X((0,i.Ct)({experimentId:u,promptTemplate:Y,modelInput:e,modelParameters:h,modelRouteName:v,promptParameters:V,modelOutput:B,runName:x,modelOutputParameters:I})).then((()=>{ee(),n(),k(!1),te((e=>"ARTIFACT"!==e.compareRunsMode?{...e,compareRunsMode:"ARTIFACT"}:e))})).catch((e=>{l.default.logErrorAndNotifyUser((null===e||void 0===e?void 0:e.message)||e),k(!1)}))},"data-testid":"button-create-run",type:"primary",disabled:!ue,children:(0,c.tZ)(C.Z,{id:"8Uwpjw",defaultMessage:"Create run"})})})]}),title:(0,c.BX)("div",{children:[(0,c.tZ)(y.T.Title,{level:2,css:(0,f.iv)({marginTop:p.spacing.sm,marginBottom:p.spacing.xs},""),children:(0,c.tZ)(C.Z,{id:"sLhmy7",defaultMessage:"New run"})}),(0,c.tZ)(y.T.Hint,{css:Jt,children:"Create a new run using a large-language model by giving it a prompt template and model parameters"})]}),dangerouslySetAntdProps:{width:1200},children:[(0,c.BX)("div",{css:en,children:[(0,c.BX)("div",{children:[(0,c.tZ)(m.lNd.Label,{htmlFor:"selected_model",css:(0,f.iv)({marginBottom:p.spacing.sm},""),children:ae}),(0,c.BX)("div",{css:(0,f.iv)({marginBottom:p.spacing.lg,display:"flex",alignItems:"center"},""),children:[(0,c.BX)(m.M6x,{label:ae,modal:!1,value:v?[v]:void 0,children:[(0,c.tZ)(m.Aa0,{id:"selected_model",css:tn,allowClear:!1,placeholder:ie,withInlineLabel:!1}),(0,c.tZ)(m.hJM,{loading:J,maxHeight:400,matchTriggerWidth:!0,children:!J&&(0,c.tZ)(m.X_T,{children:(0,c.tZ)(m.MWX,{autoFocus:!0,children:G.map((e=>(0,c.BX)(m.PC4,{value:e.name,onChange:e=>{b(e)},checked:v===e.name,children:[e.name,(0,c.tZ)(m.Bpn,{children:e.model.name})]},e.name)))})})})]}),(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"Iq0d/V",defaultMessage:"These endpoints come from the MLflow deployment. Check out the MLflow deployment documentation to get started"}),placement:"right",children:(0,c.tZ)(y.f,{css:(0,f.iv)({marginLeft:p.spacing.sm,color:p.colors.textSecondary},"")})})]}),v&&(0,c.tZ)(Xt,{parameters:h,updateParameter:g}),(0,c.tZ)("div",{css:an.formItem,children:(0,c.BX)(c.HY,{children:[(0,c.BX)(m.lNd.Label,{htmlFor:"new_run_name",children:[(0,c.tZ)(C.Z,{id:"Zqj4VA",defaultMessage:"New run name"}),!x.trim()&&(0,c.tZ)(m.lNd.Message,{type:"error",message:z.formatMessage({id:"dYbJha",defaultMessage:"Please provide run name"})})]}),(0,c.tZ)(y.h,{id:"new_run_name","data-testid":"run-name-input",required:!0,value:x,onChange:e=>Z(e.target.value)})]})})]}),(0,c.BX)("div",{children:[(0,c.BX)("div",{css:an.formItem,children:[(0,c.BX)(c.HY,{children:[(0,c.BX)("div",{css:nn,children:[(0,c.tZ)(m.lNd.Label,{htmlFor:"prompt_template",children:(0,c.tZ)(C.Z,{id:"uBTAtY",defaultMessage:"Prompt Template"})}),(0,c.tZ)(y.B,{onClick:()=>P(!0),style:{marginLeft:"auto"},size:"small",children:(0,c.tZ)(C.Z,{id:"13vJft",defaultMessage:"View Examples"})})]}),(0,c.tZ)(m.lNd.Hint,{children:(0,c.tZ)(C.Z,{id:"gC2Kxm",defaultMessage:"Give instructions to the model. Use '{{ }}' or the \"Add new variable\" button to add variables to your prompt."})})]}),(0,c.tZ)(Gt,{id:"prompt_template",autoSize:{minRows:3},"data-testid":"prompt-template-input",value:Y,onChange:e=>q(e.target.value),ref:$}),(0,c.tZ)(Ft,{violations:W})]}),_.map((e=>(0,c.tZ)("div",{css:an.formItem,children:(0,c.BX)(c.HY,{children:[(0,c.tZ)(m.lNd.Label,{htmlFor:e,children:(0,c.tZ)("span",{children:e})}),(0,c.tZ)(Gt,{id:e,autoSize:!0,value:V[e]?V[e]:"",onChange:t=>F(e,t.target.value)})]})},e))),(0,c.tZ)("div",{css:(0,f.iv)({marginBottom:2*p.spacing.md},""),children:(0,c.tZ)(y.B,{icon:(0,c.tZ)(m.pOD,{}),onClick:j,children:(0,c.tZ)(C.Z,{id:"71hvMu",defaultMessage:"Add new variable"})})}),(0,c.tZ)(Qt,{evaluateButtonTooltip:me,evaluationMetadata:I,evaluationOutput:B,disabled:!ce,isEvaluating:R,isOutputDirty:D,onCancelClick:re,onEvaluateClick:ne,evaluationError:E})]})]}),w&&(0,c.tZ)("div",{css:(0,f.iv)({inset:0,backgroundColor:p.colors.overlayOverlay,position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1},""),children:(0,c.tZ)(y.S,{})})]})},an={formItem:{marginBottom:16}},ln=r.createContext({createNewRun:()=>{}}),sn=e=>{let{children:t,visibleRuns:n}=e;const[a,i]=(0,r.useState)(!1),[l,s]=(0,r.useState)(null),o=(0,r.useMemo)((()=>({createNewRun:e=>{i(!0),s(e||null)}})),[]);return(0,c.BX)(ln.Provider,{value:o,children:[t,(0,ce.sq)()&&(0,c.tZ)(rn,{visibleRuns:n,isOpen:a,closeModal:()=>i(!1),runBeingDuplicated:l})]})},on=()=>(0,r.useContext)(ln),dn=r.memo((e=>{let{searchFacetsState:t,updateSearchFacets:n,experimentId:i,runsData:l,viewState:s,updateViewState:o,onDownloadCsv:d,requestError:u,additionalControls:p}=e;const h=de().length>1,{compareRunsMode:g,startTime:v,lifecycleFilter:b,datasetsFilter:x,searchFilter:Z}=t,w=(0,a.Z)(),{createNewRun:k}=on(),[R,M]=(0,r.useState)(!1),{theme:E}=(0,y.u)(),T=(0,r.useMemo)((()=>(0,q.u5)(w)),[w]),B=b===Y.VW.ACTIVE?w.formatMessage({id:"0pdAuV",defaultMessage:"Active"}):w.formatMessage({id:"yJpGwW",defaultMessage:"Deleted"}),A=(0,c.tZ)(c.HY,{children:(0,c.tZ)(C.Z,{id:"+fb25b",defaultMessage:"Time created"})}),I=void 0===g||"ARTIFACT"===g,L=(0,S.v9)((e=>e.entities.datasetsByExperimentId[i])),D=(0,r.useCallback)((e=>{n((t=>({...t,datasetsFilter:x.some((t=>ft(t,e)))?x.filter((t=>!ft(t,e))):[...x,e]})))}),[n,x]),N=void 0!==L,O=(0,r.useCallback)((e=>{n({searchFilter:e})}),[n]);return(0,c.BX)("div",{css:cn.groupBar,children:[(0,c.BX)("div",{css:cn.controlBar,children:[(0,c.tZ)(ht,{runsData:l,searchFilter:Z,onSearchFilterChange:O,onClear:()=>n(ue),requestError:u}),(0,c.BX)(m.M6x,{label:A,value:"ALL"!==v?[T[v]]:[],children:[(0,c.tZ)(m.Aa0,{allowClear:"ALL"!==v,onClear:()=>n({startTime:"ALL"}),"data-test-id":"start-time-select-dropdown"}),(0,c.tZ)(m.hJM,{children:(0,c.tZ)(m.X_T,{children:Object.keys(T).map((e=>(0,c.tZ)(m.PC4,{checked:e===v,title:T[e],"data-test-id":`start-time-select-${e}`,value:e,onChange:()=>n({startTime:e}),children:T[e]},e)))})})]}),(0,c.BX)(m.M6x,{label:(0,c.tZ)(C.Z,{id:"iLFoPb",defaultMessage:"State"}),value:[B],children:[(0,c.tZ)(m.Aa0,{allowClear:!1,"data-testid":"lifecycle-filter"}),(0,c.tZ)(m.hJM,{children:(0,c.BX)(m.X_T,{children:[(0,c.tZ)(m.PC4,{checked:b===Y.VW.ACTIVE,"data-testid":"active-runs-menu-item",value:Y.VW.ACTIVE,onChange:()=>n({lifecycleFilter:Y.VW.ACTIVE}),children:(0,c.tZ)(C.Z,{id:"0pdAuV",defaultMessage:"Active"})},Y.VW.ACTIVE),(0,c.tZ)(m.PC4,{checked:b===Y.VW.DELETED,"data-testid":"deleted-runs-menu-item",value:Y.VW.DELETED,onChange:()=>n({lifecycleFilter:Y.VW.DELETED}),children:(0,c.tZ)(C.Z,{id:"yJpGwW",defaultMessage:"Deleted"})},Y.VW.DELETED)]})})]}),(0,ce.hk)()&&(0,c.tZ)(m.M6x,{label:(0,c.tZ)(C.Z,{id:"IZ95jb",defaultMessage:"Datasets"}),value:x.map((e=>e.name)),multiSelect:!0,children:(0,c.BX)(y.e,{title:!N&&(0,c.tZ)(C.Z,{id:"v8UFxB",defaultMessage:"No datasets were recorded for this experiment's runs."}),children:[(0,c.tZ)(m.Aa0,{allowClear:!0,onClear:()=>n({datasetsFilter:[]}),"data-test-id":"datasets-select-dropdown",showTagAfterValueCount:1,disabled:!N}),N&&(0,c.tZ)(m.hJM,{maxHeight:600,children:(0,c.tZ)(m.X_T,{children:(0,c.tZ)(m.MWX,{children:L.map((e=>(0,c.BX)(m.VKe,{checked:x.some((t=>ft(t,e))),title:e.name,"data-test-id":`dataset-dropdown-${e.name}`,value:e.name,onChange:()=>D(e),children:[e.name," (",e.digest,")"," ",e.context&&(0,c.tZ)(m.Vp9,{css:(0,f.iv)({textTransform:"capitalize",marginRight:E.spacing.xs},""),children:e.context})]},e.name+e.digest+e.context)))})})})]})}),p]}),(0,c.tZ)("div",{css:cn.groupSeparator}),(0,c.BX)("div",{css:cn.controlBar,children:[(0,c.tZ)(m.Ltx,{trigger:["click"],placement:"bottomRight",overlay:(0,c.tZ)(m.v2r,{children:(0,c.BX)(m.v2r.Item,{className:"csv-button",onClick:d,children:[(0,c.tZ)(m._8t,{})," ",(0,c.tZ)(C.Z,{id:"rOnjGB",defaultMessage:"Download CSV"})]})}),children:(0,c.tZ)(y.B,{icon:(0,c.tZ)(m.VZO,{})})}),(0,c.tZ)(Et,{isOpen:R,closeModal:()=>M(!1),experimentId:i}),!h&&(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"17vAZ0",defaultMessage:"Click to {isMaximized, select, true {restore} other {maximize}} the view",values:{isMaximized:s.viewMaximized}}),children:(0,c.tZ)(Pe,{pressed:s.viewMaximized,icon:s.viewMaximized?(0,c.tZ)(m.wvt,{}):(0,c.tZ)(m.$_3,{}),onClick:()=>o({viewMaximized:!s.viewMaximized})})},s.viewMaximized.toString()),(0,ce.Hi)()&&I&&(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"eZOxx1",defaultMessage:"Toggle the preview sidepane"}),children:(0,c.tZ)(Pe,{pressed:s.previewPaneVisible,icon:(0,c.tZ)(m.BSo,{}),onClick:()=>o({previewPaneVisible:!s.previewPaneVisible})})}),(0,c.tZ)(lt,{}),(0,ce.sq)()&&!h&&(0,c.BX)(y.O.Root,{children:[(0,c.tZ)(y.O.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{type:"primary",icon:(0,c.tZ)(m.pOD,{}),children:(0,c.tZ)(C.Z,{id:"PEYesH",defaultMessage:"New run"})})}),(0,c.BX)(y.O.Content,{children:[(0,c.BX)(y.O.Item,{onSelect:()=>k(),children:[" ",(0,c.tZ)(C.Z,{id:"UmwZQv",defaultMessage:"using Prompt Engineering"})," ",(0,c.tZ)(m.Vp9,{style:{marginLeft:"4px"},color:"turquoise",children:(0,c.tZ)(C.Z,{id:"8qJt7/",defaultMessage:"Experimental"})})]}),(0,c.BX)(y.O.Item,{onSelect:()=>M(!0),children:[" ",(0,c.tZ)(C.Z,{id:"vNRmQa",defaultMessage:"using Notebook"})]})]})]})]})]})})),cn={groupBar:{display:"grid",gridTemplateColumns:"auto 1fr auto"},controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center",flexWrap:"wrap"}),groupSeparator:e=>({minWidth:e.spacing.sm}),columnSwitch:{margin:"5px"},searchBox:e=>({display:"flex",gap:e.spacing.sm,width:560}),lifecycleFilters:e=>({display:"flex",gap:8,alignItems:"center",marginTop:e.spacing.sm,marginBottom:e.spacing.sm,marginLeft:2*e.spacing.lg})};var un={name:"1j5vobt",styles:"display:flex;align-items:center;gap:4px"},pn={name:"1j5vobt",styles:"display:flex;align-items:center;gap:4px"};const mn=r.memo((e=>{let{orderByKey:t,orderByAsc:n,sortOptions:a,onSortKeyChanged:i}=e;const{theme:l}=(0,y.u)(),s=(0,r.useMemo)((()=>`${t}${Y.T_}${n?Y.aU:Y.iX}`),[n,t]),o=(0,r.useMemo)((()=>{const e=a.find((e=>e.value===s));let r=null===e||void 0===e?void 0:e.label;if(!r){const e=t.match(/^.+\.`(.+)`$/);e&&(r=e[1])}return(0,c.BX)("span",{css:un,children:[n?(0,c.tZ)(m.TV4,{}):(0,c.tZ)(m.mcG,{})," ",(0,c.tZ)(C.Z,{id:"llrWuc",defaultMessage:"Sort"}),": ",r]})}),[s,n,t,a]),d=e=>{i({value:e})};return(0,c.BX)(m.M6x,{label:o,children:[(0,c.tZ)(m.Aa0,{onClear:()=>{i({value:""})},"data-test-id":"sort-select-dropdown"}),(0,c.tZ)(m.hJM,{minWidth:250,children:(0,c.tZ)(m.X_T,{children:(0,c.tZ)(m.MWX,{children:a.map((e=>(0,c.tZ)(m.PC4,{value:e.value,onChange:d,checked:e.value===s,"data-test-id":`sort-select-${e.label}-${e.order}`,children:(0,c.BX)("span",{css:pn,children:[e.order===Y.aU?(0,c.tZ)(m.Hf3,{}):(0,c.tZ)(m.veu,{}),(0,be.mJ)(e.label,50)]})},e.value)))})})})]})})),hn=e=>{const{updateSearchFacets:t,searchFacetsState:n}=Ie(),{orderByAsc:r,orderByKey:a}=n,{enableSorting:i,canonicalSortKey:l,displayName:s}=e,{theme:o}=(0,y.u)();return(0,c.BX)("div",{role:"columnheader",css:(0,f.iv)({height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",svg:{color:o.colors.textSecondary},"&:hover":{color:i?o.colors.actionTertiaryTextHover:"unset",svg:{color:o.colors.actionTertiaryTextHover}}},""),className:l===a?"is-ordered-by":"",onClick:i?()=>(()=>{let e=!r;l!==a&&(e=!1),t({orderByKey:l,orderByAsc:e})})():void 0,children:[(0,c.tZ)("span",{"data-test-id":`sort-header-${s}`,children:s}),i&&l===a?r?(0,c.tZ)(m.TV4,{}):(0,c.tZ)(m.mcG,{}):null]})},gn=()=>(0,c.tZ)(m.oOx,{css:e=>({color:e.colors.textValidationDanger})}),fn=()=>(0,c.tZ)(m.rE2,{css:e=>({color:e.colors.textValidationSuccess})}),vn=e=>{switch(e){case"FAILED":case"KILLED":return(0,c.tZ)(gn,{});case"FINISHED":return(0,c.tZ)(fn,{});case"SCHEDULED":return(0,c.tZ)(m.T39,{});default:return null}},yn=r.memo((e=>{let{value:{startTime:t,referenceTime:n,runStatus:r}}=e;return(0,c.BX)("span",{css:bn.cellWrapper,title:l.default.formatTimestamp(t),children:[vn(r),l.default.timeSinceStr(t,n)]})})),bn={cellWrapper:e=>({display:"flex",alignItems:"center",gap:e.spacing.sm,svg:{width:14,height:14}})},Cn=r.memo((e=>{let{data:t,value:n}=e;return(0,c.tZ)(Q.rU,{to:G.ZP.getExperimentPageRoute(t.experimentId),title:n.name,children:n.basename})})),xn=e=>{let{text:t,maxSize:n,className:a,allowShowMore:i=!1}=e;if(t.length<=n)return(0,c.tZ)("span",{className:a,children:t});const l=`${t.substr(0,n)}...`,[s,o]=(0,r.useState)(!1);return(0,c.BX)("span",{className:a,children:[s?t:l,i&&(0,c.tZ)(y.B,{type:"link",onClick:()=>o(!s),size:"small",css:Zn.expandButton,"data-test-id":"trimmed-text-button",children:s?"collapse":"expand"})]})},Zn={expandButton:{display:"inline-block"}};var wn=n.p+"static/media/logged-model.dd9b21ff4fb07f3cadeada8046a2693b.svg";var Sn=n.p+"static/media/registered-model.24429a4f6158e57b01b3928e2605aa25.svg",kn=n(99725);const Rn=r.memo((e=>{const{registeredModels:t,loggedModels:n,experimentId:r,runUuid:a}=e.value,i=l.default.mergeLoggedAndRegisteredModels(n,t);if(i&&i.length){const e=i[0];let t;if(e.registeredModelName){const{registeredModelName:n,registeredModelVersion:r}=e;let a=l.default.getIframeCorrectedRoute(kn.kf.getModelVersionPageRoute(n,r)),i=n;const s=`${n} version ${r}`;t=(0,c.BX)(c.HY,{children:[(0,c.tZ)("img",{"data-test-id":"registered-model-icon",alt:"",title:"Registered Model",src:Sn}),(0,c.tZ)(y.e,{title:s,children:(0,ce.ss)()?(0,c.BX)(Q.rU,{to:a,target:"_blank",className:"registered-model-link",rel:"noreferrer",children:[(0,c.tZ)(xn,{text:i,maxSize:10,className:"model-name"}),`/${r}`]}):(0,c.BX)("a",{href:a,className:"registered-model-link",target:"_blank",rel:"noreferrer",children:[(0,c.tZ)(xn,{text:i,maxSize:10,className:"model-name"}),`/${r}`]})})]})}else if(e.flavors){const n=e.flavors?e.flavors[0]:"Model",i=G.ZP.getRunPageRoute(r,a,e.artifactPath);t=(0,c.BX)(c.HY,{children:[(0,c.tZ)("img",{"data-test-id":"logged-model-icon",alt:"",title:"Logged Model",src:wn}),(0,c.tZ)(Q.rU,{to:i,target:"_blank",className:"logged-model-link",children:n})]})}return(0,c.BX)("div",{className:"logged-model-cell",css:Mn.imageWrapper,children:[t,n.length>1?`, ${n.length-1} more`:""]})}return(0,c.tZ)(c.HY,{children:"-"})})),Mn={imageWrapper:{img:{height:"15px",position:"relative",marginRight:"4px"}}},En=r.memo((e=>{let{value:t}=e;const n=l.default.renderSource(t,void 0,void 0);return n?(0,c.BX)(c.HY,{children:[l.default.renderSourceTypeIcon(t),n]}):(0,c.tZ)(c.HY,{children:"-"})})),Tn=r.memo((e=>{let{value:{version:t,name:n,type:r}}=e;return l.default.renderSourceVersion(t,n,r)||(0,c.tZ)(c.HY,{children:"-"})})),Bn={mouseEnterDelay:0,mouseLeaveDelay:0},An=r.memo((e=>{const{pinned:t,hidden:n}=e.value;return(0,c.BX)("div",{css:In.actionsContainer,children:[(0,c.tZ)(y.e,{dangerouslySetAntdProps:Bn,placement:"right",title:n?(0,c.tZ)(C.Z,{id:"xmpvlI",defaultMessage:"Unhide run"}):(0,c.tZ)(C.Z,{id:"qTjYVU",defaultMessage:"Hide run"}),children:(0,c.BX)("label",{css:In.actionCheckbox,className:"is-visibility-toggle",children:[(0,c.tZ)("input",{type:"checkbox",checked:!n,onChange:()=>{e.onToggleVisibility(e.data.runUuid)}}),n?(0,c.tZ)(m.wJG,{}):(0,c.tZ)(m.bMb,{})]})}),e.data.pinnable&&(0,c.tZ)(y.e,{dangerouslySetAntdProps:Bn,placement:"right",title:t?(0,c.tZ)(C.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,c.tZ)(C.Z,{id:"fjiojF",defaultMessage:"Pin run"}),children:(0,c.BX)("label",{css:In.actionCheckbox,className:"is-pin-toggle","data-testid":"column-pin-toggle",children:[(0,c.tZ)("input",{type:"checkbox",checked:t,onChange:()=>{e.onTogglePin(e.data.runUuid)}}),t?(0,c.tZ)(m.D$V,{}):(0,c.tZ)(m.qQX,{})]})})]})}),((e,t)=>e.value.hidden===t.value.hidden&&e.value.pinned===t.value.pinned)),In={actionsContainer:()=>({display:"flex",gap:18}),actionCheckbox:e=>({input:{width:0,appearance:"none"},cursor:"pointer",display:"flex",svg:{width:14,height:14,cursor:"pointer"},"&.is-pin-toggle svg":{color:"transparent",".ag-row:hover &":{color:e.colors.grey600}},"&.is-visibility-toggle svg":{color:e.colors.grey400,".ag-row:hover &":{color:e.colors.grey600}},"& input:checked + span svg":{color:e.colors.grey600}})},Ln=r.memo((e=>(0,c.BX)(y.O.Root,{modal:!1,children:[(0,c.tZ)(y.O.Trigger,{asChild:!0,children:(0,c.tZ)("button",{css:Dn.actionButton,"data-testid":"experiment-view-runs-visibility-column-header",children:e.allRunsHidden?(0,c.tZ)(m.wJG,{}):(0,c.tZ)(m.bMb,{})})}),(0,c.BX)(y.O.Content,{children:[(0,c.BX)(y.O.Item,{onClick:()=>e.onToggleVisibility(q.yz.HIDEALL),"data-testid":"experiment-view-runs-visibility-hide-all",children:[(0,c.tZ)(y.O.IconWrapper,{children:(0,c.tZ)(m.wJG,{})}),(0,c.tZ)(C.Z,{id:"UEESlL",defaultMessage:"Hide all runs"})]}),(0,c.BX)(y.O.Item,{onClick:()=>e.onToggleVisibility(q.yz.SHOWALL),"data-testid":"experiment-view-runs-visibility-show-all",children:[(0,c.tZ)(y.O.IconWrapper,{children:(0,c.tZ)(m.bMb,{})}),(0,c.tZ)(C.Z,{id:"4yjF8O",defaultMessage:"Show all runs"})]})]})]}))),Dn={actionButton:e=>({background:"transparent",border:"none",cursor:"pointer",padding:"8px",".ag-checkbox:not(.ag-hidden) + &":{padding:"0 1px"},svg:{width:14,height:14,cursor:"pointer",color:e.colors.grey600}})},Nn=r.memo((e=>{let{onExpand:t,data:{runName:n,experimentId:r,runUuid:a,runDateAndNestInfo:i,color:l}}=e;const{hasExpander:s,expanderOpen:o,childrenIds:d,level:u}=i||{},p=!isNaN(u)&&s;return(0,c.BX)("div",{css:On.cellWrapper,children:[(0,c.tZ)("div",{css:On.expanderWrapper,children:(0,c.tZ)("div",{css:On.nestLevel(u),children:p&&(0,c.tZ)(y.B,{css:On.expanderButton,size:"small",onClick:()=>{t(a,d)},type:"link",icon:o?(0,c.tZ)(m.uSo,{}):(0,c.tZ)(m.IAe,{})},"Expander-"+a)})}),(0,c.BX)(Q.rU,{to:G.ZP.getRunPageRoute(r,a),css:On.runLink,children:[(0,c.tZ)("div",{css:On.colorPill,"data-testid":"experiment-view-table-run-color",style:{backgroundColor:l}}),(0,c.tZ)("span",{css:On.runName,children:n})]})]})})),On={link:e=>({display:"inline-block",minWidth:e.typography.fontSizeBase,minHeight:e.typography.fontSizeBase}),cellWrapper:{display:"flex"},expanderButton:{svg:{width:12,height:12}},runLink:{overflow:"hidden",display:"flex",gap:8,alignItems:"center"},runName:{overflow:"hidden",textOverflow:"ellipsis"},expanderWrapper:{display:"none",".ag-grid-expanders-visible &":{display:"block"}},colorPill:{width:12,height:12,borderRadius:6,flexShrink:0,"@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)":{marginBottom:1}},nestLevel:e=>t=>({display:"flex",justifyContent:"flex-end",width:(e+1)*t.spacing.lg,height:t.spacing.lg})};var Pn={name:"gikiyg",styles:"display:flex;justify-content:center;align-items:center;height:32px"};const Hn=r.memo((e=>{let{loadMoreRunsFunc:t}=e;return(0,c.tZ)("div",{css:Pn,children:(0,c.tZ)(y.B,{type:"primary",onClick:t,size:"small",children:(0,c.tZ)(C.Z,{id:"9CqEWy",defaultMessage:"Load more"})})})}));var Xn={name:"rnnx2x",styles:"font-size:12px"},zn={name:"rnnx2x",styles:"font-size:12px"};const Un=e=>{let{datasetWithTags:t,onDatasetSelected:n,appendComma:r=!1,inPopover:a=!1}=e;const{theme:i}=(0,y.u)(),{dataset:l,tags:s}=t;if(!l)return null;const o=null===s||void 0===s?void 0:s.find((e=>{let{key:t}=e;return t===Y.Ak}));return(0,c.BX)("div",{css:(0,f.iv)({display:"flex",flexShrink:0,alignItems:"center",overflow:"hidden",marginRight:i.spacing.xs},""),children:[(0,c.tZ)(m.$eq,{css:(0,f.iv)({color:i.colors.textSecondary,marginRight:i.spacing.xs},"")})," ",(0,c.tZ)("span",{css:(0,f.iv)({minWidth:32,marginRight:i.spacing.xs,flexShrink:0},""),title:`${l.name} (${l.digest})`,children:a?(0,c.tZ)(m.J2e.Close,{asChild:!0,children:(0,c.tZ)(y.B,{type:"link",onClick:n,children:(0,c.BX)("span",{css:Xn,children:[l.name," (",l.digest,")"]})})}):(0,c.tZ)(y.B,{type:"link",onClick:n,children:(0,c.BX)("span",{children:[l.name," (",l.digest,")"]})})}),o&&(0,c.tZ)(m.Vp9,{css:(0,f.iv)({textTransform:"capitalize",marginRight:i.spacing.xs},""),children:(0,c.tZ)("span",{css:zn,children:o.value})}),r&&(0,c.tZ)(c.HY,{children:","})]})};var _n={name:"zjik7",styles:"display:flex"},Vn={name:"eq7f8j",styles:"display:flex;align-items:flex-end"},Fn={name:"h1n7cn",styles:"max-height:400px;overflow:auto"};const Wn=r.memo((e=>{let{value:t,data:n,onDatasetSelected:a,expandRows:i}=e;const l=(0,r.useRef)(null),[o,d]=(0,r.useState)(0),[u,p]=(0,r.useState)(!1),h=(0,r.useMemo)((()=>t.slice(0,3)),[t]),{theme:g}=(0,y.u)(),v=t.length;(0,r.useEffect)((()=>{if(!l.current)return()=>{};const e=(0,s.throttle)((e=>{let[t]=e;if(i){const e=t.contentRect.height;let n=0,r=0;for(let a=0;a<t.target.children.length;a++){const i=t.target.children.item(a);if(r+i.clientHeight>e)break;r+=i.clientHeight,n++}d(n),p(n<v)}else{const e=t.contentRect.width;if(0===e&&v)return d(0),void p(!0);let n=0,r=0;for(let i=0;i<t.target.children.length;i++){const a=t.target.children.item(i);if(r+a.clientWidth>=e)break;r+=a.clientWidth,n++}const a=Math.min(v,n+1);d(a),p(n<v)}}),100),t=new ResizeObserver(e);return t.observe(l.current),()=>t.disconnect()}),[i,v]);const b=v-o;if(!t||v<1)return(0,c.tZ)(c.HY,{children:"-"});const C=i?h:t;return(0,c.BX)("div",{css:_n,children:[(0,c.tZ)("div",{css:(0,f.iv)({overflow:"hidden",display:"flex",flexDirection:i?"column":"row"},""),ref:l,children:C.map(((e,t)=>(0,c.tZ)(Un,{appendComma:!i&&t<C.length-1,datasetWithTags:e,onDatasetSelected:()=>null===a||void 0===a?void 0:a(e,n)},`${e.dataset.name}-${e.dataset.digest}`)))}),(b>0||u)&&(0,c.BX)("div",{css:Vn,children:[!i&&u&&(0,c.tZ)("span",{css:(0,f.iv)({paddingLeft:0,paddingRight:g.spacing.xs},""),children:"\u2026"}),b>0&&(0,c.BX)(m.J2e.Root,{modal:!1,children:[(0,c.tZ)(m.J2e.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{size:"small",style:{borderRadius:"8px",width:"40px"},children:(0,c.BX)(y.T.Text,{color:"secondary",children:["+",b]})})}),(0,c.tZ)(m.J2e.Content,{align:"start",css:Fn,children:t.slice(v-b).map((e=>(0,c.tZ)("div",{css:(0,f.iv)({height:g.general.heightSm,display:"flex",alignItems:"center"},""),children:(0,c.tZ)(Un,{datasetWithTags:e,onDatasetSelected:()=>null===a||void 0===a?void 0:a(e,n),inPopover:!0})},`${e.dataset.name}-${e.dataset.digest}`)))})]})]})]})})),Kn=e=>{var t;let{colDef:n,context:r}=e;return r.orderByKey===(null===(t=n.headerComponentParams)||void 0===t?void 0:t.canonicalSortKey)},jn=e=>e?70:104,$n=e=>`${q.uX}-${e}`,Yn=e=>`${q.im}-${e}`,qn=e=>`${q.qr}-${e}`,Qn=e=>{let{loading:t,...n}=e;return(0,y.S)({loading:!1,...n})},Gn={[Y.XZ.USER]:(0,q.Q0)(Y.D5.ATTRIBUTES,"User"),[Y.XZ.RUN_NAME]:(0,q.Q0)(Y.D5.ATTRIBUTES,"Run Name"),[Y.XZ.SOURCE]:(0,q.Q0)(Y.D5.ATTRIBUTES,"Source"),[Y.XZ.VERSION]:(0,q.Q0)(Y.D5.ATTRIBUTES,"Version")},Jn=e=>{let{data:t}=e;return t.runUuid},er=e=>{let{rowNode:t}=e;return t.data.isLoadMoreRow},tr=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[Y.z.USER,Y.z.SOURCE,Y.z.VERSION,Y.z.MODELS];return(0,ce.GW)()&&t.push(Y.z.DATASET),e&&t.push(Y.z.EXPERIMENT_NAME),t},nr=e=>{let{selectedColumns:t,compareExperiments:n,onTogglePin:a,onToggleVisibility:i,onExpand:o,paramKeyList:d,metricKeyList:c,tagKeyList:u,columnApi:p,onDatasetSelected:m,isComparingRuns:h,expandRows:g,allRunsHidden:f}=e;const v=(e=>{let{paramKeyList:t,metricKeyList:n,tagKeyList:a}=e;const i=(0,r.useRef)(new Set),l=(0,r.useRef)(new Set),s=(0,r.useRef)(new Set),o=(0,r.useMemo)((()=>(t.forEach((e=>l.current.add(e))),Array.from(l.current))),[t]),d=(0,r.useMemo)((()=>(n.forEach((e=>i.current.add(e))),Array.from(i.current))),[n]),c=(0,r.useMemo)((()=>(a.forEach((e=>s.current.add(e))),Array.from(s.current))),[a]);return(0,r.useMemo)((()=>({paramKeys:o,metricKeys:d,tagKeys:c})),[d,o,c])})({metricKeyList:c,tagKeyList:u,paramKeyList:d}),y=(0,r.useMemo)((()=>{const e=[];if(e.push({valueGetter:e=>{let{data:{pinned:t,hidden:n}}=e;return{pinned:t,hidden:n}},checkboxSelection:!h,headerComponent:"RowActionsHeaderCellRenderer",headerComponentParams:{onToggleVisibility:i,allRunsHidden:f},headerCheckboxSelection:!h,headerName:"",cellClass:"is-checkbox-cell",cellRenderer:"RowActionsCellRenderer",cellRendererParams:{onTogglePin:a,onToggleVisibility:i},pinned:"left",minWidth:jn(h),width:jn(h),maxWidth:jn(h),resizable:!1}),e.push({headerName:Y.z.RUN_NAME,colId:Gn[Y.XZ.RUN_NAME],headerTooltip:Y.XZ.RUN_NAME,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"RunNameCellRenderer",cellRendererParams:{onExpand:o},equals:(e,t)=>(0,s.isEqual)(e,t),headerComponentParams:{canonicalSortKey:Y.XZ.RUN_NAME},cellClassRules:{"is-ordered-by":Kn},initialWidth:310,resizable:!h}),h)return e;e.push({headerName:Y.z.DATE,headerTooltip:Y.XZ.DATE,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"DateCellRenderer",cellRendererParams:{onExpand:o},equals:(e,t)=>(0,s.isEqual)(e,t),headerComponentParams:{canonicalSortKey:Y.XZ.DATE},cellClassRules:{"is-ordered-by":Kn},initialWidth:150}),(0,ce.GW)()&&e.push({headerName:Y.z.DATASET,colId:(0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.DATASET),headerTooltip:Y.z.DATASET,sortable:!1,field:"datasets",cellRenderer:"DatasetsCellRenderer",cellRendererParams:{onDatasetSelected:m,expandRows:g},cellClass:"is-multiline-cell",initialWidth:300}),e.push({headerName:Y.z.DURATION,field:"duration",initialWidth:80}),n&&e.push({headerName:Y.z.EXPERIMENT_NAME,colId:(0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.EXPERIMENT_NAME),field:"experimentName",cellRenderer:"ExperimentNameCellRenderer",equals:(e,t)=>(0,s.isEqual)(e,t),initialWidth:140,initialHide:!0}),e.push({headerName:Y.z.USER,colId:Gn[Y.XZ.USER],headerTooltip:Y.XZ.USER,field:"user",sortable:!0,headerComponentParams:{canonicalSortKey:Y.XZ.USER},cellClassRules:{"is-ordered-by":Kn},initialHide:!0}),e.push({headerName:Y.z.SOURCE,colId:Gn[Y.XZ.SOURCE],field:"tags",cellRenderer:"SourceCellRenderer",equals:(e,t)=>l.default.getSourceName(e)===l.default.getSourceName(t),sortable:!0,headerComponentParams:{canonicalSortKey:Y.XZ.SOURCE},cellClassRules:{"is-ordered-by":Kn},initialHide:!0}),e.push({headerName:Y.z.VERSION,colId:Gn[Y.XZ.VERSION],field:"version",cellRenderer:"VersionCellRenderer",equals:(e,t)=>(0,s.isEqual)(e,t),sortable:!0,headerComponentParams:{canonicalSortKey:Y.XZ.VERSION},cellClassRules:{"is-ordered-by":Kn},initialHide:!0}),e.push({headerName:Y.z.MODELS,colId:(0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.MODELS),field:"models",cellRenderer:"ModelsCellRenderer",initialWidth:200,equals:(e,t)=>(0,s.isEqual)(e,t),initialHide:!0});const{metricKeys:t,paramKeys:r,tagKeys:d}=v;return t.length&&e.push({headerName:"Metrics",groupId:Y.D5.METRICS,children:t.map((e=>{const t=(0,q.Q0)(Y.D5.METRICS,e);return{headerName:e,colId:t,headerTooltip:(0,q.yC)(Y.D5.METRICS,e),field:Yn(e),tooltipField:Yn(e),initialWidth:100,initialHide:!0,sortable:!0,headerComponentParams:{canonicalSortKey:t},cellClassRules:{"is-previewable-cell":()=>!0,"is-ordered-by":Kn}}}))}),r.length&&e.push({headerName:"Parameters",groupId:Y.D5.PARAMS,children:r.map((e=>{const t=(0,q.Q0)(Y.D5.PARAMS,e);return{colId:t,headerName:e,headerTooltip:(0,q.yC)(Y.D5.PARAMS,e),field:$n(e),tooltipField:$n(e),initialHide:!0,initialWidth:100,sortable:!0,headerComponentParams:{canonicalSortKey:t},cellClassRules:{"is-previewable-cell":()=>!0,"is-ordered-by":Kn}}}))}),d.length&&e.push({headerName:"Tags",colId:Y.D5.TAGS,children:d.map((e=>({colId:(0,q.Q0)(Y.D5.TAGS,e),headerName:e,initialHide:!0,initialWidth:100,headerTooltip:(0,q.yC)(Y.D5.TAGS,e),field:qn(e),tooltipField:qn(e)})))}),e}),[a,i,o,n,v,h,m,g,f]),b=(0,r.useMemo)((()=>[...tr(!0).map((e=>(0,q.Q0)(Y.D5.ATTRIBUTES,e))),...v.paramKeys.map((e=>(0,q.Q0)(Y.D5.PARAMS,e))),...v.metricKeys.map((e=>(0,q.Q0)(Y.D5.METRICS,e))),...v.tagKeys.map((e=>(0,q.Q0)(Y.D5.TAGS,e)))]),[v]);return(0,r.useEffect)((()=>{if(p&&!h)for(const e of b){const n=t.includes(e);p.setColumnVisible(e,n)}}),[t,p,b,h]),y},rr={initialWidth:100,autoSizePadding:0,headerComponentParams:{menuIcon:"fa-bars"},resizable:!0,filter:!0,suppressMenu:!0,suppressMovable:!0},ar="GROUP",ir=(0,q.Q0)(ar,Y.D5.ATTRIBUTES),lr=(0,q.Q0)(ar,Y.D5.PARAMS),sr=(0,q.Q0)(ar,Y.D5.METRICS),or=(0,q.Q0)(ar,Y.D5.TAGS),dr=(e,t)=>e.filter((e=>e.toLowerCase().includes(t.toLowerCase()))),cr=(e,t)=>{if(!t)return e;const n=e.toLowerCase().indexOf(t.toLowerCase()),r=e.substring(0,n),a=e.substring(n,n+t.length),i=e.substring(n+t.length);return n>-1?(0,c.BX)("span",{children:[r,(0,c.tZ)("strong",{children:a}),i]}):e},ur=r.memo((e=>{let{runsData:t,columnSelectorVisible:n,onChangeColumnSelectorVisible:a,updateSearchFacets:i,selectedColumns:s}=e;const o=de(),[d,u]=(0,r.useState)(""),p=(0,r.useRef)(null),h=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useMemo)((()=>(e=>{const t=[Y.z.USER,Y.z.SOURCE,Y.z.VERSION,Y.z.MODELS];return e&&t.unshift(Y.z.EXPERIMENT_NAME),(0,ce.GW)()&&t.unshift(Y.z.DATASET),t})(o.length>1)),[o.length]),v=(0,r.useCallback)((e=>i((t=>{const n=e(t.selectedColumns),r=Array.from(new Set(n));return{...t,selectedColumns:r}}))),[i]),b=(0,r.useMemo)((()=>l.default.getVisibleTagKeyList(t.tagsList)),[t]),x=(0,r.useMemo)((()=>({[Y.D5.ATTRIBUTES]:f.map((e=>(0,q.Q0)(Y.D5.ATTRIBUTES,e))),[Y.D5.PARAMS]:t.paramKeyList.map((e=>(0,q.Q0)(Y.D5.PARAMS,e))),[Y.D5.METRICS]:t.metricKeyList.map((e=>(0,q.Q0)(Y.D5.METRICS,e))),[Y.D5.TAGS]:b.map((e=>(0,q.Q0)(Y.D5.TAGS,e)))})),[t,f,b]),Z=(0,r.useMemo)((()=>{const e=[],n=dr(f,d),r=dr(t.paramKeyList,d),a=dr(t.metricKeyList,d),i=dr(b,d);return n.length&&e.push({key:ir,title:"Attributes",children:n.map((e=>({key:(0,q.Q0)(Y.D5.ATTRIBUTES,e),title:cr(e,d)})))}),a.length&&e.push({key:sr,title:`Metrics (${a.length})`,children:a.map((e=>({key:(0,q.Q0)(Y.D5.METRICS,e),title:cr(e,d)})))}),r.length&&e.push({key:lr,title:`Parameters (${r.length})`,children:r.map((e=>({key:(0,q.Q0)(Y.D5.PARAMS,e),title:cr(e,d)})))}),i.length&&e.push({key:or,title:`Tags (${i.length})`,children:i.map((e=>({key:(0,q.Q0)(Y.D5.TAGS,e),title:e})))}),e}),[f,d,t,b]),w=(0,r.useCallback)(((e,t)=>{v(e?e=>e.filter((e=>!t.includes(e))):e=>[...e,...t])}),[v]),S=(0,r.useCallback)(((e,t)=>{v(t?t=>t.filter((t=>t!==e)):t=>[...t,e])}),[v]);(0,r.useEffect)((()=>{n&&(u(""),requestAnimationFrame((()=>{var e,t;null===h||void 0===h||null===(e=h.current)||void 0===e||e.scrollTo(0,0),null===(t=p.current)||void 0===t||t.focus({preventScroll:!0}),g.current&&g.current.scrollIntoView({block:"nearest",behavior:"smooth"})})))}),[n]);const k=(0,r.useCallback)(((e,t)=>{let{node:{key:n,checked:r}}=t;if((0,q.ob)(n.toString(),ar)){const e=(0,q.hg)(n.toString(),ar),t=x[e];t&&w(r,dr(t,d))}else S(n.toString(),r)}),[x,w,S,d]),R=(0,r.useCallback)((e=>{if("ArrowDown"===e.key){const e=(null===(t=h.current)||void 0===t?void 0:t.querySelector('[role="tree"] input'))||null;e&&e.focus()}var t}),[]),M=(0,c.BX)("div",{css:mr.dropdown,children:[(0,c.tZ)("div",{css:e=>({padding:e.spacing.md}),children:(0,c.tZ)(y.h,{value:d,prefix:(0,c.tZ)(m.W1M,{}),placeholder:"Search columns",allowClear:!0,ref:p,onChange:e=>{u(e.target.value)},onKeyDown:R})}),(0,c.tZ)("div",{ref:h,css:mr.scrollableContainer,children:(0,c.tZ)(m.mpN,{"data-testid":"column-selector-tree",mode:"checkable",dangerouslySetAntdProps:{checkedKeys:s,onCheck:k},defaultExpandedKeys:[ir,lr,sr,or],treeData:Z})})]});return(0,c.tZ)(m.Ltx,{overlay:M,placement:"bottomLeft",trigger:["click"],visible:n,onVisibleChange:a,children:(0,c.BX)(y.B,{ref:g,style:{display:"flex",alignItems:"center"},"data-testid":"column-selection-dropdown",icon:(0,c.tZ)(m.SeN,{}),children:[(0,c.tZ)(C.Z,{id:"ny+fBZ",defaultMessage:"Columns"})," ",(0,c.tZ)(m.v4q,{})]})})})),pr=e=>{const{updateSearchFacets:t,searchFacetsState:n}=Ie();return(0,c.tZ)(ur,{...e,selectedColumns:n.selectedColumns,updateSearchFacets:t})},mr={dropdown:e=>({backgroundColor:e.colors.backgroundPrimary,width:400,border:"1px solid",borderColor:e.colors.border}),scrollableContainer:e=>({maxHeight:480,overflowY:"scroll",overflowX:"hidden",paddingBottom:e.spacing.md,"span[title]":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})};const hr="seenBefore";var gr={name:"b98nv4",styles:"position:absolute;inset:0"},fr={name:"1ww443i",styles:"max-width:200px"},vr={name:"2qga7i",styles:"text-align:right"};const yr=e=>{let{multipleRunsSelected:t,isComparingRuns:n}=e;const a=st("compareRunsTooltip"),[i,l]=(0,r.useState)(t&&!a.getItem(hr));(0,r.useEffect)((()=>{const e=a.getItem(hr);l(!(!t||n||e))}),[t,n,a]);const s=(0,r.useCallback)((e=>{l(e),a.setItem(hr,!0)}),[l,a]);return(0,c.tZ)(c.HY,{children:(0,c.BX)(m.J2e.Root,{open:i,children:[(0,c.tZ)(m.J2e.Trigger,{asChild:!0,children:(0,c.tZ)("div",{css:gr})}),(0,c.BX)(m.J2e.Content,{align:"start",children:[(0,c.BX)("div",{css:fr,children:[(0,c.tZ)(y.T.Paragraph,{children:(0,c.tZ)(C.Z,{id:"1ECve7",defaultMessage:"You can now switch to the chart view to compare runs"})}),(0,c.tZ)("div",{css:vr,children:(0,c.tZ)(y.B,{onClick:()=>s(!1),type:"primary",children:(0,c.tZ)(C.Z,{id:"khknxG",defaultMessage:"Got it"})})})]}),(0,c.tZ)(m.J2e.Arrow,{})]})]})})},br=e=>{let{compareRunsMode:t,setCompareRunsMode:n,viewState:r}=e;const a=void 0!==t,{classNamePrefix:i}=(0,y.u)(),l=t||"TABLE";return(0,c.BX)(m.Tabs,{dangerouslyAppendEmotionCSS:{[`.${i}-tabs-nav`]:{marginBottom:0,"::before":{border:"none"}}},activeKey:l,onChange:e=>n("TABLE"===e?void 0:e),children:[(0,c.tZ)(m.Tabs.TabPane,{tab:(0,c.tZ)("span",{"data-testid":"experiment-runs-mode-switch-list",children:(0,c.tZ)(C.Z,{id:"YOz/Dk",defaultMessage:"Table"})})},"TABLE"),(0,c.tZ)(m.Tabs.TabPane,{tab:(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{"data-testid":"experiment-runs-mode-switch-compare",children:(0,c.tZ)(C.Z,{id:"KOQzJx",defaultMessage:"Chart"})}),(0,c.tZ)(yr,{isComparingRuns:a,multipleRunsSelected:Object.keys(r.runsSelected).length>1})]})},"CHART"),(0,ce.Hi)()&&(0,c.tZ)(m.Tabs.TabPane,{tab:(0,c.BX)("span",{"data-testid":"experiment-runs-mode-switch-evaluation",children:[(0,c.tZ)(C.Z,{id:"SCqKp8",defaultMessage:"Evaluation"})," ",(0,c.tZ)(m.Vp9,{style:{marginLeft:"4px"},color:"turquoise",children:(0,c.tZ)(C.Z,{id:"8qJt7/",defaultMessage:"Experimental"})})]})},"ARTIFACT")]})},Cr=r.memo((e=>{let{runsData:t,viewState:n,updateViewState:a,updateSearchFacets:i,searchFacetsState:s,experimentId:o,requestError:d,expandRows:u,updateExpandRows:p}=e;const{paramKeyList:h,metricKeyList:g,tagsList:v}=t,{compareRunsMode:b,orderByAsc:x,orderByKey:Z}=s,w=void 0!==b,{theme:S}=(0,y.u)(),k=h,R=g,M=l.default.getVisibleTagKeyList(v),E=(0,r.useCallback)((()=>(0,q.XM)(t,M,k,R)),[R,k,M,t]),T=((e,t)=>(0,r.useMemo)((()=>{let n=[];const r=[Y.aU,Y.iX];return n=[...Object.keys(Y.Ul).reduce(((e,t)=>{const n=Y.Ul[t];return r.forEach((r=>{e.push({label:n,value:Y.XZ[t]+Y.T_+r,order:r})})),e}),[]),...e.reduce(((e,t)=>(r.forEach((n=>{e.push({label:t,value:`${(0,q.Q0)(Y.D5.METRICS,t)}${Y.T_}${n}`,order:n})})),e)),[]),...t.reduce(((e,t)=>(r.forEach((n=>{e.push({label:t,value:`${(0,q.Q0)(Y.D5.PARAMS,t)}${Y.T_}${n}`,order:n})})),e)),[])],n}),[e,t]))(R,k),B=Object.values(n.runsSelected).filter(Boolean).length,A=B>1||1===B||B>0,I=(0,r.useCallback)((e=>{let{value:t}=e;const[n,r]=t.split(Y.T_),a=Gn[n]||n,l=r===Y.aU;i((e=>{const{selectedColumns:t}=e;return t.includes(a)||t.push(a),{...e,selectedColumns:t,orderByKey:n,orderByAsc:l}}))}),[i]),L=(0,r.useCallback)((e=>a({columnSelectorVisible:e})),[a]),D=(0,r.useCallback)((()=>p(!u)),[u,p]),N=(0,r.useMemo)((()=>t.datasetsList.some((e=>(null===e||void 0===e?void 0:e.length)>1))),[t]);return(0,c.BX)("div",{css:(0,f.iv)({display:"flex",gap:S.spacing.sm,flexDirection:"column",marginTop:n.viewMaximized?void 0:S.spacing.md},""),children:[A&&(0,c.tZ)(Ne,{runsData:t,searchFacetsState:s,viewState:n}),!A&&(0,c.tZ)(dn,{onDownloadCsv:E,updateSearchFacets:i,searchFacetsState:s,experimentId:o,viewState:n,updateViewState:a,runsData:t,requestError:d,additionalControls:(0,c.BX)(c.HY,{children:[(0,c.tZ)(mn,{onSortKeyChanged:I,orderByAsc:x,orderByKey:Z,sortOptions:T}),!w&&(0,c.tZ)(pr,{columnSelectorVisible:n.columnSelectorVisible,onChangeColumnSelectorVisible:L,runsData:t}),!w&&(0,ce.GW)()&&N&&(0,c.tZ)(m.COr,{onClick:D,children:(0,c.tZ)(C.Z,{id:"mRc7MY",defaultMessage:"Expand rows"})})]})}),(0,c.tZ)("div",{children:(0,c.tZ)(br,{compareRunsMode:b,setCompareRunsMode:e=>i({compareRunsMode:e}),viewState:n})})]})})),xr=r.lazy((()=>Promise.all([n.e(225),n.e(412)]).then(n.bind(n,39412)))),Zr=e=>(0,c.tZ)(r.Suspense,{fallback:(0,c.tZ)("div",{css:e=>({display:"flex",justifyContent:"center",margin:e.spacing.md}),children:(0,c.tZ)(y.S,{})}),children:(0,c.tZ)(xr,{...e})}),wr=e=>{let{isFiltered:t,onClearFilters:n}=e;return(0,c.tZ)("div",{css:Sr.noResultsWrapper,children:(0,c.tZ)("div",{css:Sr.noResults,children:t?(0,c.tZ)(m.HYy,{button:(0,c.tZ)(y.B,{type:"primary",onClick:n,children:(0,c.tZ)(C.Z,{id:"pEpexK",defaultMessage:"Clear filters"})}),description:(0,c.tZ)(C.Z,{id:"Nnsm0p",defaultMessage:"All runs in this experiment have been filtered. Change or clear filters to view runs."}),title:(0,c.tZ)(C.Z,{id:"Tl63jz",defaultMessage:"All runs are filtered"}),image:(0,c.tZ)(m.k1n,{})}):(0,c.tZ)(m.HYy,{description:(0,c.tZ)(C.Z,{id:"coo35p",defaultMessage:"No runs have been logged yet. <link>Learn more</link> about how to create ML model training runs in this experiment.",values:{link:e=>(0,c.tZ)("a",{target:"_blank",href:h.gM,rel:"noreferrer",children:e})}}),title:(0,c.tZ)(C.Z,{id:"sByLVU",defaultMessage:"No runs logged"}),image:(0,c.tZ)(m.uOV,{})})})})},Sr={noResults:{maxWidth:360},noResultsWrapper:e=>({marginTop:e.spacing.lg,inset:0,backgroundColor:e.colors.backgroundPrimary,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"})},kr=e=>{let{updateViewState:t,runListHidden:n}=e;const{theme:r}=(0,y.u)();return(0,c.BX)("div",{css:(0,f.iv)({position:"absolute",top:0,bottom:0,width:2*r.spacing.md,right:-r.spacing.md,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent","&:hover":{opacity:1,".bar":{opacity:1},".button":{border:`2px solid ${r.colors.primary}`}},opacity:n?1:0,transition:"opacity 0.2s"},""),children:[(0,c.tZ)("div",{className:"bar",css:(0,f.iv)({transition:"opacity 0.2s",opacity:0,position:"absolute",left:r.spacing.md-2,top:0,backgroundColor:r.colors.primary,bottom:0,width:3,pointerEvents:"none"},"")}),(0,c.tZ)("div",{className:"button",css:(0,f.iv)({transition:"border-color 0.2s",position:"relative",width:r.general.iconSize,height:r.general.iconSize,backgroundColor:r.colors.backgroundPrimary,borderRadius:r.general.iconSize,overflow:"hidden",border:`1px solid ${r.colors.border}`,display:"flex",alignItems:"center",justifyContent:"center"},""),children:(0,c.tZ)(y.B,{onClick:()=>t({runListHidden:!n}),icon:n?(0,c.tZ)(y.b,{}):(0,c.tZ)(y.p,{}),size:"small"})})]})},Rr="is-out-of-viewport",Mr="is-hidden",Er="is-minimized",Tr=".ag-root",Br=".ag-pinned-left-cols-container",Ar=".ag-center-cols-container",Ir=".ag-header",Lr=".ag-body-viewport",Dr=e=>{let{onClick:t,gridContainerElement:n,isInitialized:a,visible:i,moreRunsAvailable:l,moreAvailableRunsTableColumnCount:s=0}=e;const o=(0,r.useRef)(null),d=(0,r.useRef)(),u=(0,r.useRef)(Boolean(l));(0,r.useEffect)((()=>{u.current=Boolean(l)}),[l]);const p=(0,r.useCallback)((e=>{if(!o.current||!window.ResizeObserver||!e)return;const t=o.current,n=e.querySelector(Tr),r=e.querySelector(Br),a=e.querySelector(Ar),i=e.querySelector(Ir),l=e.querySelector(Lr);let s=0,c=0,p=0,m=0,h=0,g=0;if(r&&a&&i&&n&&l){const e=new ResizeObserver((e=>{var o,f,v,y;for(const t of e)t.target===n&&(s=t.contentRect.width),t.target===r&&(c=t.contentRect.width,p=t.contentRect.height),t.target===l&&(h=t.contentRect.height),t.target===i&&(g=t.contentRect.height),t.target===a&&(m=t.contentRect.width);const b=c+m,C=g;b+180>=s?null===(o=d.current)||void 0===o||o.classList.add(Rr):null===(f=d.current)||void 0===f||f.classList.remove(Rr);const x=u.current?32:0,Z=p<h?p-x:h;Z<100?null===(v=d.current)||void 0===v||v.classList.add(Er):null===(y=d.current)||void 0===y||y.classList.remove(Er),t.style.transform=`translate3d(${b}px, ${C}px, 0)`,t.style.height=`${Z+1}px`}));return e.observe(r),e.observe(a),e.observe(i),e.observe(n),e.observe(l),()=>e.disconnect()}}),[]);return(0,r.useEffect)((()=>{a&&n&&(d.current=n,p(n))}),[p,a,n]),window.ResizeObserver?(0,c.tZ)("div",{ref:o,css:Nr.columnContainer,className:i?"":Mr,children:i&&(0,c.tZ)("div",{css:Nr.buttonContainer,children:(0,c.BX)(y.B,{css:Nr.button,type:"link",onClick:t,children:[(0,c.tZ)(m.wl8,{css:Nr.buttonIcon}),(0,c.tZ)("div",{css:Nr.caption,children:(0,c.tZ)(C.Z,{id:"npHb2a",defaultMessage:"Show more columns {count, select, 0 {} other {({count} total)}}",values:{count:s}})})]})})}):null},Nr={columnContainer:e=>({width:180,height:0,position:"absolute",border:`1px solid ${e.colors.borderDecorative}`,borderTop:0,top:0,left:0,willChange:"transform",transform:"translate3d(0, 0, 0)",[`.${Er} &`]:{display:"flex",alignItems:"center"},[`&.${Mr}, .${Rr} &`]:{display:"none"},pointerEvents:"none",display:"flex",alignItems:"center"}),buttonContainer:e=>({top:0,paddingLeft:e.spacing.lg,paddingRight:e.spacing.lg,width:"100%",[`.${Er} &`]:{paddingTop:e.spacing.xs},pointerEvents:"all"}),button:{whiteSpace:"pre-wrap",width:"100%"},buttonIcon:e=>({color:e.colors.textSecondary}),caption:e=>({color:e.colors.textSecondary,[`.${Er} &`]:{display:"none"}})},Or=e=>(0,c.tZ)("strong",{children:e}),Pr=e=>{let{isLoading:t,allRunsCount:n}=e;return(0,c.BX)("div",{css:Hr.statusBar,children:[(0,c.tZ)(y.T.Text,{size:"sm",color:t?"secondary":void 0,children:(0,c.tZ)(C.Z,{id:"gLj8lU",defaultMessage:"<strong>{length}</strong> matching {length, plural, =0 {runs} =1 {run} other {runs}}",values:{strong:Or,length:n}})}),t&&(0,c.tZ)(y.S,{size:"small"})]})},Hr={statusBar:e=>({height:28,display:"flex",gap:8,marginTop:-1,position:"relative",alignItems:"center",borderTop:`1px solid ${e.colors.border}`})};var Xr={name:"4fhn5u",styles:"white-space:pre-wrap;overflow-y:auto;flex:1"};const zr=e=>{let{content:t,copyText:n,headerText:r,empty:a,onClose:i}=e;const{theme:l}=(0,y.u)();return(0,c.tZ)("div",{css:(0,f.iv)({width:300,padding:l.spacing.sm,paddingRight:0,borderLeft:`1px solid ${l.colors.borderDecorative}`,overflow:"hidden",display:"flex",flexDirection:"column",height:"100%"},""),"data-testid":"preview-sidebar-content",children:t?(0,c.BX)(c.HY,{children:[(0,c.BX)("div",{css:(0,f.iv)({display:"grid",gridTemplateColumns:"1fr auto auto",rowGap:l.spacing.sm,alignItems:"flex-start",flex:"0 0 auto"},""),children:[r&&(0,c.tZ)(y.T.Title,{level:4,css:(0,f.iv)({overflowX:"hidden",overflowY:"auto",marginTop:l.spacing.sm,marginRight:l.spacing.xs,maxHeight:200},""),children:r}),n&&(0,c.tZ)(N,{copyText:n,showLabel:!1,icon:(0,c.tZ)(m.TIy,{})}),i&&(0,c.tZ)(y.B,{type:"primary",icon:(0,c.tZ)(y.C,{}),onClick:i})]}),(0,c.tZ)("div",{css:Xr,children:t})]}):(0,c.tZ)("div",{css:(0,f.iv)({marginTop:l.spacing.md},""),children:a})})},Ur=r.memo((e=>{let{experiments:t,searchFacetsState:n,runsData:a,isLoading:i,moreRunsAvailable:o,updateSearchFacets:d,updateViewState:u,onAddColumnClicked:p,rowsData:h,loadMoreRunsFunc:g,onDatasetSelected:f,expandRows:v,viewState:y}=e;const{compareRunsMode:b,orderByKey:x,selectedColumns:Z}=n,w=void 0!==b,{paramKeyList:S,metricKeyList:k,tagsList:R}=a,[M,E]=(0,r.useState)(),[T,B]=(0,r.useState)(),A=(0,r.useRef)([]),I=(0,r.useMemo)((()=>l.default.getVisibleTagKeyList(R)),[R]),L=(0,r.useRef)(null),D=(0,r.useMemo)((()=>h.some((e=>{var t;return null===(t=e.runDateAndNestInfo)||void 0===t?void 0:t.hasExpander}))),[h]),N=(0,r.useCallback)((e=>{let{api:t}=e;const n=t.getSelectedRows().filter((e=>!e.isLoadMoreRow)).map((e=>{let{runInfo:t}=e;return t.run_uuid}));u({runsSelected:n.reduce(((e,t)=>({...e,[t]:!0})),{})}),A.current=n}),[u]),O=(0,r.useCallback)((e=>{const t=e.api.getSelectedRows().filter((e=>!e.isLoadMoreRow));if(A.current&&t.length!==A.current.length){const t=Boolean(e.node.isSelected()),{runDateAndNestInfo:n}=e.data;if(!n)return;const{isParent:r,expanderOpen:a,childrenIds:i}=n;if(r&&a&&i){const n=i;e.api.forEachNode((e=>{var r;if(null!==(r=e.data)&&void 0!==r&&r.isLoadMoreRow)return;const{runInfo:a,runDateAndNestInfo:i}=e.data,l=a.run_uuid;n.includes(l)&&(null!==i&&void 0!==i&&i.childrenIds&&n.push(...i.childrenIds),e.setSelected(t,!1,!0))}))}}}),[]),P=((0,r.useCallback)(((e,t)=>{d({orderByKey:e,orderByAsc:t})}),[d]),(0,r.useCallback)((e=>d((t=>{let{runsExpanded:n,...r}=t;return{...r,runsExpanded:{...n,[e]:!n[e]}}}))),[d])),H=(0,r.useCallback)((e=>{d((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]}))),requestAnimationFrame((()=>{if(!M)return;const t=M.getRowNode(e);t&&M.redrawRows({rowNodes:[t]})}))}),[M,d]),X=(0,r.useCallback)((e=>{d((t=>{if(e===q.yz.SHOWALL)return{...t,runsHidden:[]};if(e===q.yz.HIDEALL)return{...t,runsHidden:a.runInfos.map((e=>{let{run_uuid:t}=e;return t}))};const n=e;return{...t,runsHidden:t.runsHidden.includes(n)?t.runsHidden.filter((e=>e!==n)):[...t.runsHidden,n]}}))}),[d,a]),z=(0,r.useCallback)((e=>{E(e.api),B(e.columnApi)}),[]),U=a.runInfos.every((e=>{let{run_uuid:t}=e;return n.runsHidden.includes(t)})),_=nr({selectedColumns:Z,onExpand:P,compareExperiments:t.length>1,onTogglePin:H,onToggleVisibility:X,metricKeyList:k,paramKeyList:S,tagKeyList:I,columnApi:T,isComparingRuns:w,onDatasetSelected:f,expandRows:v,allRunsHidden:U});(0,r.useEffect)((()=>{if(M)if(i)M.showLoadingOverlay();else{if(M.hideOverlay(),h.length&&o)return void M.setRowData([...h,{runUuid:(0,s.uniqueId)("load_more"),isLoadMoreRow:!0}]);M.setRowData(h)}}),[M,h,i,o,g]);const V=(0,r.useMemo)((()=>tr(t.length>1).length+(k.length+S.length+I.length)),[t.length,I.length,k.length,S.length]),F=n.selectedColumns.length>=V,W=Math.max(0,V-n.selectedColumns.length),K=(0,r.useMemo)((()=>a.runInfos.filter((e=>n.runsPinned.includes(e.run_uuid)||a.runUuidsMatchingFilter.includes(e.run_uuid))).length),[a,n.runsPinned]);(0,r.useLayoutEffect)((()=>{M&&(w&&(M.deselectAll(),M.sizeColumnsToFit()),M.resetRowHeights())}),[M,w]);const j=(0,r.useCallback)((e=>{if(w||!v)return q.G9;const t=(0,q.Q0)(Y.D5.ATTRIBUTES,Y.z.DATASET);return((e,t)=>{if((0,ce.GW)()&&e){var n;const{data:e}=t,r=Math.min((null===(n=e.datasets)||void 0===n?void 0:n.length)||1,3);return q.G9*r}return q.G9})(Z.includes(t),e)}),[Z,w,v]);(0,r.useEffect)((()=>{(0,ce.GW)()&&(null===M||void 0===M||M.resetRowHeights())}),[M,n.selectedColumns,v]);const[$,Q]=(0,r.useState)(null),G=(0,r.useCallback)((e=>{var t;let{column:n,data:r,value:a}=e;const i=null===(t=n.getParent())||void 0===t?void 0:t.getGroupId();(i===Y.D5.METRICS||i===Y.D5.PARAMS)&&(Q({value:a,header:`Run name: ${r.runName}, Column name: ${n.getColId()}`}),u({previewPaneVisible:!0}))}),[u]),J=!F&&!w&&h.length>0,ee=!w&&y.previewPaneVisible,te=!y.runListHidden||!w,ne=!y.runListHidden,re=w,ae=h.length<1&&!i;return(0,c.BX)("div",{css:e=>({display:"grid",gridTemplateColumns:ee?"1fr auto":"1fr",borderTop:`1px solid ${e.colors.border}`}),children:[(0,c.BX)("div",{css:_r.tableAreaWrapper,children:[(0,c.BX)("div",{ref:L,className:Ve()("ag-theme-balham ag-grid-sticky",{"ag-grid-expanders-visible":D}),css:[_r.agGridOverrides,{display:te?"block":"hidden",height:"100%"},""],"aria-hidden":!te,children:[(0,c.tZ)(Zr,{context:{orderByKey:x},defaultColDef:rr,columnDefs:_,rowSelection:"multiple",onGridReady:z,onSelectionChanged:N,getRowHeight:j,headerHeight:q.G9,onRowSelected:O,suppressRowClickSelection:!0,suppressColumnMoveAnimation:!0,suppressScrollOnNewData:!0,isFullWidthRow:er,fullWidthCellRenderer:"LoadMoreRowRenderer",fullWidthCellRendererParams:{loadMoreRunsFunc:g},suppressFieldDotNotation:!0,enableCellTextSelection:!0,components:{agColumnHeader:hn,loadingOverlayComponent:Qn,LoadMoreRowRenderer:Hn,SourceCellRenderer:En,ModelsCellRenderer:Rn,VersionCellRenderer:Tn,DateCellRenderer:yn,ExperimentNameCellRenderer:Cn,RowActionsCellRenderer:An,RowActionsHeaderCellRenderer:Ln,RunNameCellRenderer:Nn,DatasetsCellRenderer:Wn},suppressNoRowsOverlay:!0,loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:{showImmediately:!0},getRowId:Jn,rowBuffer:101,onCellClicked:G}),J&&(0,c.tZ)(Dr,{gridContainerElement:L.current,isInitialized:Boolean(M),onClick:p,visible:!i,moreRunsAvailable:o,moreAvailableRunsTableColumnCount:W})]}),ae&&(0,c.tZ)(wr,{onClearFilters:()=>d(ue),isFiltered:pe(n)}),ne&&(0,c.tZ)(Pr,{allRunsCount:K,isLoading:i}),re&&(0,c.tZ)(kr,{runListHidden:y.runListHidden,updateViewState:u})]}),ee&&(0,c.tZ)(zr,{content:null===$||void 0===$?void 0:$.value,copyText:null===$||void 0===$?void 0:$.value,headerText:null===$||void 0===$?void 0:$.header,onClose:()=>u({previewPaneVisible:!1}),empty:(0,c.tZ)(m.HYy,{description:(0,c.tZ)(C.Z,{id:"cAKSkQ",defaultMessage:"Select a cell to display preview"})})})]})})),_r={tableAreaWrapper:{display:"flex",flexDirection:"column",position:"relative"},agGridOverrides:e=>{const t=(e=>({rowForeground:e.colors.textPrimary,rowBackground:e.colors.backgroundPrimary,rowBackgroundHover:`${e.colors.backgroundSecondary}0A`,rowBackgroundSelected:`${e.colors.backgroundSecondary}14`,rowBackgroundHoverSelected:`${e.colors.backgroundSecondary}1F`,columnSortedBy:`${e.colors.blue400}1F`,headerBackground:e.colors.backgroundSecondary,headerTextColor:e.colors.textSecondary,headerGroupTextColor:e.colors.textSecondary,borderColor:e.colors.borderDecorative,headerBorderColor:"transparent",checkboxBorderColor:e.colors.actionDefaultBorderDefault,checkboxBorderColorChecked:e.colors.backgroundPrimary,checkboxBackgroundColorChecked:e.colors.actionPrimaryBackgroundDefault,overlayBackground:`${e.colors.backgroundSecondary}99`}))(e);return{height:"100%",position:"relative","&.ag-theme-balham":{"--ag-border-color":t.borderColor,"--ag-row-border-color":t.borderColor,"--ag-foreground-color":t.rowForeground,"--ag-background-color":t.rowBackground,"--ag-odd-row-background-color":t.rowBackground,"--ag-row-hover-color":t.rowBackgroundHover,"--ag-selected-row-background-color":t.rowBackgroundSelected,"--ag-header-foreground-color":t.headerTextColor,"--ag-header-background-color":t.headerBackground,"--ag-modal-overlay-background-color":t.overlayBackground,"&.ag-grid-sticky .ag-header":{position:"sticky",top:0,zIndex:1},"&.ag-grid-sticky .ag-root":{overflow:"visible"},"&.ag-grid-sticky .ag-root-wrapper":{border:"0",borderRadius:"4px",overflow:"visible"},".ag-header::after":{content:'""',position:"absolute",top:q.G9,left:0,right:0,height:1,backgroundColor:t.borderColor},".ag-cell":{display:"flex",overflow:"hidden","& > .ag-cell-wrapper":{overflow:"hidden"}},".ag-header-cell":{padding:0},".ag-header-cell .ag-checkbox":{padding:"0 7px",borderLeft:"1px solid transparent"},".ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by":{backgroundColor:t.columnSortedBy},".ag-header-row":{"--ag-border-color":t.headerBorderColor},".ag-header-row.ag-header-row-column-group":{"--ag-header-foreground-color":t.headerGroupTextColor},".ag-row.ag-row-selected.ag-row-hover":{backgroundColor:t.rowBackgroundHoverSelected},".ag-header:not(:hover) .ag-header-cell::after, .ag-header:not(:hover) .ag-header-group-cell::after":{opacity:0},".ag-pinned-left-header":{borderRight:"none"},".ag-overlay-loading-wrapper":{paddingTop:4*e.spacing.md,alignItems:"center",zIndex:2},".ag-overlay-loading-wrapper .ag-react-container":{flex:1},".ag-center-cols-container":{minHeight:0},".ag-full-width-row":{borderBottom:0,backgroundColor:"transparent",zIndex:1,"&.ag-row-hover":{backgroundColor:"transparent"}},".is-checkbox-cell":{display:"flex",alignItems:"center",paddingLeft:7,".is-multiline-cell .ag-cell-value":{height:"100%"}},".is-previewable-cell":{cursor:"pointer"},".ag-header-cell .ag-checkbox .ag-input-wrapper:not(.ag-indeterminate):not(.ag-checked)":{"--ag-checkbox-background-color":t.headerBackground},".ag-cell-wrapper .ag-selection-checkbox":{marginRight:20},".is-checkbox-cell, .ag-header-cell .ag-checkbox":{".ag-checkbox-input-wrapper::after":{color:t.checkboxBorderColor},".ag-checkbox-input-wrapper.ag-checked":{"--ag-checkbox-background-color":t.checkboxBackgroundColorChecked,"--ag-checkbox-checked-color":t.checkboxBorderColorChecked,"&::after":{color:t.checkboxBorderColorChecked}}}}}}};var Vr=n(79108);class Fr{constructor(){this.runsSelected={},this.hiddenChildRunsSelected={},this.columnSelectorVisible=!1,this.previewPaneVisible=!1,this.viewMaximized=!1,this.runListHidden=!1,this.artifactViewState={selectedTables:[],groupByCols:[],outputColumn:"",intersectingOnly:!1}}}var Wr=n(89173),Kr=n(78438);let jr=function(e){return e.BAR="BAR",e.LINE="LINE",e.SCATTER="SCATTER",e.CONTOUR="CONTOUR",e.PARALLEL="PARALLEL",e}({});class $r{constructor(e){this.uuid=void 0,this.type=jr.BAR,this.runsCountToCompare=10,this.uuid=e}static serialize(e){return Object.keys(e).reduce(((t,n)=>({...t,[n]:e[n]})),{})}static getEmptyChartCardByType(e,t){return e===jr.BAR?new Qr(t):e===jr.SCATTER?new Yr(t):e===jr.PARALLEL?new Jr(t):e===jr.LINE?new qr(t):new Gr(t)}static getBaseChartConfigs(e,t){const n=[],r=new Set;e&&r.add(e);for(const a of Object.keys(t))r.add(a);return[...r].slice(0,30).forEach((e=>{var r,a;let i=jr.BAR;void 0!==(null===(r=t[e])||void 0===r?void 0:r.step)&&(null===(a=t[e])||void 0===a?void 0:a.step)>=2&&(i=jr.LINE),n.push({...$r.getEmptyChartCardByType(i,(0,Kr.Fs)()),metricKey:e})})),0===n.length&&n.push($r.getEmptyChartCardByType(jr.PARALLEL,(0,Kr.Fs)())),n}}class Yr extends $r{constructor(){super(...arguments),this.type=jr.SCATTER,this.xaxis={key:"",type:"METRIC"},this.yaxis={key:"",type:"METRIC"},this.runsCountToCompare=100}}class qr extends $r{constructor(){super(...arguments),this.type=jr.LINE,this.metricKey="",this.lineSmoothness=0,this.scaleType="linear",this.xAxisKey="step"}}class Qr extends $r{constructor(){super(...arguments),this.type=jr.BAR,this.metricKey=""}}class Gr extends $r{constructor(){super(...arguments),this.type=jr.CONTOUR,this.xaxis={key:"",type:"METRIC"},this.yaxis={key:"",type:"METRIC"},this.zaxis={key:"",type:"METRIC"}}}class Jr extends $r{constructor(){super(...arguments),this.type=jr.PARALLEL,this.selectedParams=[],this.selectedMetrics=[]}}var ea,ta,na,ra,aa;function ia(){return ia=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ia.apply(this,arguments)}function la(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",ia({width:18,height:16,viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,ea||(ea=r.createElement("path",{d:"M1 0.813599V15.1865H17",stroke:"#A3AEB8",strokeLinecap:"round"})),ta||(ta=r.createElement("rect",{x:3.16943,y:10.5763,width:2.16949,height:3.25424,fill:"#338ECC"})),na||(na=r.createElement("rect",{x:6.42371,y:5.15259,width:2.16949,height:8.67797,fill:"#338ECC"})),ra||(ra=r.createElement("rect",{x:9.67798,y:8.40686,width:2.16949,height:5.42373,fill:"#338ECC"})),aa||(aa=r.createElement("rect",{x:12.9323,y:1.89832,width:2.16949,height:11.9322,fill:"#338ECC"})))}const sa=r.forwardRef(la);var oa,da,ca;n.p;function ua(){return ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ua.apply(this,arguments)}function pa(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",ua({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,oa||(oa=r.createElement("path",{d:"M1 1V17H17",stroke:"#A3AEB8",strokeLinecap:"round"})),da||(da=r.createElement("path",{d:"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148",stroke:"#338ECC",strokeLinecap:"round"})),ca||(ca=r.createElement("path",{d:"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909",stroke:"#338ECC",strokeLinecap:"round"})))}const ma=r.forwardRef(pa);var ha,ga;n.p;function fa(){return fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fa.apply(this,arguments)}function va(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",fa({width:22,height:22,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,ha||(ha=r.createElement("path",{d:"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772",stroke:"#338ECC",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),ga||(ga=r.createElement("path",{d:"M1 1V21H21",stroke:"#A3AEB8",strokeLinecap:"round"})))}const ya=r.forwardRef(va);var ba,Ca,xa,Za,wa;n.p;function Sa(){return Sa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sa.apply(this,arguments)}function ka(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",Sa({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,ba||(ba=r.createElement("path",{d:"M1 1V17H17",stroke:"#A3AEB8",strokeLinecap:"round"})),Ca||(Ca=r.createElement("path",{d:"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463",stroke:"#CCE3F2",strokeLinecap:"round"})),xa||(xa=r.createElement("path",{d:"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155",stroke:"#CCE3F2",strokeLinecap:"round"})),Za||(Za=r.createElement("path",{d:"M3.79248 2.74207V13.8225",stroke:"#338ECC",strokeLinecap:"round"})),wa||(wa=r.createElement("path",{d:"M14.873 3.04419V13.7217",stroke:"#338ECC",strokeLinecap:"round"})))}const Ra=r.forwardRef(ka);var Ma,Ea,Ta,Ba,Aa,Ia,La;n.p;function Da(){return Da=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Da.apply(this,arguments)}function Na(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",Da({width:18,height:16,viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,Ma||(Ma=r.createElement("path",{d:"M1 0.813599V15.1865H17",stroke:"#A3AEB8",strokeLinecap:"round"})),Ea||(Ea=r.createElement("circle",{cx:3.98301,cy:12.4746,r:1.35593,fill:"#338ECC"})),Ta||(Ta=r.createElement("ellipse",{cx:9.40684,cy:10.8475,rx:1.35593,ry:1.35593,fill:"#338ECC"})),Ba||(Ba=r.createElement("circle",{cx:5.6102,cy:8.1356,r:1.35593,fill:"#338ECC",fillOpacity:.25})),Aa||(Aa=r.createElement("circle",{cx:9.40684,cy:6.50852,r:1.35593,fill:"#338ECC"})),Ia||(Ia=r.createElement("ellipse",{cx:13.7457,cy:5.96616,rx:1.35593,ry:1.35593,fill:"#338ECC",fillOpacity:.25})),La||(La=r.createElement("ellipse",{cx:16.4576,cy:2.46128,rx:1.35593,ry:1.35593,fill:"#338ECC"})))}const Oa=r.forwardRef(Na);n.p;const Pa=e=>{let{onAddChart:t}=e;return(0,c.BX)(y.O.Root,{modal:!1,children:[(0,c.tZ)(y.O.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{css:Ha.addChartButton,icon:(0,c.tZ)(m.pOD,{}),"data-testid":"experiment-view-compare-runs-add-chart",children:"Add chart"})}),(0,c.BX)(y.O.Content,{align:"end",children:[(0,c.BX)(y.O.Item,{onClick:()=>t(jr.BAR),"data-testid":"experiment-view-compare-runs-chart-type-bar",children:[(0,c.tZ)(y.O.IconWrapper,{css:Ha.iconWrapper,children:(0,c.tZ)(sa,{})}),"Bar chart"]}),(0,c.BX)(y.O.Item,{onClick:()=>t(jr.LINE),"data-testid":"experiment-view-compare-runs-chart-type-line",children:[(0,c.tZ)(y.O.IconWrapper,{css:Ha.iconWrapper,children:(0,c.tZ)(ya,{})}),"Line chart"]}),(0,c.BX)(y.O.Item,{onClick:()=>t(jr.PARALLEL),"data-testid":"experiment-view-compare-runs-chart-type-parallel",children:[(0,c.tZ)(y.O.IconWrapper,{css:Ha.iconWrapper,children:(0,c.tZ)(Ra,{})}),"Parallel coordinates"]}),(0,c.BX)(y.O.Item,{onClick:()=>t(jr.SCATTER),"data-testid":"experiment-view-compare-runs-chart-type-scatter",children:[(0,c.tZ)(y.O.IconWrapper,{css:Ha.iconWrapper,children:(0,c.tZ)(Oa,{})}),"Scatter chart"]}),(0,c.BX)(y.O.Item,{onClick:()=>t(jr.CONTOUR),"data-testid":"experiment-view-compare-runs-chart-type-contour",children:[(0,c.tZ)(y.O.IconWrapper,{css:Ha.iconWrapper,children:(0,c.tZ)(ma,{})}),"Contour chart"]})]})]})},Ha={addChartButton:e=>({backgroundColor:`${e.colors.backgroundPrimary} !important`}),iconWrapper:e=>({width:e.general.iconSize+e.spacing.xs})};var Xa=n(17217),za=n(61026);var Ua={name:"d3v9zr",styles:"overflow:hidden"},_a={name:"72wqca",styles:"margin-bottom:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis"};const Va=e=>{let{title:t,subtitle:n,onDelete:r,onEdit:a,children:i,fullWidth:l=!1,tooltip:s=""}=e;return(0,c.BX)("div",{css:Fa.chartEntry(l),"data-testid":"experiment-view-compare-runs-card",children:[(0,c.BX)("div",{css:Fa.chartEntryTitle,children:[(0,c.BX)("div",{css:Ua,children:[(0,c.tZ)(y.T.Title,{title:String(t),level:4,css:_a,children:t}),n&&(0,c.tZ)("span",{css:Fa.subtitle,children:n}),s&&(0,c.tZ)(m.bEE,{title:s})]}),(0,c.BX)(y.O.Root,{modal:!1,children:[(0,c.tZ)(y.O.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{type:"tertiary",icon:(0,c.tZ)(m.VZO,{}),"data-testid":"experiment-view-compare-runs-card-menu"})}),(0,c.BX)(y.O.Content,{align:"end",minWidth:100,children:[(0,c.tZ)(y.O.Item,{onClick:a,"data-testid":"experiment-view-compare-runs-card-edit",children:"Configure"}),(0,c.tZ)(y.O.Item,{onClick:r,"data-testid":"experiment-view-compare-runs-card-delete",children:"Delete"})]})]})]}),i]})},Fa={chartEntry:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>({height:360,maxWidth:e?"unset":800,overflow:"hidden",display:"grid",gridTemplateRows:"auto 1fr",backgroundColor:t.colors.backgroundPrimary,padding:t.spacing.md,border:`1px solid ${t.colors.border}`,borderRadius:t.general.borderRadiusBase})},chartComponentWrapper:()=>({overflow:"hidden"}),chartEntryTitle:()=>({display:"grid",gridTemplateColumns:"1fr auto",alignItems:"flex-start"}),subtitle:e=>({color:e.colors.textSecondary,fontSize:11,marginRight:4})},Wa={t:24,b:48,r:0,l:4,pad:0},Ka=e=>{let{config:t,chartRunData:n,onDelete:a,onEdit:i}=e;const l=(0,r.useMemo)((()=>n.slice(0,t.runsCountToCompare||10).reverse()),[n,t]),{setTooltip:s,resetTooltip:o,selectedRunUuid:d}=(0,za.Hs)(t);return(0,c.tZ)(Va,{onEdit:i,onDelete:a,title:t.metricKey,subtitle:(0,c.BX)(c.HY,{children:["Comparing first ",l.length," runs"]}),children:(0,c.tZ)("div",{css:ja.barChartCardWrapper,children:(0,c.tZ)(Xa.D,{runsData:l,metricKey:t.metricKey,displayRunNames:!1,displayMetricKey:!1,useDefaultHoverBox:!1,margin:Wa,onHover:s,onUnhover:o,selectedRunUuid:d})})})},ja={barChartCardWrapper:{overflow:"hidden"}};var $a,Ya,qa,Qa;function Ga(){return Ga=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ga.apply(this,arguments)}function Ja(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",Ga({width:80,height:42,viewBox:"0 0 80 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,$a||($a=r.createElement("path",{d:"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216",stroke:"#CF797B",strokeLinecap:"round"})),Ya||(Ya=r.createElement("path",{d:"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361",stroke:"#A88E6F",strokeLinecap:"round"})),qa||(qa=r.createElement("g",{opacity:.8},r.createElement("path",{d:"M1.28418 1V40.3341",stroke:"#338ECC",strokeLinecap:"round"}),r.createElement("path",{d:"M40.6189 2.07251V39.9763",stroke:"#338ECC",strokeLinecap:"round"}),r.createElement("path",{d:"M77.7156 2.07251V39.9763",stroke:"url(#paint0_linear_2781_406689)",strokeWidth:4,strokeLinecap:"square"}))),Qa||(Qa=r.createElement("defs",null,r.createElement("linearGradient",{id:"paint0_linear_2781_406689",x1:78.2156,y1:2.07251,x2:78.2156,y2:39.9763,gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#D04F5E"}),r.createElement("stop",{offset:1,stopColor:"#4D9734"})))))}const ei=r.forwardRef(Ja);n.p;const ti=r.lazy((()=>Promise.all([n.e(807),n.e(444)]).then(n.bind(n,63308)))),ni=30;function ri(e,t,n){return function(e){if(0===e.length)return e;const t=Object.keys(e[0]);t.shift();let n=e;return t.forEach((e=>{const t=n.filter((t=>!isNaN(Number(t[e]))&&null!==t[e]));if(t.length>=n.length/2)return void(n=t);const r=new Set,a=[];for(const i of n){const t=i[e];r.size===ni&&r.has(String(t))?a.push(i):r.size<ni&&isNaN(Number(t))&&(r.add(String(t)),a.push(i))}n=a})),n}(e.map((e=>{const r={uuid:e.runInfo.run_uuid};function a(e,t){if(Array.isArray(e))for(const n of e)r[n]=n in t?t[n].value:null}return a(t,e.params),a(n,e.metrics),r})))}var ai=e=>(0,c.tZ)(r.Suspense,{fallback:(0,c.tZ)(m.Qck,{}),children:(0,c.tZ)(ti,{...e})});var ii={name:"1neqb0a",styles:"display:flex;flex:1;justify-content:center;align-items:center"},li={name:"10zh1lj",styles:"display:flex;flex-direction:column;align-items:center;max-width:360px"},si={name:"yz1nei",styles:"margin-top:16px"},oi={name:"18uqayh",styles:"margin-bottom:16px"};const di=e=>{let{onEdit:t}=e;return(0,c.tZ)("div",{css:ii,children:(0,c.BX)("div",{css:li,children:[(0,c.tZ)(ei,{}),(0,c.tZ)(y.T.Title,{css:si,color:"secondary",level:3,children:"Compare parameter importance"}),(0,c.tZ)(y.T.Text,{css:oi,color:"secondary",children:"Use the parallel coordinates chart to compare how various parameters in model affect your model metrics."}),(0,c.tZ)(y.B,{type:"primary",onClick:t,children:"Configure chart"})]})})},ci=e=>{let{config:t,chartRunData:n,onDelete:a,onEdit:i}=e;const[l,s]=(0,r.useMemo)((()=>{var e,r;const a=((null===(e=t.selectedParams)||void 0===e?void 0:e.length)||0)+((null===(r=t.selectedMetrics)||void 0===r?void 0:r.length)||0)>=2;return[a,a?ri(n,t.selectedParams,t.selectedMetrics):[]]}),[t,n]),{setTooltip:o,resetTooltip:d,selectedRunUuid:u,closeContextMenu:p}=(0,za.Hs)(t);return(0,c.tZ)(Va,{onEdit:i,onDelete:a,title:"Parallel Coordinates",subtitle:l?(0,c.BX)(c.HY,{children:["Comparing ",s.length," runs"]}):null,fullWidth:!0,tooltip:"The Parallel Coordinates Chart now only shows runs with columns that are either numbers or strings. If a column has string entries, the runs corresponding to the 30 most recent unique values will be shown.",children:l?s.length?(0,c.tZ)("div",{css:ui.parallelChartCardWrapper,children:(0,c.tZ)(ai,{data:s,selectedParams:t.selectedParams,selectedMetrics:t.selectedMetrics,onHover:o,onUnhover:d,axesRotateThreshold:8,selectedRunUuid:u,closeContextMenu:p})}):null:(0,c.tZ)(di,{onEdit:i})})},ui={parallelChartCardWrapper:{display:"flex",overflow:"hidden",cursor:"pointer"}};var pi=n(79424),mi=n(11024),hi=n(26535),gi=n(88098);const fi={displaylogo:!1,scrollZoom:!1},vi=r.memo((e=>{let{runsData:t,xAxis:n,yAxis:a,markerSize:i=10,className:l,margin:s=gi.BW,onUpdate:o,onHover:d,onUnhover:u,width:p,height:m,useDefaultHoverBox:h=!0,selectedRunUuid:g}=e;const{theme:f}=(0,y.u)(),{layoutHeight:v,layoutWidth:b,setContainerDiv:C,containerDiv:x,isDynamicSizeSupported:Z}=(0,gi.Ih)(),w=(0,r.useMemo)((()=>{const e=[],r=[],l=[],s=[];for(const i of t){var o,d;const{runInfo:{run_uuid:t,run_name:c},metrics:u,params:p,color:m}=i,h="METRIC"===n.type?u:p,g="METRIC"===a.type?u:p,v=(null===h||void 0===h||null===(o=h[n.key])||void 0===o?void 0:o.value)||void 0,y=(null===g||void 0===g||null===(d=g[a.key])||void 0===d?void 0:d.value)||void 0;v&&y&&(e.push(v),r.push(y),l.push(m||f.colors.primary),s.push([t,c||t]))}return[{x:e,y:r,customdata:s,hovertemplate:h?"<b>%{customdata[1]}:</b><br><b>%{xaxis.title.text}:</b> %{x:.2f}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><extra></extra>":void 0,hoverinfo:h?void 0:"none",hoverlabel:h?gi.i:void 0,type:"scatter",mode:"markers",marker:{size:i,color:l}}]}),[t,n,a,f,i,h]),S=(0,r.useMemo)((()=>(0,gi.uY)(f)),[f]),[k,R]=(0,r.useState)({width:p||b,height:m||v,margin:s,xaxis:{title:n.key},yaxis:{title:a.key},template:{layout:S}});(0,r.useEffect)((()=>{R((e=>{const t={...e,width:p||b,height:m||v,margin:s};return t.xaxis&&(t.xaxis.title=n.key),t.yaxis&&(t.yaxis.title=a.key),t}))}),[b,v,s,n.key,a.key,p,m]);const{setHoveredPointIndex:M}=(0,hi.n)(x,g,t,hi.Uh),E=(0,r.useCallback)((e=>{var t,n,r,a;let{points:i}=e;const l=null===(t=i[0])||void 0===t||null===(n=t.customdata)||void 0===n?void 0:n[0];M(null!==(r=null===(a=i[0])||void 0===a?void 0:a.pointIndex)&&void 0!==r?r:-1),l&&(null===d||void 0===d||d(l))}),[d,M]),T=(0,r.useCallback)((()=>{null===u||void 0===u||u(),M(-1)}),[u,M]),B=(0,mi.G)(E);return(0,c.tZ)("div",{css:[gi.QW.chartWrapper(f),gi.QW.scatterChartHighlightStyles,""],className:l,ref:C,children:(0,c.tZ)(pi.L,{data:w,useResizeHandler:!Z,css:gi.QW.chart(f),layout:k,config:fi,onUpdate:o,onHover:B,onUnhover:T})})})),yi=e=>{let{config:t,chartRunData:n,onDelete:a,onEdit:i}=e;const l=(0,r.useMemo)((()=>n.slice(0,t.runsCountToCompare||10).reverse()),[n,t]),{setTooltip:s,resetTooltip:o,selectedRunUuid:d}=(0,za.Hs)(t);return(0,c.tZ)(Va,{onEdit:i,onDelete:a,title:`${t.xaxis.key} vs. ${t.yaxis.key}`,subtitle:(0,c.BX)(c.HY,{children:["Comparing first ",l.length," runs"]}),children:(0,c.tZ)("div",{css:bi.scatterChartCardWrapper,children:(0,c.tZ)(vi,{runsData:l,xAxis:t.xaxis,yAxis:t.yaxis,onHover:s,onUnhover:o,useDefaultHoverBox:!1,selectedRunUuid:d})})})},bi={scatterChartCardWrapper:{overflow:"hidden"}},Ci={displaylogo:!1,scrollZoom:!1},xi=[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Zi=r.memo((e=>{let{runsData:t,xAxis:n,yAxis:a,zAxis:i,markerSize:l=10,className:s,reverseScale:o,margin:d=gi.Um,colorScale:u=xi,onUpdate:p,onHover:m,onUnhover:h,width:g,height:f,useDefaultHoverBox:v=!0,selectedRunUuid:b}=e;const{theme:C}=(0,y.u)(),{layoutHeight:x,layoutWidth:Z,setContainerDiv:w,containerDiv:S,isDynamicSizeSupported:k}=(0,gi.Ih)(),R=(0,r.useMemo)((()=>{const e=[],r=[],s=[],d=[],c=[];for(const l of t){var p,m,h;const{runInfo:{run_uuid:t,run_name:o},metrics:u,params:g,color:f}=l,v="METRIC"===n.type?u:g,y="METRIC"===a.type?u:g,b="METRIC"===i.type?u:g,x=(null===v||void 0===v||null===(p=v[n.key])||void 0===p?void 0:p.value)||void 0,Z=(null===y||void 0===y||null===(m=y[a.key])||void 0===m?void 0:m.value)||void 0,w=(null===b||void 0===b||null===(h=b[i.key])||void 0===h?void 0:h.value)||void 0;x&&Z&&w&&(e.push(x),r.push(Z),s.push(w),d.push(f||C.colors.primary),c.push([t,o||t,w]))}const g=[{x:e,y:r,customdata:c,hovertemplate:v?(f=i.key,`<b>%{customdata[1]}:</b><br><b>%{xaxis.title.text}:</b> %{x:.2f}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><b>${f}:</b> %{customdata[2]:.2f}<extra></extra>`):void 0,hoverinfo:v?void 0:"none",hoverlabel:v?gi.i:void 0,type:"scatter",mode:"markers",marker:{size:l,color:d,line:{color:"black",width:1}}}];var f;return t.length>1&&g.unshift({x:e,y:r,z:s,type:"contour",connectgaps:!0,hoverinfo:"none",contours:{coloring:"heatmap"},colorscale:u,reversescale:o}),g}),[u,o,l,t,n.type,n.key,a.type,a.key,i.type,i.key,C.colors.primary,v]),M=(0,r.useMemo)((()=>(0,gi.uY)(C)),[C]),[E,T]=(0,r.useState)({width:g||Z,height:f||x,margin:d,xaxis:{title:n.key},yaxis:{ticks:"inside",title:{standoff:32,text:a.key}},template:{layout:M}});(0,r.useEffect)((()=>{T((e=>{const t={...e,width:g||Z,height:f||x,margin:d};return t.xaxis&&(t.xaxis.title=n.key),t.yaxis&&(t.yaxis.title={standoff:32,text:a.key}),t}))}),[Z,x,d,n.key,a.key,g,f]);const{setHoveredPointIndex:B}=(0,hi.n)(S,b,t,hi.Uh),A=(0,r.useCallback)((e=>{var t,n;let{points:r}=e;const a=r.find((e=>{let{curveNumber:t}=e;return 1===t}));if(B(null!==(t=null===a||void 0===a?void 0:a.pointIndex)&&void 0!==t?t:-1),!a)return;const i=null===a||void 0===a||null===(n=a.customdata)||void 0===n?void 0:n[0];i&&(null===m||void 0===m||m(i))}),[m,B]),I=(0,r.useCallback)((()=>{null===h||void 0===h||h(),B(-1)}),[h,B]),L=(0,mi.G)(A);return(0,c.tZ)("div",{css:[gi.QW.chartWrapper(C),gi.QW.scatterChartHighlightStyles,""],className:s,ref:w,children:(0,c.tZ)(pi.L,{data:R,useResizeHandler:!k,css:gi.QW.chart(C),onUpdate:p,layout:E,config:Ci,onHover:L,onUnhover:I})})})),wi=e=>{let{config:t,chartRunData:n,onDelete:a,onEdit:i}=e;const l=(0,r.useMemo)((()=>n.slice(0,t.runsCountToCompare||10).reverse()),[n,t]),{setTooltip:s,resetTooltip:o,selectedRunUuid:d}=(0,za.Hs)(t);return(0,c.tZ)(Va,{onEdit:i,onDelete:a,title:`${t.xaxis.key} vs. ${t.yaxis.key} vs. ${t.zaxis.key}`,subtitle:(0,c.BX)(c.HY,{children:["Comparing first ",l.length," runs"]}),children:(0,c.tZ)("div",{css:Si.contourChartCardWrapper,children:(0,c.tZ)(Zi,{runsData:l,xAxis:t.xaxis,yAxis:t.yaxis,zAxis:t.zaxis,useDefaultHoverBox:!1,onHover:s,onUnhover:o,selectedRunUuid:d})})})},Si={contourChartCardWrapper:{overflow:"hidden"}};var ki=n(68949);const Ri=e=>{let{config:t,chartRunData:n,isMetricHistoryLoading:a,onDelete:i,onEdit:l}=e;const s=(0,r.useMemo)((()=>n.slice(0,t.runsCountToCompare||10).reverse()),[n,t]),{setTooltip:o,resetTooltip:d,selectedRunUuid:u}=(0,za.Hs)(t);return(0,c.tZ)(Va,{onEdit:l,onDelete:i,title:t.metricKey,subtitle:(0,c.BX)(c.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,c.tZ)("div",{css:Mi.lineChartCardWrapper,children:a?(0,c.tZ)(m.Qck,{}):(0,c.tZ)(ki.J,{runsData:s,metricKey:t.metricKey,scaleType:t.scaleType,xAxisKey:t.xAxisKey,lineSmoothness:t.lineSmoothness,useDefaultHoverBox:!1,onHover:o,onUnhover:d,selectedRunUuid:u})})})},Mi={lineChartCardWrapper:{overflow:"hidden"}},Ei=e=>{let{chartRunData:t,cardsConfig:n,isMetricHistoryLoading:a,onRemoveChart:i,onStartEditChart:l}=e;const[s,o]=(0,r.useMemo)((()=>Array.isArray(n)?[n.filter((e=>e.type===jr.PARALLEL)),n.filter((e=>e.type!==jr.PARALLEL))]:[[],[]]),[n]);return(0,c.BX)(c.HY,{children:[s.length?(0,c.tZ)("div",{css:Ti.parallelChartsWrapper,children:s.map((e=>(0,c.tZ)(ci,{config:e,chartRunData:t,onEdit:()=>l(e),onDelete:()=>i(e)})))}):null,(0,c.tZ)("div",{css:Ti.chartsWrapper,children:o.map((e=>e.type===jr.BAR?(0,c.tZ)(Ka,{config:e,chartRunData:t,onEdit:()=>l(e),onDelete:()=>i(e)}):e.type===jr.LINE?(0,c.tZ)(Ri,{config:e,chartRunData:t,onEdit:()=>l(e),onDelete:()=>i(e),isMetricHistoryLoading:a}):e.type===jr.SCATTER?(0,c.tZ)(yi,{config:e,chartRunData:t,onEdit:()=>l(e),onDelete:()=>i(e)}):e.type===jr.CONTOUR?(0,c.tZ)(wi,{config:e,chartRunData:t,onEdit:()=>l(e),onDelete:()=>i(e)}):null))})]})},Ti={chartGroupWrapper:e=>({display:"flex",flexDirection:"column",gap:e.spacing.md}),parallelChartsWrapper:e=>({display:"flex",flexDirection:"column",gap:e.spacing.md,marginBottom:e.spacing.md}),chartsWrapper:e=>({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(520px, 1fr))",gap:e.spacing.md})},Bi=e=>{let{title:t,children:n}=e;return(0,c.BX)("div",{css:e=>({marginBottom:2*e.spacing.md}),"data-testid":"experiment-view-compare-runs-config-field",children:[(0,c.BX)(y.T.Title,{level:4,children:[t,":"]}),n]})},Ai=e=>{let{value:t,onChange:n,metricKeyList:r,paramKeyList:i}=e;const{formatMessage:l}=(0,a.Z)(),s=!(null!==i&&void 0!==i&&i.length)&&!(null!==r&&void 0!==r&&r.length);return(0,c.BX)(m.Select,{css:Di.selectFull,value:s?l({id:"3VURvw",defaultMessage:"No metrics or parameters available"}):t,disabled:s,onChange:n,dangerouslySetAntdProps:{showSearch:!0},children:[null!==r&&void 0!==r&&r.length?(0,c.tZ)(m.Select.OptGroup,{label:l({id:"jH0+gA",defaultMessage:"Metrics"}),children:r.map((e=>(0,c.tZ)(m.Select.Option,{value:(0,q.Q0)("METRIC",e),children:e},(0,q.Q0)("METRIC",e))))}):null,null!==i&&void 0!==i&&i.length?(0,c.tZ)(m.Select.OptGroup,{label:l({id:"kWUhea",defaultMessage:"Params"}),children:i.map((e=>(0,c.tZ)(m.Select.Option,{value:(0,q.Q0)("PARAM",e),children:e},(0,q.Q0)("PARAM",e))))}):null]})},Ii=e=>{let{onChange:t,value:n,options:r}=e;const{formatMessage:i}=(0,a.Z)();return(0,c.tZ)(Bi,{title:i({id:"AW2rVK",defaultMessage:"Max. no of runs shown"}),children:(0,c.tZ)(m.Select,{css:Di.selectFull,value:n,onChange:t,children:r.map((e=>{const t="number"===typeof e?e:e.value,n="number"===typeof e?e:e.label;return(0,c.tZ)(m.Select.Option,{value:t,children:n},t)}))})})},Li=[{value:5,label:(0,c.tZ)(C.Z,{id:"Mc6Dhy",defaultMessage:"5"})},{value:10,label:(0,c.tZ)(C.Z,{id:"2K8tsp",defaultMessage:"10"})},{value:20,label:(0,c.tZ)(C.Z,{id:"zwO8+l",defaultMessage:"20"})}],Di={selectFull:{width:"100%"}},Ni=e=>{let{state:t,onStateChange:n,metricKeyList:a}=e;const i=(0,r.useCallback)((e=>{n((t=>({...t,metricKey:e})))}),[n]),l=(0,r.useCallback)((e=>{n((t=>({...t,runsCountToCompare:e})))}),[n]);(0,r.useEffect)((()=>{!t.metricKey&&null!==a&&void 0!==a&&a[0]&&i(a[0])}),[t.metricKey,i,a]);const s=0===a.length;return(0,c.BX)(c.HY,{children:[(0,c.tZ)(Bi,{title:"Metric",children:(0,c.tZ)(m.Select,{css:Oi.selectFull,value:s?"No metrics available":t.metricKey,onChange:i,disabled:s,dangerouslySetAntdProps:{showSearch:!0},children:a.map((e=>(0,c.tZ)(m.Select.Option,{value:e,"data-testid":`metric-${e}`,children:e},e)))})}),(0,c.tZ)(Ii,{value:t.runsCountToCompare,onChange:l,options:Li})]})},Oi={selectFull:{width:"100%"}},Pi=e=>{let{state:t,onStateChange:n,metricKeyList:a,paramKeyList:i}=e;const l=(0,r.useCallback)((e=>{n((t=>({...t,selectedParams:e})))}),[n]),s=(0,r.useCallback)((e=>{n((t=>({...t,selectedMetrics:e})))}),[n]),o=0===a.length,d=0===i.length;return(0,c.BX)(c.HY,{children:[(0,c.tZ)(Bi,{title:"Params",children:(0,c.tZ)(m.Select,{mode:d?void 0:"multiple",onChange:l,style:{width:300},value:d?"No parameters available":t.selectedParams,disabled:d,children:i.map((e=>(0,c.tZ)(m.Select.Option,{value:e,children:e})))})}),(0,c.tZ)(Bi,{title:"Metrics",children:(0,c.tZ)(m.Select,{mode:o?void 0:"multiple",onChange:s,style:{width:300},value:o?"No metrics available":t.selectedMetrics,disabled:o,children:a.map((e=>(0,c.tZ)(m.Select.Option,{value:e,children:e})))})})]})},Hi=e=>{let{state:t,onStateChange:n,metricKeyList:a}=e;const i=(0,r.useCallback)((e=>{n((t=>({...t,metricKey:e})))}),[n]),l=(0,r.useCallback)((e=>{n((t=>({...t,xAxisKey:e})))}),[n]),s=(0,r.useCallback)((e=>n((t=>({...t,scaleType:e?"log":"linear"})))),[n]),o=(0,r.useCallback)((e=>{n((t=>({...t,lineSmoothness:e})))}),[n]),d=(0,r.useCallback)((e=>{n((t=>({...t,runsCountToCompare:e})))}),[n]);(0,r.useEffect)((()=>{!t.metricKey&&null!==a&&void 0!==a&&a[0]&&i(a[0])}),[t.metricKey,i,a]);const u=0===a.length;return(0,c.BX)(c.HY,{children:[(0,c.tZ)(Bi,{title:"Metric (Y-axis)",children:(0,c.tZ)(m.Select,{css:Xi.selectFull,value:u?"No metrics available":t.metricKey,onChange:i,disabled:u,dangerouslySetAntdProps:{showSearch:!0},children:a.map((e=>(0,c.tZ)(m.Select.Option,{value:e,"data-testid":`metric-${e}`,children:e},e)))})}),(0,c.tZ)(Bi,{title:"X-axis",children:(0,c.BX)(m.Y8K.Group,{value:t.xAxisKey,onChange:e=>{let{target:{value:t}}=e;return l(t)},children:[(0,c.tZ)(m.Y8K,{value:"step",children:"Step"}),(0,c.BX)(m.Y8K,{value:"time",children:["Time (wall)",(0,c.BX)(y.e,{title:(0,c.tZ)(C.Z,{id:"nlXn2G",defaultMessage:"Absolute date and time"}),placement:"right",children:[" ",(0,c.tZ)(m.AMp,{css:Xi.timeStepQuestionMarkIcon})]})]}),(0,c.BX)(m.Y8K,{value:"time-relative",children:["Time (relative)",(0,c.BX)(y.e,{title:(0,c.tZ)(C.Z,{id:"NwNrl4",defaultMessage:"Amount of time that has passed since the first metric value was logged"}),placement:"right",children:[" ",(0,c.tZ)(m.AMp,{css:Xi.timeStepQuestionMarkIcon})]})]})]})}),(0,c.tZ)(Bi,{title:"Y-axis log scale",children:(0,c.tZ)(m.rsf,{checked:"log"===t.scaleType,onChange:s,label:"Enabled"})}),(0,c.tZ)(Bi,{title:"Line smoothness",children:(0,c.tZ)(Pt.O,{"data-testid":"smoothness-toggle",min:0,max:100,handleLineSmoothChange:o,defaultValue:t.lineSmoothness?t.lineSmoothness:0})}),(0,c.tZ)(Ii,{value:t.runsCountToCompare,onChange:d,options:[5,10,20]})]})},Xi={selectFull:{width:"100%"},timeStepQuestionMarkIcon:()=>({svg:{width:12,height:12}})};var zi=n(19700);const Ui=(0,S.$j)((e=>{let{entities:{metricsByRunUuid:t}}=e;return{metricsByRunUuid:t}}),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.metricsByRunUuid===t.entities.metricsByRunUuid})((e=>{let{previewData:t,cardConfig:n,metricsByRunUuid:a}=e;const i=(0,r.useMemo)((()=>[n.metricKey]),[n.metricKey]),{isLoading:l,error:s}=(0,zi.u)(i,t),o=(0,r.useMemo)((()=>t.map((e=>({...e,metricsHistory:a[e.runInfo.run_uuid]})))),[t,a]),{resetTooltip:d,setTooltip:u}=(0,za.Hs)(n);return l?(0,c.tZ)(m.Qck,{}):s?(0,c.tZ)(c.HY,{children:"Error occured!"}):(0,c.tZ)(ki.J,{runsData:o,metricKey:n.metricKey,scaleType:n.scaleType,lineSmoothness:n.lineSmoothness,xAxisKey:n.xAxisKey,useDefaultHoverBox:!1,onHover:u,onUnhover:d})}));var _i={name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"};const Vi=e=>{let{state:t,onStateChange:n,metricKeyList:i,paramKeyList:l}=e;const{formatMessage:s}=(0,a.Z)(),o=(0,r.useCallback)(((e,t)=>{const r=(0,q.ob)(e,"METRIC")?"METRIC":"PARAM",a=(0,q.hg)(e,r);n((e=>({...e,[t]:{key:a,type:r}})))}),[n]),d=(0,r.useCallback)((e=>{n((t=>({...t,runsCountToCompare:e})))}),[n]);return(0,r.useEffect)((()=>{var e,n,r;const a=null===i||void 0===i?void 0:i[0],s=null===l||void 0===l?void 0:l[0];null!==(e=t.xaxis)&&void 0!==e&&e.key||(a?o((0,q.Q0)("METRIC",a),"xaxis"):s&&o((0,q.Q0)("PARAM",s),"xaxis")),null!==(n=t.yaxis)&&void 0!==n&&n.key||(a?o((0,q.Q0)("METRIC",a),"yaxis"):s&&o((0,q.Q0)("PARAM",s),"yaxis")),null!==(r=t.zaxis)&&void 0!==r&&r.key||(a?o((0,q.Q0)("METRIC",a),"zaxis"):s&&o((0,q.Q0)("PARAM",s),"zaxis"))}),[t.xaxis,t.yaxis,t.zaxis,o,i,l]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(Bi,{title:s({id:"2Us2jl",defaultMessage:"X axis"}),children:(0,c.tZ)(Ai,{value:t.xaxis.key?(0,q.Q0)(t.xaxis.type,t.xaxis.key):"",onChange:e=>{o(e,"xaxis")},paramKeyList:l,metricKeyList:i})}),(0,c.tZ)(Bi,{title:s({id:"8YmId5",defaultMessage:"Y axis"}),children:(0,c.tZ)(Ai,{value:t.yaxis.key?(0,q.Q0)(t.yaxis.type,t.yaxis.key):"",onChange:e=>{o(e,"yaxis")},paramKeyList:l,metricKeyList:i})}),(0,c.tZ)(Bi,{title:s({id:"cB0/61",defaultMessage:"Z axis"}),children:(0,c.tZ)(Ai,{value:t.zaxis.key?(0,q.Q0)(t.zaxis.type,t.zaxis.key):"",onChange:e=>{o(e,"zaxis")},paramKeyList:l,metricKeyList:i})}),(0,c.tZ)(Ii,{value:t.runsCountToCompare,onChange:d,options:[5,10,20]})]})},Fi=Li;Fi.push({value:100,label:(0,c.tZ)(C.Z,{id:"Bbm59f",defaultMessage:"100"})},{value:250,label:(0,c.tZ)(C.Z,{id:"W8bOkn",defaultMessage:"250"})},{value:500,label:(0,c.tZ)(C.Z,{id:"Bnruyp",defaultMessage:"500"})});const Wi=e=>{let{state:t,onStateChange:n,metricKeyList:i,paramKeyList:l}=e;const{formatMessage:s}=(0,a.Z)(),o=(0,r.useCallback)(((e,t)=>{const r=(0,q.ob)(e,"METRIC")?"METRIC":"PARAM",a=(0,q.hg)(e,r);n((e=>({...e,[t]:{key:a,type:r}})))}),[n]),d=(0,r.useCallback)((e=>{n((t=>({...t,runsCountToCompare:e})))}),[n]);return(0,r.useEffect)((()=>{var e,n;const r=null===i||void 0===i?void 0:i[0],a=null===l||void 0===l?void 0:l[0];null!==(e=t.xaxis)&&void 0!==e&&e.key||(r?o((0,q.Q0)("METRIC",r),"xaxis"):a&&o((0,q.Q0)("PARAM",a),"xaxis")),null!==(n=t.yaxis)&&void 0!==n&&n.key||(r?o((0,q.Q0)("METRIC",r),"yaxis"):a&&o((0,q.Q0)("PARAM",a),"yaxis"))}),[t.xaxis,t.yaxis,o,i,l]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(Bi,{title:s({id:"vBKFgp",defaultMessage:"X axis"}),children:(0,c.tZ)(Ai,{value:t.xaxis.key?(0,q.Q0)(t.xaxis.type,t.xaxis.key):"",onChange:e=>{o(e,"xaxis")},paramKeyList:l,metricKeyList:i})}),(0,c.tZ)(Bi,{title:s({id:"DaF+KK",defaultMessage:"Y axis"}),children:(0,c.tZ)(Ai,{value:t.yaxis.key?(0,q.Q0)(t.yaxis.type,t.yaxis.key):"",onChange:e=>{o(e,"yaxis")},paramKeyList:l,metricKeyList:i})}),(0,c.tZ)(Ii,{value:t.runsCountToCompare,onChange:d,options:Fi})]})};var Ki=n(10318);const ji=e=>{let{activeRun:t,cardConfig:n,isHovering:r,hoverData:a}=e;return n.type===jr.BAR?((e,t)=>{const{metricKey:n}=e,r=null===t||void 0===t?void 0:t.metrics[n];return r?(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:[r.key,":"]})," ",(0,Ki.VZ)(r.value)]}):null})(n,t):n.type===jr.SCATTER?((e,t)=>{var n,r,a,i;const{xaxis:l,yaxis:s}=e,o=l.key,d=s.key,u="METRIC"===l.type?null===(n=t.metrics[o])||void 0===n?void 0:n.value:null===(r=t.params[o])||void 0===r?void 0:r.value,p="METRIC"===s.type?null===(a=t.metrics[d])||void 0===a?void 0:a.value:null===(i=t.params[d])||void 0===i?void 0:i.value;return(0,c.BX)(c.HY,{children:[u&&(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:["X (",o,"):"]})," ",(0,Ki.VZ)(u)]}),p&&(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:["Y (",d,"):"]})," ",(0,Ki.VZ)(p)]})]})})(n,t):n.type===jr.CONTOUR?((e,t)=>{var n,r,a,i,l,s;const{xaxis:o,yaxis:d,zaxis:u}=e,p=o.key,m=d.key,h=u.key,g="METRIC"===o.type?null===(n=t.metrics[p])||void 0===n?void 0:n.value:null===(r=t.params[p])||void 0===r?void 0:r.value,f="METRIC"===d.type?null===(a=t.metrics[m])||void 0===a?void 0:a.value:null===(i=t.params[m])||void 0===i?void 0:i.value,v="METRIC"===u.type?null===(l=t.metrics[h])||void 0===l?void 0:l.value:null===(s=t.params[h])||void 0===s?void 0:s.value;return(0,c.BX)(c.HY,{children:[g&&(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:["X (",p,"):"]})," ",(0,Ki.VZ)(g)]}),f&&(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:["Y (",m,"):"]})," ",(0,Ki.VZ)(f)]}),v&&(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:["Z (",h,"):"]})," ",(0,Ki.VZ)(v)]})]})})(n,t):n.type===jr.LINE?((e,t,n)=>{const{metricKey:r}=e,a=(null===n||void 0===n?void 0:n.yValue)||(null===t||void 0===t?void 0:t.metrics[r].value);return a?(0,c.BX)(c.HY,{children:[n&&(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:[n.label,":"]})," ",n.xValue]}),(0,c.BX)("div",{css:Yi.value,children:[(0,c.BX)("strong",{children:[r,":"]})," ",(0,Ki.VZ)(a)]})]}):null})(n,t,a):n.type===jr.PARALLEL?((e,t,n)=>{const{selectedParams:r,selectedMetrics:a}=e,i=r.map((e=>{const n=null===t||void 0===t?void 0:t.params[e];return!n||(0,c.BX)("div",{children:[(0,c.BX)("strong",{children:[n.key,":"]})," ",(0,Ki.VZ)(n.value)]},e)})),l=a.map((e=>{const n=null===t||void 0===t?void 0:t.metrics[e];return!n||(0,c.BX)("div",{children:[(0,c.BX)("strong",{children:[n.key,":"]})," ",(0,Ki.VZ)(n.value)]},e)}));return n?(0,c.BX)(c.HY,{children:[i.slice(0,3),(i.length>3||l.length>1)&&(0,c.tZ)("div",{children:"..."}),l[l.length-1]]}):(0,c.BX)(c.HY,{children:[i,l]})})(n,t,r):null},$i=e=>{let{closeContextMenu:t,contextData:n,hoverData:r,chartData:a,runUuid:i,isHovering:l}=e;const{runs:s,onTogglePin:o,onHideRun:d}=n,[u]=de(),p=null===s||void 0===s?void 0:s.find((e=>e.runInfo.run_uuid===i));return p?(0,c.BX)("div",{children:[(0,c.BX)("div",{css:Yi.contentWrapper,children:[(0,c.BX)("div",{css:Yi.header,children:[(0,c.tZ)("div",{css:Yi.colorPill,style:{backgroundColor:p.color}}),(0,c.tZ)(Q.rU,{to:G.ZP.getRunPageRoute(u,i),target:"_blank",css:Yi.runLink,onClick:t,children:p.runInfo.run_name||p.runInfo.run_uuid})]}),!l&&(0,c.tZ)(y.B,{size:"small",onClick:t,icon:(0,c.tZ)(y.C,{})})]}),(0,c.tZ)(ji,{isHovering:l,activeRun:p,cardConfig:a,hoverData:r}),(0,c.BX)("div",{css:Yi.actionsWrapper,children:[p.pinnable&&o&&(0,c.tZ)(y.e,{title:p.pinned?(0,c.tZ)(C.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,c.tZ)(C.Z,{id:"58xhem",defaultMessage:"Click to pin the run"}),placement:"bottom",children:(0,c.tZ)(y.B,{size:"small",onClick:()=>{o(i),t()},icon:p.pinned?(0,c.tZ)(m.D$V,{}):(0,c.tZ)(m.qQX,{})})}),d&&(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"eE5VIF",defaultMessage:"Click to hide the run"}),placement:"bottom",children:(0,c.tZ)(y.B,{"data-testid":"experiment-view-compare-runs-tooltip-visibility-button",size:"small",onClick:()=>{d(i),t()},icon:(0,c.tZ)(m.bMb,{})})})]})]}):null},Yi={runLink:e=>({color:e.colors.primary,"&:hover":{}}),actionsWrapper:{marginTop:8,display:"flex",gap:8,alignItems:"center"},header:{display:"flex",gap:8,alignItems:"center"},value:{maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},contentWrapper:{display:"flex",gap:8,alignItems:"center",marginBottom:12,justifyContent:"space-between",height:24},colorPill:{width:12,height:12,borderRadius:"100%"}};const qi={[jr.BAR]:e=>{let{previewData:t,cardConfig:n}=e;const{resetTooltip:r,setTooltip:a}=(0,za.Hs)(n);return(0,c.tZ)(Xa.D,{useDefaultHoverBox:!1,displayRunNames:!1,displayMetricKey:!1,metricKey:n.metricKey,runsData:t,margin:Wa,onHover:a,onUnhover:r})},[jr.CONTOUR]:e=>{let{previewData:t,cardConfig:n}=e;const{resetTooltip:r,setTooltip:a}=(0,za.Hs)(n);return(0,c.tZ)(Zi,{xAxis:n.xaxis,yAxis:n.yaxis,zAxis:n.zaxis,runsData:t,onHover:a,onUnhover:r,useDefaultHoverBox:!1})},[jr.LINE]:Ui,[jr.PARALLEL]:e=>{var t,n;let{previewData:r,cardConfig:a}=e;const i=((null===(t=a.selectedParams)||void 0===t?void 0:t.length)||0)+((null===(n=a.selectedMetrics)||void 0===n?void 0:n.length)||0)>=2,{setTooltip:l,resetTooltip:s}=(0,za.Hs)(a),o=i?ri(r,a.selectedParams,a.selectedMetrics):[];return i?o.length?(0,c.tZ)(ai,{selectedMetrics:a.selectedMetrics,selectedParams:a.selectedParams,data:o,axesRotateThreshold:6,onHover:l,onUnhover:s}):null:(0,c.tZ)("div",{css:_i,children:"Select at least two metrics and params first"})},[jr.SCATTER]:e=>{let{previewData:t,cardConfig:n}=e;const{resetTooltip:r,setTooltip:a}=(0,za.Hs)(n);return(0,c.tZ)(vi,{xAxis:n.xaxis,yAxis:n.yaxis,runsData:t,onHover:a,onUnhover:r,useDefaultHoverBox:!1})}};var Qi={name:"1uahl7",styles:"width:1280px"},Gi={name:"1d3w5wq",styles:"width:100%"};const Ji=e=>{let{onCancel:t,onSubmit:n,config:i,chartRunData:l,metricKeyList:s,paramKeyList:o}=e;const[d,u]=(0,r.useState)(i),p=Boolean(d.uuid),h=(0,r.useCallback)((e=>{if(!e)return;const t=$r.getEmptyChartCardByType(e);t&&u(t)}),[]),g=(0,r.useMemo)((()=>l.slice(0,d.runsCountToCompare).reverse()),[l,d.runsCountToCompare]),{formatMessage:f}=(0,a.Z)();return(0,c.tZ)(m.u_l,{visible:!0,onCancel:t,onOk:()=>n(d),title:f(p?{id:"kBXHTA",defaultMessage:"Edit chart"}:{id:"6y36Fr",defaultMessage:"Add new chart"}),okButtonProps:{"data-testid":"experiment-view-compare-runs-chart-modal-confirm"},cancelText:f({id:"TlVXcS",defaultMessage:"Cancel"}),okText:f(p?{id:"vPnoNk",defaultMessage:"Save changes"}:{id:"UzZf+2",defaultMessage:"Add chart"}),size:"wide",css:Qi,children:(0,c.BX)("div",{css:el.wrapper,children:[(0,c.BX)("div",{children:[!p&&(0,c.tZ)(Bi,{title:"Type",children:(0,c.BX)(m.Select,{css:Gi,value:d.type,onChange:h,children:[(0,c.tZ)(m.Select.Option,{value:jr.BAR,children:(0,c.BX)("div",{css:el.chartTypeOption,children:[(0,c.tZ)(sa,{}),"Bar chart"]})}),(0,c.tZ)(m.Select.Option,{value:jr.SCATTER,children:(0,c.BX)("div",{css:el.chartTypeOption,children:[(0,c.tZ)(Oa,{}),"Scatter chart"]})}),(0,c.tZ)(m.Select.Option,{value:jr.LINE,children:(0,c.BX)("div",{css:el.chartTypeOption,children:[(0,c.tZ)(ya,{}),"Line chart"]})}),(0,c.tZ)(m.Select.Option,{value:jr.PARALLEL,children:(0,c.BX)("div",{css:el.chartTypeOption,children:[(0,c.tZ)(Ra,{}),"Parallel coordinates"]})}),(0,c.tZ)(m.Select.Option,{value:jr.CONTOUR,children:(0,c.BX)("div",{css:el.chartTypeOption,children:[(0,c.tZ)(ma,{}),"Contour chart"]})})]})}),(v=d.type,v===jr.BAR?(0,c.tZ)(Ni,{metricKeyList:s,state:d,onStateChange:u}):v===jr.CONTOUR?(0,c.tZ)(Vi,{metricKeyList:s,paramKeyList:o,state:d,onStateChange:u}):v===jr.LINE?(0,c.tZ)(Hi,{metricKeyList:s,state:d,onStateChange:u}):v===jr.PARALLEL?(0,c.tZ)(Pi,{metricKeyList:s,paramKeyList:o,state:d,onStateChange:u}):v===jr.SCATTER?(0,c.tZ)(Wi,{metricKeyList:s,paramKeyList:o,state:d,onStateChange:u}):null)]}),(0,c.tZ)(za.ol,{contextData:{runs:l},component:$i,hoverOnly:!0,children:(0,c.tZ)("div",{css:el.chartWrapper,children:(e=>{if(!e)return null;const t=qi[e];return t?(0,c.tZ)(t,{previewData:g,cardConfig:d}):null})(d.type)})})]})});var v},el={chartTypeOption:e=>({display:"grid",gridTemplateColumns:`${e.general.iconSize+e.spacing.xs}px 1fr`,gap:e.spacing.xs,alignItems:"center"}),wrapper:{display:"grid",gridTemplateColumns:"300px 1fr",gap:32},field:{display:"grid",gridTemplateColumns:"80px 1fr",marginBottom:16},chartWrapper:{height:400}},tl={controlsWrapper:e=>({position:"sticky",top:0,marginBottom:e.spacing.md,display:"flex",justifyContent:"flex-end",zIndex:2,backgroundColor:e.colors.backgroundSecondary,paddingTop:e.spacing.md,paddingBottom:e.spacing.md}),wrapper:e=>({borderTop:`1px solid ${e.colors.border}`,borderLeft:`1px solid ${e.colors.border}`,marginLeft:-1,position:"relative",backgroundColor:e.colors.backgroundSecondary,paddingLeft:e.spacing.md,paddingRight:e.spacing.md,paddingBottom:e.spacing.md,zIndex:1,overflowY:"auto"})},nl=(0,S.$j)((e=>{let{entities:t}=e;const{paramsByRunUuid:n,latestMetricsByRunUuid:r,metricsByRunUuid:a}=t;return{paramsByRunUuid:n,latestMetricsByRunUuid:r,metricsByRunUuid:a}}),void 0,void 0,{areStatesEqual:(e,t)=>e.entities===t.entities})((e=>{let{comparedRuns:t,isLoading:n,searchFacetsState:a,updateSearchFacets:i,latestMetricsByRunUuid:l,metricsByRunUuid:o,paramsByRunUuid:d,metricKeyList:u,paramKeyList:p,experimentTags:h}=e;const[g,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)(null),b=(0,r.useCallback)((e=>{y($r.getEmptyChartCardByType(e))}),[]),C=(0,r.useCallback)((e=>{y(e)}),[]);(0,r.useEffect)((()=>{g||n||f(!0)}),[g,n]);const x=(0,r.useMemo)((()=>{const e=h[Y.uN],t=h[Y.JG];return(null===e||void 0===e?void 0:e.value)||(null===t||void 0===t?void 0:t.value)||u[0]||""}),[h,u]),Z=(0,r.useMemo)((()=>t.filter((e=>!e.hidden)).map((e=>({runInfo:e.runInfo,metrics:l[e.runUuid]||{},params:d[e.runUuid]||{},color:e.color,pinned:e.pinned,pinnable:e.pinnable,metricsHistory:{}})))),[t,l,d]),{isLoading:w,chartRunDataWithHistory:k}=((e,t)=>{const n=(0,r.useMemo)((()=>e.filter((e=>e.type===jr.LINE))),[e]),a=(0,S.v9)((e=>e.entities.metricsByRunUuid)),i=(0,r.useMemo)((()=>{if(!n.length)return[];const e=(0,s.max)(n.map((e=>e.runsCountToCompare||10)));return t.slice(0,e)}),[n,t]),l=(0,r.useMemo)((()=>Array.from(new Set(n.map((e=>e.metricKey))))),[n]),{isLoading:o}=(0,zi.u)(l,i);return{isLoading:o,chartRunDataWithHistory:(0,r.useMemo)((()=>i.length?t.map((e=>({...e,metricsHistory:a[e.runInfo.run_uuid]||void 0}))):t),[i,a,t])}})(a.compareRunCharts||[],Z);(0,r.useEffect)((()=>{!a.compareRunCharts&&k.length>0&&i((e=>({...e,compareRunCharts:$r.getBaseChartConfigs(x,k[0].metrics)})),{replaceHistory:!0})}),[a.compareRunCharts,x,i,k]);const R=(0,r.useCallback)((e=>{i((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]})))}),[i]),M=(0,r.useCallback)((e=>{i((t=>({...t,runsHidden:[...t.runsHidden,e]})))}),[i]),E=(0,r.useMemo)((()=>({runs:k,onTogglePin:R,onHideRun:M})),[k,M,R]);return g?(0,c.BX)("div",{css:tl.wrapper,"data-testid":"experiment-view-compare-runs-chart-area",children:[(0,c.tZ)("div",{css:tl.controlsWrapper,children:(0,c.tZ)(Pa,{onAddChart:b})}),(0,c.tZ)(za.ol,{contextData:E,component:$i,children:(0,c.tZ)(Ei,{chartRunData:k,cardsConfig:a.compareRunCharts||[],onStartEditChart:C,onRemoveChart:e=>{i((t=>{var n;return{...t,compareRunCharts:null===(n=t.compareRunCharts)||void 0===n?void 0:n.filter((t=>t.uuid!==e.uuid))}}))},isMetricHistoryLoading:w})}),v&&(0,c.tZ)(Ji,{chartRunData:k,metricKeyList:u,paramKeyList:p,config:v,onSubmit:e=>{const t=$r.serialize({...e,uuid:(0,Kr.Fs)()});e.uuid?i((n=>{var r;return{...n,compareRunCharts:null===(r=n.compareRunCharts)||void 0===r?void 0:r.map((n=>n.uuid===e.uuid?t:n))}})):i((e=>({...e,compareRunCharts:e.compareRunCharts&&[...e.compareRunCharts,t]}))),y(null)},onCancel:()=>y(null)})]}):(0,c.tZ)("div",{css:tl.wrapper,children:(0,c.tZ)(m.Qck,{})})})),rl="FETCHED_RUN_NOTIFICATION_KEY",al=e=>{const{formatMessage:t}=(0,a.Z)(),n=(0,r.useCallback)(((e,n)=>e===n?t({id:"KJbYrw",defaultMessage:"Loaded {childRuns} child {childRuns, plural, =1 {run} other {runs}}"},{childRuns:n}):t({id:"ziIhFQ",defaultMessage:"Loaded {allRuns} {allRuns, plural, =1 {run} other {runs}}, including {childRuns} child {childRuns, plural, =1 {run} other {runs}}"},{allRuns:e,childRuns:n})),[t]);return(0,r.useCallback)(((t,r)=>{if(Array.isArray(t)){const{allRuns:a,childRuns:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=e.filter((e=>!t.some((t=>t.run_uuid===e.info.run_uuid)))),r=n.filter((e=>{var t;const n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.tags;return Array.isArray(n)&&n.some((e=>e.key===q.ss&&Boolean(e.value)))}));return{allRuns:n.length,childRuns:r.length}}(t,r);if(i<1)return;e.close(rl),e.info({message:n(a,i),duration:3,placement:"bottomRight",key:rl})}}),[e,n])};var il=n(68915);const ll=e=>{var t,n;return(null===(t=e.tags)||void 0===t||null===(n=t[Y.kt])||void 0===n?void 0:n.value)===Y.Bj};var sl=n(31894);const ol=r.createContext({getMissingParams:()=>[],pendingDataLoading:{},getEvaluableRowCount:()=>0,evaluateCell:()=>{},evaluateAllClick:()=>{},runColumnsBeingEvaluated:[],canEvaluateInRunColumn:()=>!1,toggleExpandedHeader:()=>{},isHeaderExpanded:!1}),dl=e=>{let{tableData:t,outputColumn:n,children:i}=e;const s=(0,a.Z)(),[o,d]=(0,r.useState)(!1),u=(0,r.useCallback)((()=>d((e=>!e))),[]),p=(0,r.useCallback)(((e,n)=>{if(!(0,It.Fc)(e))return null;const r=t.find((e=>e.key===n));if(!r)return null;const{promptTemplate:a}=(0,It.rP)(e);if(!a)return null;return(0,It.xN)(a).filter((e=>!r.groupByCellValues[e]))}),[t]),m=(0,S.I0)(),{startEvaluatingRunColumn:h,stopEvaluatingRunColumn:g,runColumnsBeingEvaluated:f}=((e,t)=>{const n=(0,r.useRef)(e),a=(0,r.useRef)([]);(0,r.useEffect)((()=>{n.current=e}),[e]);const[i,s]=(0,r.useState)([]);(0,r.useEffect)((()=>{a.current=i}),[i]);const o=(0,S.I0)(),d=(0,r.useCallback)((e=>{const r=n.current,{parameters:i,promptTemplate:c,routeName:u}=(0,It.rP)(e);if(!c)return;const p=(0,It.xN)(c),m=r.find((t=>!t.cellValues[e.runUuid]&&((e,t)=>0===t.filter((t=>!e.groupByCellValues[t])).length)(t,p)));if(!m)return void s((t=>t.filter((t=>t!==e.runUuid))));const h=m.key,g=m.groupByCellValues;if(!c)return;const f=(0,It.Ky)(c,g);u&&o((0,sl.GE)({routeName:u,compiledPrompt:f,inputValues:g,outputColumn:t,rowKey:h,parameters:i,run:e})).then((()=>{a.current.includes(e.runUuid)&&d(e)})).catch((t=>{l.default.logErrorAndNotifyUser(t),s((t=>t.filter((t=>t!==e.runUuid))))}))}),[o,t]),c=(0,r.useCallback)((e=>{s((t=>[...t,e.runUuid])),d(e)}),[d]),u=(0,r.useCallback)((e=>{s((t=>t.filter((t=>t!==e.runUuid))))}),[]);return{runColumnsBeingEvaluated:i,startEvaluatingRunColumn:c,stopEvaluatingRunColumn:u}})(t,n),v=(0,S.v9)((e=>{let{evaluationData:t}=e;return t.evaluationPendingDataLoadingByRunUuid})),y=(0,r.useCallback)((e=>n===It.JL&&(0,It.Fc)(e)),[n]),b=(0,r.useCallback)((e=>t.filter((t=>{if(t.cellValues[e.runUuid])return!1;const n=p(e,t.key);return 0===(null===n||void 0===n?void 0:n.length)})).length),[t,p]),C=(0,r.useCallback)((e=>{f.includes(e.runUuid)?g(e):h(e)}),[f,h,g]),x=(0,r.useCallback)(((e,r)=>{const a=t.find((e=>{let{key:t}=e;return t===r}));if(!a)return;const i=a.groupByCellValues,{parameters:o,promptTemplate:d,routeName:c}=(0,It.rP)(e);if(!d)return;const u=(0,It.Ky)(d,i);c&&m((0,sl.GE)({routeName:c,compiledPrompt:u,inputValues:i,outputColumn:n,rowKey:r,parameters:o,run:e})).catch((e=>{const t=e.getGatewayErrorMessage()||e.getUserVisibleError(),n=s.formatMessage({id:"yC9GFP",defaultMessage:'MLflow deployment returned the following error: "{errorMessage}"'},{errorMessage:t});l.default.logErrorAndNotifyUser(n)}))}),[t,m,n,s]),Z=(0,r.useMemo)((()=>({getMissingParams:p,getEvaluableRowCount:b,evaluateCell:x,evaluateAllClick:C,pendingDataLoading:v,canEvaluateInRunColumn:y,runColumnsBeingEvaluated:f,isHeaderExpanded:o,toggleExpandedHeader:u})),[p,b,C,x,v,y,f,o,u]);return(0,c.tZ)(ol.Provider,{value:Z,children:i})},cl=()=>(0,r.useContext)(ol);var ul={name:"1h52dri",styles:"overflow:hidden;text-overflow:ellipsis;white-space:nowrap"},pl={name:"lyel5l",styles:"font-size:0"},ml={name:"1hetg88",styles:"max-width:300px"};const hl=e=>{let{run:t}=e;const{theme:n}=(0,y.u)(),{isHeaderExpanded:r}=cl(),a=(0,It.rP)(t),i=(0,S.v9)((e=>{let{modelGateway:t}=e;return a.routeName?t.modelGatewayRoutes[a.routeName]:null}));if(!(0,It.Fc)(t)||!a)return null;const{parameters:l,promptTemplate:s,routeName:o}=a,{stop:d=[]}=l;return(0,c.BX)("div",{css:(0,f.iv)({marginTop:n.spacing.xs,flex:1,display:"flex",flexDirection:"column",gap:n.spacing.sm,overflowX:"hidden",width:"100%"},""),children:[(0,c.tZ)(y.T.Hint,{children:i?i.model.name:o}),r&&(0,c.BX)(c.HY,{children:[(0,c.tZ)(y.T.Hint,{children:(0,c.tZ)(C.Z,{id:"HGBit9",defaultMessage:"Temperature: {temperature}",values:l})}),(0,c.tZ)(y.T.Hint,{children:(0,c.tZ)(C.Z,{id:"6K04VZ",defaultMessage:"Max. tokens: {max_tokens}",values:l})}),d.length?(0,c.tZ)(y.T.Hint,{css:ul,children:(0,c.tZ)(C.Z,{id:"iC2Owx",defaultMessage:"Stop sequences: {stopSequences}",values:{stopSequences:null===d||void 0===d?void 0:d.join(", ")}})}):null,(0,c.tZ)("div",{css:pl,children:(0,c.BX)(m.J2e.Root,{children:[(0,c.tZ)(m.J2e.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{type:"link",size:"small",css:(0,f.iv)({fontSize:n.typography.fontSizeSm},""),children:(0,c.tZ)(C.Z,{id:"XX8+x1",defaultMessage:"View prompt template"})})}),(0,c.BX)(m.J2e.Content,{css:ml,children:[(0,c.tZ)(m.J2e.Arrow,{}),s]})]})})]})]})};var gl=n(7118);var fl={name:"1iwgvlm",styles:"flex-shrink:1;flex-grow:1;overflow:hidden"},vl={name:"1kd7iwj",styles:"flex-shrink:0;flex-grow:1;display:flex;align-items:flex-end"};const yl=e=>{var t;let{run:n,onDatasetSelected:a}=e;const{theme:i}=(0,y.u)(),l=(0,r.useCallback)((e=>a(e,n)),[a,n]);return(null===(t=n.datasets)||void 0===t?void 0:t.length)<1?null:(0,c.BX)("div",{css:(0,f.iv)({display:"flex",alignItems:"center",gap:i.spacing.xs,overflow:"hidden"},""),children:[(0,c.tZ)("div",{css:fl,children:(0,c.tZ)(y.B,{type:"link",onClick:()=>l(n.datasets[0]),children:(0,c.tZ)(gl.O,{datasetWithTags:n.datasets[0],displayTextAsLink:!0,css:(0,f.iv)({marginTop:i.spacing.xs/2,marginBottom:i.spacing.xs/2},"")})})}),n.datasets.length>1&&(0,c.tZ)("div",{css:vl,children:(0,c.BX)(m.J2e.Root,{modal:!1,children:[(0,c.tZ)(m.J2e.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{size:"small",style:{borderRadius:"8px",width:"40px"},children:(0,c.BX)(y.T.Text,{color:"secondary",children:["+",n.datasets.length-1]})})}),(0,c.tZ)(m.J2e.Content,{align:"start",children:n.datasets.slice(1).filter(Boolean).map((e=>(0,c.tZ)("div",{css:(0,f.iv)({height:i.general.heightSm,display:"flex",alignItems:"center"},""),children:(0,c.tZ)(y.B,{type:"link",onClick:()=>l(e),children:(0,c.tZ)(gl.O,{datasetWithTags:e,displayTextAsLink:!0})})},`${e.dataset.name}-${e.dataset.digest}`)))})]})})]})};var bl={name:"1on1b16",styles:"width:100%;height:100%;display:flex;flex-direction:column"};const Cl=e=>{let{children:t,className:n,groupHeaderContent:r=null}=e;const{theme:a}=(0,y.u)();return(0,c.BX)("div",{css:bl,children:[(0,c.tZ)("div",{css:(0,f.iv)({width:"100%",flexBasis:40,display:"flex",alignItems:"center",padding:a.spacing.sm,borderBottom:`1px solid ${a.colors.borderDecorative}`},""),className:"header-group-cell",children:r}),(0,c.tZ)("div",{css:(0,f.iv)({width:"100%",flex:1,display:"flex",justifyContent:"flex-start",alignItems:"flex-start",padding:a.spacing.xs,borderRight:`1px solid ${a.colors.borderDecorative}`},""),className:n,children:t})]})};var xl={name:"8xhv84",styles:"width:100%;display:flex"},Zl={name:"82a6rk",styles:"flex:1"};const wl=e=>{let{run:t,onHideRun:n,onDuplicateRun:i,onDatasetSelected:l,groupHeaderContent:s=null}=e;const{theme:o}=(0,y.u)(),{getEvaluableRowCount:d,evaluateAllClick:u,runColumnsBeingEvaluated:p,canEvaluateInRunColumn:h}=cl(),g=(0,a.Z)(),v=d(t),b=v>0,x=p.includes(t.runUuid),Z=(0,r.useMemo)((()=>b?b&&!x?g.formatMessage({id:"2gmOVq",defaultMessage:"Process {evaluableRowCount} rows without evaluation output"},{evaluableRowCount:v}):null:g.formatMessage({id:"7m2B5x",defaultMessage:"There are no evaluable rows within this column"})),[v,b,x,g]);return(0,c.BX)(Cl,{css:(0,f.iv)({justifyContent:"flex-start",padding:o.spacing.sm,paddingBottom:0,paddingTop:o.spacing.sm,flexDirection:"column",gap:o.spacing.xs/2,overflow:"hidden"},""),groupHeaderContent:s,children:[(0,c.BX)("div",{css:xl,children:[(0,c.BX)(Q.rU,{css:(0,f.iv)({display:"flex",gap:o.spacing.sm,alignItems:"center"},""),to:G.ZP.getRunPageRoute(t.experimentId,t.runUuid),target:"_blank",children:[(0,c.tZ)("div",{css:(0,f.iv)({backgroundColor:t.color,width:12,height:12,borderRadius:6},"")}),t.runName]}),(0,c.tZ)("div",{css:(0,f.iv)({flexBasis:o.spacing.sm},"")}),(0,c.tZ)(y.B,{onClick:()=>n(t.runUuid),size:"small",icon:(0,c.tZ)(m.bMb,{})}),(0,c.tZ)("div",{css:Zl}),(0,ce.sq)()&&h(t)&&(0,c.BX)(c.HY,{children:[(0,c.tZ)("div",{css:(0,f.iv)({flexBasis:o.spacing.sm},"")}),(0,c.tZ)(y.e,{title:Z,children:(0,c.tZ)(y.B,{disabled:!b,size:"small",onClick:()=>u(t),icon:x?(0,c.tZ)(m.wNq,{}):(0,c.tZ)(m.o1U,{}),children:x?(0,c.tZ)(C.Z,{id:"plw4Kp",defaultMessage:"Stop evaluating"}):(0,c.tZ)(C.Z,{id:"JnIbS3",defaultMessage:"Evaluate all"})})})]}),(0,c.tZ)("div",{css:(0,f.iv)({flexBasis:o.spacing.sm},"")}),(0,ce.sq)()&&(0,It.Fc)(t)&&(0,c.BX)(y.O.Root,{modal:!1,children:[(0,c.tZ)(y.O.Trigger,{asChild:!0,children:(0,c.tZ)(y.B,{size:"small",icon:(0,c.tZ)(m.VZO,{})})}),(0,c.tZ)(y.O.Content,{children:(0,c.tZ)(y.O.Item,{onClick:()=>i(t),children:(0,c.tZ)(C.Z,{id:"1YGQOY",defaultMessage:"Duplicate run"})})})]})]}),(0,ce.sq)()&&(0,It.Fc)(t)?(0,c.tZ)(hl,{run:t}):(0,ce.GW)()&&(0,c.tZ)(yl,{run:t,onDatasetSelected:l})]})},Sl=e=>{let{disabled:t,isLoading:n,run:r,rowKey:a}=e;const i=(0,It.Fc)(r),{evaluateCell:l,getMissingParams:s}=cl(),o=r&&s(r,a)||null;return o&&o.length>0?(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"yAuDRt",defaultMessage:'Evaluation is not possible because values for the following inputs cannot be determined: {missingParamList}. Add input columns to the "group by" settings or use "Add row" button to define new parameter set.',values:{missingParamList:(0,c.tZ)("code",{children:o.join(", ")})}}),children:(0,c.tZ)(y.f,{})}):i?(0,c.tZ)(y.B,{loading:n,disabled:t,size:"small",onMouseDownCapture:e=>e.stopPropagation(),onClickCapture:e=>{e.stopPropagation(),l(r,a)},icon:(0,c.tZ)(m.o1U,{}),children:(0,c.tZ)(c.HY,{children:"Evaluate"})}):(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"Bj7jg5",defaultMessage:"You cannot evaluate this cell, this run was not created using MLflow deployment endpoints."}),children:(0,c.tZ)(y.f,{})})};const kl=r.memo((e=>{let{text:t,highlight:n}=e;const{theme:a}=(0,y.u)();if(!n)return(0,c.tZ)(c.HY,{children:t});const i=t.split(new RegExp(`(${n})`,"gi"));return(0,c.tZ)(c.HY,{children:i.map(((e,t)=>(0,c.tZ)(r.Fragment,{children:e.toLowerCase()===n.toLowerCase()?(0,c.tZ)("span",{css:(0,f.iv)({backgroundColor:a.colors.yellow200},""),children:e}):e},t)))})}));var Rl={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},Ml={name:"52b6nu",styles:"display:-webkit-box;overflow:hidden;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:7"},El={name:"1jwcxx3",styles:"font-style:italic"};const Tl=e=>{var t,n;let{value:r,context:a,isGroupByColumn:i,run:l,data:s}=e;const{theme:o}=(0,y.u)(),{pendingDataLoading:d,canEvaluateInRunColumn:u}=cl(),p=(0,S.v9)((e=>{let{modelGateway:t}=e;return t.modelGatewayRoutesLoading})),h=l&&(null===(t=d[l.runUuid])||void 0===t?void 0:t[null===s||void 0===s?void 0:s.key]),g=l&&(null===(n=s.outputMetadataByRunUuid)||void 0===n?void 0:n[l.runUuid])||null,v=null!==g&&void 0!==g&&g.isPending||s.isPendingInputRow?o.colors.backgroundSecondary:o.colors.backgroundPrimary;return(0,c.BX)("div",{css:(0,f.iv)({height:"100%",whiteSpace:"normal",padding:o.spacing.sm,overflow:"hidden",position:"relative",cursor:"pointer",backgroundColor:v,"&:hover":{backgroundColor:o.colors.actionDefaultBackgroundHover}},""),children:[h?(0,c.tZ)(m.hM6,{lines:3}):(0,c.tZ)(c.HY,{children:r?(0,c.tZ)("span",{css:Ml,children:i&&a.highlightedText?(0,c.tZ)(kl,{text:r,highlight:a.highlightedText}):r.substring(0,512)}):(0,c.tZ)(y.T.Text,{color:"info",css:Rl,children:(0,c.tZ)(C.Z,{id:"aQxQIF",defaultMessage:"(empty)"})})}),(0,ce.sq)()&&l&&u(l)&&(0,c.BX)("div",{css:(0,f.iv)({position:"absolute",left:8,bottom:8,right:8,display:"flex",gap:o.spacing.sm,alignItems:"center",justifyContent:"space-between"},""),children:[(0,c.BX)("div",{css:(0,f.iv)({display:"flex",alignItems:"center",gap:o.spacing.xs},""),children:[!r&&(0,c.tZ)(Sl,{disabled:h,isLoading:p,run:l,rowKey:s.key}),((null===g||void 0===g?void 0:g.isPending)||s.isPendingInputRow)&&(0,c.tZ)(y.T.Hint,{size:"sm",css:El,children:(0,c.tZ)(C.Z,{id:"2fvQaF",defaultMessage:"Unsaved"})})]}),g&&!h&&(0,c.BX)("div",{css:(0,f.iv)({display:"flex",gap:o.spacing.xs,alignItems:"center"},""),children:[g.evaluationTime&&(0,c.BX)(y.T.Hint,{size:"sm",children:[Math.round(g.evaluationTime)," ms",g.totalTokens?",":""]}),g.totalTokens&&(0,c.tZ)(y.T.Hint,{size:"sm",children:(0,c.tZ)(C.Z,{id:"/nPZbt",defaultMessage:"{totalTokens} total tokens",values:{totalTokens:g.totalTokens}})})]})]})]})},Bl={initialWidthGroupBy:200,initialWidthOutput:360,maxWidth:500,minWidth:140};var Al={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"};const Il=e=>{let{displayName:t}=e;const{theme:n}=(0,y.u)();return(0,c.tZ)(Cl,{css:(0,f.iv)({justifyContent:"flex-start",padding:n.spacing.sm},""),children:(0,c.tZ)(y.e,{title:(0,s.truncate)(t,{length:250}),children:(0,c.tZ)(y.T.Text,{bold:!0,css:Al,children:t})})})};var Ll={name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"};const Dl={svg:{width:20,height:20}},Nl=()=>{const{toggleExpandedHeader:e,isHeaderExpanded:t}=cl();return(0,c.tZ)(Cl,{children:(0,c.tZ)(y.e,{placement:"right",title:(0,c.tZ)(C.Z,{id:"lDGQGa",defaultMessage:"Toggle detailed view"}),children:(0,c.tZ)(y.B,{icon:t?(0,c.tZ)(m.v4q,{css:Dl}):(0,c.tZ)(y.b,{css:Dl}),onClick:e})})})},Ol=e=>{let{onAddNewInputs:t,displayAddNewInputsButton:n}=e;const{theme:r}=(0,y.u)();return n?(0,c.tZ)("div",{css:(0,f.iv)({width:"100%",height:"100%",display:"flex",flexDirection:"column",padding:r.spacing.xs},""),children:(0,c.tZ)(y.e,{placement:"right",title:(0,c.tZ)(C.Z,{id:"PNfcez",defaultMessage:"Add row"}),children:(0,c.tZ)(y.B,{icon:(0,c.tZ)(m.pOD,{}),onClick:t})})}):null};var Pl={name:"3ytxc3",styles:"height:100%;overflow:hidden"};const Hl=e=>{let{resultList:t,visibleRuns:n,groupByColumns:i,onCellClick:l,onHideRun:o,onDatasetSelected:d,highlightedText:u="",isPreviewPaneVisible:p,outputColumnName:h}=e;const[g,v]=(0,r.useState)([]),[b,x]=(0,r.useState)(null),Z=(0,S.v9)((e=>{let{evaluationData:t}=e;return t.evaluationPendingDataByRunUuid})),w=(0,r.useRef)(null),{isHeaderExpanded:k}=cl(),{createNewRun:R}=on(),M=(0,r.useCallback)((e=>{null===b||void 0===b||b.refreshHeader(),o(e)}),[b,o]),E=(0,r.useCallback)((e=>{null===b||void 0===b||b.refreshHeader(),R(e)}),[R,b]);(0,r.useEffect)((()=>{b&&!p&&b.clearFocusedCell()}),[b,p]),(0,r.useEffect)((()=>{if(!b)return;const e=b.getRenderedNodes();b.refreshCells({force:!0,rowNodes:e})}),[b,Z,u]);const{showAddNewInputsModal:T,AddNewInputsModal:B}=(()=>{const[e,t]=(0,r.useState)(!1),[n,a]=(0,r.useState)([]),[i,l]=(0,r.useState)({}),o=(0,r.useMemo)((()=>n.every((e=>{let{inputName:t}=e;return i[t]}))),[i,n]),[d,u]=(0,r.useState)((async()=>{})),p=(0,r.useCallback)(((e,t)=>{l((n=>({...n,[e]:t})))}),[]),h=(0,r.useCallback)(((e,n)=>{const r=e.filter(It.Fc).map((e=>({runName:e.runName,params:(0,It.oV)(e)}))),i=(0,s.uniq)(r.map((e=>{let{params:t}=e;return t})).flat()).map((e=>({inputName:e,runNames:r.filter((t=>t.params.includes(e))).map((e=>{let{runName:t}=e;return t}))})));t(!0),a(i),l({}),u((()=>n))}),[]),{theme:g}=(0,y.u)(),v=(0,c.tZ)(m.u_l,{title:(0,c.tZ)(C.Z,{id:"JnidmZ",defaultMessage:"Add row"}),okButtonProps:{disabled:!o},okText:(0,c.tZ)(C.Z,{id:"eeLqSn",defaultMessage:"Submit"}),cancelText:(0,c.tZ)(C.Z,{id:"jwALGI",defaultMessage:"Cancel"}),onOk:()=>{d(i),t(!1)},visible:e,onCancel:()=>t(!1),children:n.map((e=>{let{inputName:t,runNames:n}=e;return(0,c.BX)("div",{css:(0,f.iv)({marginBottom:g.spacing.md},""),children:[(0,c.tZ)(y.T.Text,{bold:!0,children:t}),(0,c.tZ)(y.T.Hint,{css:Ll,children:(0,c.tZ)(C.Z,{id:"s35HDG",defaultMessage:"Used by {runNames} {hasMore, select, true {and other runs} other {}}",values:{runNames:n.slice(0,5).join(", "),hasMore:n.length>5}})}),(0,c.tZ)("div",{css:(0,f.iv)({marginTop:g.spacing.sm},""),children:(0,c.tZ)(y.h.TextArea,{value:i[t],onChange:e=>p(t,e.target.value)})})]},t)}))});return{showAddNewInputsModal:h,AddNewInputsModal:v}})(),A=(0,S.I0)(),I=(0,r.useCallback)((()=>{var e;const t=null===(e=w.current)||void 0===e?void 0:e.querySelector(".ag-body-viewport");t?t.scrollTo({top:0,behavior:"smooth"}):null===b||void 0===b||b.ensureIndexVisible(0,"top")}),[b]),L=(0,r.useMemo)((()=>n.map(It.oV).flat().length>0),[n]),D=(0,r.useCallback)((()=>{T(n,(e=>{A((0,sl.Jw)(e)),I()}))}),[I,T,A,n]),{theme:N}=(0,y.u)(),O=(0,a.Z)(),P=(0,r.useCallback)((e=>{let{value:t,colDef:n,column:r}=e;const a=O.formatMessage({id:"aQxQIF",defaultMessage:"(empty)"});return null===l||void 0===l?void 0:l(t||a,n.headerName||r.getId())}),[O,l]),H=(0,r.useMemo)((()=>(0,c.tZ)(y.T.Text,{bold:!0,children:h})),[h]);return(0,r.useEffect)((()=>{const e=[],{initialWidthGroupBy:t,initialWidthOutput:r,maxWidth:a,minWidth:l}=Bl;(0,ce.sq)()&&n.some((e=>(0,It.Fc)(e)))&&e.push({resizable:!1,pinned:!0,width:40,headerComponent:"ActionsColumnRenderer",cellRendererSelector:e=>{let{rowIndex:t}=e;return 0===t?{component:"ActionsCellRenderer",params:{displayAddNewInputsButton:L,onAddNewInputs:D}}:void 0},cellClass:"leading-column-cell"}),i.forEach(((n,r)=>{const s=r===i.length-1;e.push({resizable:!0,initialWidth:t,minWidth:l,maxWidth:a,headerName:n,valueGetter:e=>{let{data:t}=e;return t.groupByCellValues[n]},suppressMovable:!0,cellRenderer:"TextRendererCellRenderer",headerClass:s?"last-group-by-header-cell":void 0,cellRendererParams:{isGroupByColumn:!0},headerComponent:"GroupHeaderCellRenderer",headerComponentParams:{displayAddNewInputsButton:L,onAddNewInputs:D},colId:n,onCellClicked:P})})),n.forEach(((t,n)=>{const i=0===n;e.push({resizable:!0,initialWidth:r,minWidth:l,maxWidth:a,headerName:t.runName,colId:t.runUuid,valueGetter:e=>{let{data:n}=e;return n.cellValues[t.runUuid]},suppressMovable:!0,cellRenderer:"TextRendererCellRenderer",cellRendererParams:{run:t},headerComponent:"RunHeaderCellRenderer",headerComponentParams:{run:t,onDuplicateRun:E,onHideRun:M,onDatasetSelected:d,groupHeaderContent:i?H:null},onCellClicked:P})})),v(e)}),[n,i,M,E,d,D,L,P,H]),(0,r.useEffect)((()=>{if(!b)return;const e=n.some((e=>{var t;return(0,It.Fc)(e)||(null===(t=e.datasets)||void 0===t?void 0:t.length)>0}));b.setHeaderHeight(function(){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?40+(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?175:62):80}(k,e))}),[b,k,n]),(0,c.BX)("div",{css:Pl,ref:w,children:[(0,c.tZ)(Zr,{css:Xl(N),context:{highlightedText:u},rowHeight:190,onGridReady:e=>{let{api:t}=e;return x(t)},getRowId:e=>{let{data:t}=e;return t.key},suppressHorizontalScroll:!1,columnDefs:g,rowData:t,components:{TextRendererCellRenderer:Tl,GroupHeaderCellRenderer:Il,RunHeaderCellRenderer:wl,ActionsColumnRenderer:Nl,ActionsCellRenderer:Ol}}),B]})},Xl=e=>({".ag-row:not(.ag-row-first), .ag-body-viewport":{borderTop:`1px solid ${e.colors.borderDecorative}`},".ag-row-last":{borderBottom:`1px solid ${e.colors.borderDecorative}`},".ag-cell, .last-group-by-header-cell .header-group-cell":{borderRight:`1px solid ${e.colors.borderDecorative}`},".ag-cell-focus:not(.leading-column-cell)::after":{content:'""',position:"absolute",inset:0,boxShadow:`inset 0 0 0px 2px ${e.colors.blue300}`,pointerEvents:"none"}}),zl=(e,t)=>{const n=t.map((t=>{var n;return[t,null===(n=e[t])||void 0===n?void 0:n.toString()]})),r=n.map((e=>{let[,t]=e;return String(t)})).join(".");return{key:r,groupByValues:(0,s.fromPairs)(n)}},Ul=()=>{var e;return/mac/i.test(null===(e=window.navigator.userAgentData)||void 0===e?void 0:e.platform)||/mac/i.test(window.navigator.platform)},_l=Ul()?"metaKey":"ctrlKey",Vl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const{altOrOptKey:a=!1,ctrlOrCmdKey:i=!1,shiftKey:l=!1}=t;return(0,r.useEffect)((()=>{const t=t=>{if((!i||t[_l])&&(!a||t.altKey)&&(!l||t.shiftKey)&&t.key===e){n()&&t.preventDefault()}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)}),[e,n,i,a,l]),{isMacKeyboard:Ul}},Fl=e=>{let{noEvalTablesLogged:t,userDeselectedAllColumns:n,areRunsSelected:r,areTablesSelected:a}=e;return!a||!r||n||t},Wl=e=>{let{noEvalTablesLogged:t,userDeselectedAllColumns:n,areRunsSelected:r}=e;const[a,i]=r?t?[(0,c.tZ)(C.Z,{id:"sguNEF",defaultMessage:"No evaluation tables logged"}),(0,c.tZ)(C.Z,{id:"j7cj5r",defaultMessage:"Please log at least one table artifact containing evaluation data. <link>Learn more</link>.",values:{link:e=>(0,c.tZ)(y.T.Link,{openInNewTab:!0,href:"https://mlflow.org/docs/latest/python_api/mlflow.html?highlight=log_table#mlflow.log_table",target:"_blank",rel:"noopener noreferrer",children:e})}})]:n?[(0,c.tZ)(C.Z,{id:"owr9l2",defaultMessage:"No group by columns selected"}),(0,c.tZ)(C.Z,{id:"lJQEW4",defaultMessage:'Using controls above, select at least one "group by" column.'})]:[(0,c.tZ)(C.Z,{id:"ZvJTXB",defaultMessage:"No tables selected"}),(0,c.tZ)(C.Z,{id:"18/UVG",defaultMessage:"Using controls above, select at least one artifact containing table."})]:[(0,c.tZ)(C.Z,{id:"BFzsMn",defaultMessage:"No runs selected"}),(0,c.tZ)(C.Z,{id:"nPWZsh",defaultMessage:"Make sure that at least one experiment run is visible and available to compare"})];return(0,c.tZ)(m.HYy,{title:a,description:i})};var Kl={name:"1hetg88",styles:"max-width:300px"},jl={name:"111arwn",styles:"width:300px;min-width:300px"},$l={name:"1hetg88",styles:"max-width:300px"},Yl={name:"1hetg88",styles:"max-width:300px"},ql={name:"1ichkjj",styles:"height:100%;display:flex;justify-content:center;align-items:center"};const Ql=e=>{let{comparedRuns:t,updateSearchFacets:n,onDatasetSelected:o,viewState:d,updateViewState:u}=e;const p=(0,a.Z)(),{theme:h}=(0,y.u)(),g=(0,r.useMemo)((()=>t.filter((e=>{let{hidden:t}=e;return!t})).slice(0,10)),[t]),{selectedTables:v,groupByCols:b,outputColumn:x,setSelectedTables:Z,setGroupByCols:w,setOutputColumn:k}=((e,t)=>{const{artifactViewState:n={}}=e,[a,i]=(0,r.useState)(n.selectedTables||[]),[l,s]=(0,r.useState)(n.groupByCols||[]),[o,d]=(0,r.useState)(n.outputColumn||"");return(0,r.useEffect)((()=>t({artifactViewState:{selectedTables:a,groupByCols:l,outputColumn:o}})),[t,a,l,o]),{selectedTables:a,groupByCols:l,outputColumn:o,setSelectedTables:i,setGroupByCols:s,setOutputColumn:d}})(d,u),[R,M]=(0,r.useState)(!1),[E,T]=(0,r.useState)(""),[B,A]=(0,r.useState)(""),[I,L]=(0,r.useState)(!1),{isSyncingArtifacts:D,EvaluationSyncStatusElement:N}=(()=>{const{evaluationPendingDataByRunUuid:e,evaluationArtifactsBeingUploaded:t,evaluationDraftInputValues:n}=(0,S.v9)((e=>{let{evaluationData:t}=e;return t})),[a,i]=(0,r.useState)(!1),s=(0,S.I0)(),o=(0,r.useCallback)((()=>{s((0,sl.XT)())}),[s]),d=Object.values(e).flat().length,u=n.length,p=Object.values(t).filter((e=>Object.values(e).some((e=>e)))).length;(0,r.useEffect)((()=>{0===d&&i(!1)}),[d]);const m=(0,r.useCallback)((()=>(0===d||a||(i(!0),s((0,sl.RO)()).catch((e=>{l.default.logErrorAndNotifyUser(e)}))),!0)),[s,d,a]),{isMacKeyboard:h}=Vl("s",{ctrlOrCmdKey:!0},m),{theme:g}=(0,y.u)(),v=u>0&&0===d,b=d>0||v?(0,c.BX)("div",{css:(0,f.iv)({backgroundColor:g.colors.backgroundPrimary,border:`1px solid ${g.colors.border}`,padding:g.spacing.md,marginBottom:g.spacing.sm,display:"flex",justifyContent:"space-between",alignItems:"center"},""),children:[v?(0,c.tZ)(C.Z,{id:"EPcEi9",defaultMessage:"You have added rows with new input values, but you still need to evaluate the new data in order to save it."}):a?(0,c.tZ)(y.T.Text,{children:(0,c.tZ)(C.Z,{id:"NGsTf/",defaultMessage:"Synchronizing artifacts for {runsBeingSynchronizedCount} runs...",values:{runsBeingSynchronizedCount:(0,c.tZ)("strong",{children:p})}})}):(0,c.tZ)(y.T.Text,{children:(0,c.tZ)(C.Z,{id:"BWpQZ7",defaultMessage:'You have <strong>{unsyncedDataEntriesCount}</strong> unsaved evaluated {unsyncedDataEntriesCount, plural, =1 {value} other {values}}. Click "Save" button or press {keyCombination} keys to synchronize the artifact data.',values:{strong:e=>(0,c.tZ)("strong",{children:e}),unsyncedDataEntriesCount:d,keyCombination:h()?"\u2318CMD+S":"CTRL+S"}})}),(0,c.BX)("div",{css:(0,f.iv)({display:"flex",gap:g.spacing.sm},""),children:[(0,c.tZ)(y.B,{disabled:a,onClick:o,children:(0,c.tZ)(C.Z,{id:"kNTkr+",defaultMessage:"Discard"})})," ",d>0&&(0,c.tZ)(y.B,{loading:a,type:"primary",onClick:m,children:(0,c.tZ)(C.Z,{id:"nhqO2Z",defaultMessage:"Save"})})]})]}):null;return{isSyncingArtifacts:a,EvaluationSyncStatusElement:b}})(),O=(0,S.I0)();(0,r.useEffect)((()=>{(0,ce.sq)()&&O((0,Tt.cL)()).catch((e=>{l.default.logErrorAndNotifyUser((null===e||void 0===e?void 0:e.message)||e)}))}),[O]);const P=(0,r.useCallback)((e=>Z((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))),[Z]),H=(0,r.useCallback)((e=>w((t=>{const n=t.includes(e)?t.filter((t=>t!==e)):[...t,e];return L(0===n.length),n}))),[w]),X=(0,r.useMemo)((()=>g.map((e=>{let{runUuid:t}=e;return t}))),[g]),{evaluationArtifactsByRunUuid:z,evaluationPendingDataByRunUuid:U,evaluationDraftInputValues:_}=(0,S.v9)((e=>{let{evaluationData:t}=e;return t})),{tables:V,tablesByRun:F,noEvalTablesLogged:W}=(j=g,(0,r.useMemo)((()=>{const e=(0,s.fromPairs)(j.map((e=>{var t,n;const r=null===(t=e.tags)||void 0===t||null===(n=t[Y.yg])||void 0===n?void 0:n.value,a=new Set;if(r)try{JSON.parse(r).filter((e=>{let{type:t}=e;return t===K.yK.TABLE})).forEach((e=>{let{path:t}=e;a.add(t)}))}catch(i){if(i instanceof SyntaxError)throw new SyntaxError(`The "${Y.yg}" tag in "${e.runName}" run is malformed!`);throw i}return[e.runUuid,Array.from(a)]})).filter((e=>{let[,t]=e;return t.length>0}))),t=Array.from(new Set(Object.values(e).flat())),n=t.filter((t=>j.every((n=>{var r;let{runUuid:a}=n;return null===(r=e[a])||void 0===r?void 0:r.includes(t)})))),r=0===t.length;return{tables:t,tablesByRun:e,tablesIntersection:n,noEvalTablesLogged:r}}),[j]));var j;(0,r.useEffect)((()=>{V.length>0&&0===v.length&&Z([V[0]])}),[V,Z,v.length]);const $=(0,S.v9)((e=>{let{evaluationData:t,modelGateway:n}=e;return n.modelGatewayRoutesLoading||X.some((e=>v.some((n=>{var r;return null===(r=t.evaluationArtifactsLoadingByRunUuid[e])||void 0===r?void 0:r[n]}))))})),{columns:q}=(Q=z,G=X,J=v,(0,r.useMemo)((()=>{if(0===J.length||0===G.length)return{columns:[],columnsIntersection:[]};const e=G.map((e=>Object.values(Q[e]||{}).filter((e=>{let{path:t}=e;return J.includes(t)})))).flat(),t=e.filter((e=>{let{path:t}=e;return J.includes(t)})).map((e=>{let{columns:t}=e;return t})).flat(),n=Array.from(new Set(t)),r=n.filter((t=>e.every((e=>{let{columns:n}=e;return n.includes(t)}))));return{columns:n,columnsIntersection:r}}),[G,Q,J]));var Q,G,J;const ee=((e,t,n,a,i,l,o)=>(0,r.useMemo)((()=>{const r=[],d={},c={},u=[];for(const e of n){const t=l.map((t=>[t,e[t]])),n=t.map((e=>{let[,t]=e;return t})).join(".");c[n]=(0,s.fromPairs)(t),u.push(n)}const p={},m=a.map((t=>{const n=Object.values(e[t]||{}).filter((e=>{let{path:t}=e;return i.includes(t)})).map((e=>{let{entries:t}=e;return t})).flat();return[t,n]}));for(const[e,t]of m)for(const n of t){var h;const{key:t,groupByValues:r}=zl(n,l);if(Object.values(r).every((e=>!e)))continue;c[t]||(c[t]=r),(n[It.h]||n[It.i7])&&(p[t]||(p[t]={}),p[t][e]||(p[t][e]={isPending:!1,evaluationTime:parseFloat(n[It.h]),totalTokens:n[It.i7]?parseInt(n[It.i7],10):void 0})),d[t]||(d[t]={});const a=d[t];a[e]=a[e]||(null===(h=n[o])||void 0===h?void 0:h.toString())}for(const[e,n]of Object.entries(t))for(const t of n){var g;const{entryData:n,...r}=t,{key:a,groupByValues:i}=zl(n,l);if(Object.values(i).every((e=>!e)))continue;c[a]||(c[a]=i,u.push(a)),p[a]||(p[a]={}),p[a][e]=r,d[a]||(d[a]={});const s=d[a];s[e]=(null===(g=n[o])||void 0===g?void 0:g.toString())||s[e]}const f=(0,s.sortBy)(Object.entries(c),(e=>{let[t]=e;return!u.includes(t)}));for(const[e,t]of f){const n=r.find((t=>{let{key:n}=t;return e===n}));n&&d[e]?(n.cellValues=d[e],n.outputMetadataByRunUuid=p[e]):r.push({key:e,groupByCellValues:t,cellValues:d[e]||{},outputMetadataByRunUuid:p[e],isPendingInputRow:u.includes(e)})}return r}),[a,e,l,n,i,o,t]))(z,U,_,X,v,b,x),te=(0,r.useMemo)((()=>{const e=g.filter(It.Fc).map(It.oV).flat();if(!e.length)return null;return Array.from(new Set(e)).filter((e=>q.includes(e)))}),[g,q]);(0,r.useEffect)((()=>{g.every(It.Fc)&&w([])}),[w,g]),(0,r.useEffect)((()=>{if(v.length)for(const e of g){if(!e)continue;const t=(F[e.runUuid]||[]).filter((e=>v.includes(e)));for(const n of t)O((0,i.h$)(e.runUuid,n,!1)).catch((e=>{l.default.logErrorAndNotifyUser(e.message||e)}))}}),[g,O,v,F]);const ne=v.length>0,re=g.length>0,ae=!$&&ne&&re,ie=(0,r.useMemo)((()=>{if(!B.trim())return ee;const e=new RegExp(B,"i");return ee.filter((t=>{let{groupByCellValues:n}=t;return Object.values(n).some((t=>null===t||void 0===t?void 0:t.match(e)))}))}),[ee,B]),le=(0,r.useCallback)((e=>n((t=>({...t,runsHidden:[...t.runsHidden,e]})))),[n]);(0,r.useEffect)((()=>{if($||I)return;const e=b.length<1,t=b.some((e=>!q.includes(e))),n=q[0],r=te||(n?[n]:null);(e||t)&&r&&w(r)}),[$,I,b,x,q,w,te]);const se=(0,r.useMemo)((()=>q.filter((e=>!e.startsWith("MLFLOW_")))),[q]),oe=(0,r.useMemo)((()=>q.filter((e=>!b.includes(e)&&!e.startsWith("MLFLOW_")))),[q,b]);(0,r.useEffect)((()=>{if(b.includes(x)||!x){const e=oe.includes(It.JL)?It.JL:oe[0];k(e||"")}}),[b,x,oe,k]),(0,r.useEffect)((()=>{M(!0);const e=setTimeout((()=>A(E)),250);return()=>clearTimeout(e)}),[E]),(0,r.useEffect)((()=>{M(!1)}),[B]),(0,r.useEffect)((()=>{if(!oe.includes(x)){const e=oe.includes(It.JL)?It.JL:oe[0];k(e||"")}}),[x,oe,k]),(0,r.useEffect)((()=>{v.some((e=>!V.includes(e)))&&Z([])}),[v,V,Z]);const[de,ue]=(0,r.useState)(null),pe=(0,r.useCallback)(((e,t)=>{ue({value:e,header:t}),u({previewPaneVisible:!0})}),[u]);return(0,c.BX)("div",{css:(0,f.iv)({borderTop:`1px solid ${h.colors.border}`,borderLeft:`1px solid ${h.colors.border}`,marginLeft:-1,zIndex:1,height:"100%",display:"grid",gridTemplateColumns:d.previewPaneVisible?"1fr auto":"1fr",overflow:"hidden"},""),children:[(0,c.BX)("div",{css:(0,f.iv)({paddingLeft:h.spacing.sm,paddingTop:h.spacing.sm,height:"100%",display:"grid",gridTemplateRows:"auto auto 1fr",overflow:"hidden",rowGap:h.spacing.sm,backgroundColor:h.colors.backgroundSecondary},""),children:[(0,c.BX)("div",{css:(0,f.iv)({display:"flex",alignItems:"center",gap:h.spacing.sm,overflow:"hidden",height:h.general.heightSm},""),children:[(0,c.BX)(m.M6x,{label:(0,c.tZ)(C.Z,{id:"syyEiR",defaultMessage:"Table"}),multiSelect:!0,value:v,children:[(0,c.tZ)(m.Aa0,{css:(0,f.iv)({maxWidth:300,backgroundColor:h.colors.backgroundPrimary},""),"data-testid":"dropdown-tables",onClear:()=>Z([]),disabled:D||!re||W}),(0,c.tZ)(m.hJM,{css:Kl,children:(0,c.tZ)(m.X_T,{children:V.map((e=>(0,c.tZ)(m.VKe,{value:e,onChange:P,checked:v.includes(e),"data-testid":"dropdown-tables-option",children:e},e)))})})]}),(0,c.tZ)(y.e,{title:(0,c.tZ)(C.Z,{id:"VZRc73",defaultMessage:"Using the list of logged table artifacts, select at least one to start comparing results."}),children:(0,c.tZ)(y.f,{})})]}),$?(0,c.tZ)(m.Qck,{}):(0,c.BX)(c.HY,{children:[(0,c.BX)("div",{css:(0,f.iv)({display:"flex",columnGap:h.spacing.sm,alignItems:"center",overflow:"hidden",height:h.general.heightSm},""),children:[(0,c.tZ)(y.h,{prefix:(0,c.tZ)(m.W1M,{}),suffix:R&&(0,c.tZ)(y.S,{size:"small"}),css:jl,onChange:e=>T(e.target.value),value:E,placeholder:p.formatMessage({id:"3D2Znf",defaultMessage:"Filter by {columnNames}"},{columnNames:b.join(", ")}),allowClear:!0,disabled:!ae||D}),(0,c.BX)(m.M6x,{value:b,multiSelect:!0,label:(0,c.tZ)(C.Z,{id:"fWm1UC",defaultMessage:"Group by"}),children:[(0,c.tZ)(m.Aa0,{disabled:!ae||D,allowClear:!1,showTagAfterValueCount:1,css:(0,f.iv)({maxWidth:300,backgroundColor:h.colors.backgroundPrimary},""),"aria-label":'Select "group by" columns'}),(0,c.tZ)(m.hJM,{css:$l,children:(0,c.tZ)(m.X_T,{children:se.map((e=>(0,c.tZ)(m.VKe,{value:e,onChange:H,checked:b.includes(e),children:e},e)))})})]}),(0,c.BX)(m.M6x,{value:[x],label:(0,c.tZ)(C.Z,{id:"ZqGzZd",defaultMessage:"Compare"}),children:[(0,c.tZ)(m.Aa0,{disabled:!ae||D,allowClear:!1,css:(0,f.iv)({maxWidth:300,backgroundColor:h.colors.backgroundPrimary},"")}),(0,c.tZ)(m.hJM,{css:Yl,children:(0,c.tZ)(m.X_T,{children:oe.map((e=>(0,c.tZ)(m.PC4,{value:e,onChange:()=>k(e),checked:x===e,children:e},e)))})})]})]}),Fl({areRunsSelected:re,areTablesSelected:ne,noEvalTablesLogged:W,userDeselectedAllColumns:I})?(0,c.tZ)("div",{css:ql,children:(0,c.tZ)(Wl,{areRunsSelected:re,areTablesSelected:ne,noEvalTablesLogged:W,userDeselectedAllColumns:I})}):(0,c.tZ)("div",{css:(0,f.iv)({position:"relative",zIndex:1,overflowY:"hidden",height:"100%",backgroundColor:h.colors.backgroundPrimary},""),children:(0,c.tZ)(dl,{tableData:ee,outputColumn:x,children:(0,c.tZ)(Hl,{visibleRuns:g,groupByColumns:b,resultList:ie,onCellClick:pe,onHideRun:le,onDatasetSelected:o,highlightedText:B.trim(),isPreviewPaneVisible:d.previewPaneVisible,outputColumnName:x})})}),N]})]}),d.previewPaneVisible&&(0,c.tZ)(zr,{content:null===de||void 0===de?void 0:de.value,copyText:null===de||void 0===de?void 0:de.value,headerText:null===de||void 0===de?void 0:de.header,onClose:()=>u({previewPaneVisible:!1}),empty:(0,c.tZ)(m.HYy,{description:(0,c.tZ)(C.Z,{id:"lTngfr",defaultMessage:"Select a cell to display preview"})})})]})},Gl=()=>{const e=new Date;return e.setMilliseconds(0),e},Jl=r.memo((e=>{var t;const{experiments:n,runsData:a,onMaximizedChange:i}=e,{searchFacetsState:s,updateSearchFacets:o,isLoadingRuns:d,loadMoreRuns:u,moreRunsAvailable:p,isPristine:h,requestError:g}=Ie(),[v,y]=(0,r.useState)([]),[b,C]=(0,r.useState)(new Fr),{experiment_id:x}=n[0],Z=st(x),[w,S]=(0,r.useState)(null!==(t="true"===Z.getItem("expandRows"))&&void 0!==t&&t);(0,r.useEffect)((()=>{Z.setItem("expandRows",w)}),[w,Z]);const{paramKeyList:k,metricKeyList:R,tagsList:M,modelVersionsByRunUuid:E,paramsList:T,metricsList:B,runInfos:A,runUuidsMatchingFilter:I,datasetsList:L}=a,D=(0,r.useMemo)((()=>A.map(((e,t)=>({runInfo:e,params:T[t],metrics:B[t],tags:M[t],datasets:L[t]})))),[L,B,T,A,M]),{orderByKey:N,searchFilter:O,runsExpanded:P,runsPinned:H,compareRunsMode:X,runsHidden:z,datasetsFilter:U}=s,_=void 0!==X;((e,t,n,a,i)=>{(0,r.useEffect)((()=>{if(!n())return;const r=e.filter(ll).map((e=>{let{runInfo:t}=e;return t.run_uuid})),l=t.filter((e=>{var t;let{runDateAndNestInfo:n,runUuid:a}=e;return n.hasExpander&&"undefined"===typeof i[a]&&(null===(t=n.childrenIds)||void 0===t?void 0:t.some((e=>r.includes(e))))})).map((e=>{let{runUuid:t}=e;return t}));l.length&&a((e=>({...e,runsExpanded:l.reduce(((e,t)=>({...e,[t]:!0})),e.runsExpanded)})),{preservePristine:!0,replaceHistory:!0})}),[e,t,i,a,n])})(D,v,h,o,P);const V=(0,r.useCallback)((e=>C((t=>({...t,...e})))),[]),F=(0,r.useCallback)((()=>{V({columnSelectorVisible:!0})}),[V]),W=(0,r.useMemo)((()=>!N&&!O||N===Y.XZ.DATE),[N,O]),[K,j]=(0,r.useState)(Gl);(0,r.useEffect)((()=>{j(Gl)}),[A]);const $=(0,r.useMemo)((()=>l.default.getVisibleTagKeyList(M)),[M]),[q,Q]=(0,r.useState)(!1),[G,J]=(0,r.useState)();(0,r.useEffect)((()=>{if(d)return;const e=(0,Wr.zR)({experiments:n,paramKeyList:k,metricKeyList:R,modelVersionsByRunUuid:E,runsExpanded:P,tagKeyList:$,nestChildren:W,referenceTime:K,runData:D,runUuidsMatchingFilter:I,runsPinned:H,runsHidden:z});y(e)}),[D,d,n,R,E,k,P,$,W,K,H,z,I,g]);const[ee,te]=(0,m.Npd)(),ne=al(ee),re=(0,r.useCallback)((()=>{p&&!d&&u().then((e=>{ne(e,A)}))}),[p,d,u,A,ne]);(0,r.useEffect)((()=>{null===i||void 0===i||i(b.viewMaximized)}),[b.viewMaximized,i]);const ae=(0,r.useCallback)(((e,t)=>{J({datasetWithTags:e,runData:t}),Q(!0)}),[]);return(0,c.BX)(sn,{visibleRuns:v,children:[(0,c.tZ)(Cr,{viewState:b,updateViewState:V,runsData:a,searchFacetsState:s,updateSearchFacets:o,experimentId:x,requestError:g,expandRows:w,updateExpandRows:S}),(0,c.BX)("div",{css:(0,f.iv)({minHeight:225,height:"100%",display:"grid",position:"relative",gridTemplateColumns:_?b.runListHidden?"10px 1fr":"310px 1fr":"1fr"},""),children:[(0,c.tZ)(Ur,{experiments:n,runsData:a,searchFacetsState:s,viewState:b,isLoading:d,updateSearchFacets:o,updateViewState:V,onAddColumnClicked:F,rowsData:v,loadMoreRunsFunc:re,moreRunsAvailable:p,onDatasetSelected:ae,expandRows:w}),"CHART"===X&&(0,c.tZ)(nl,{isLoading:d,comparedRuns:v,metricKeyList:a.metricKeyList,paramKeyList:a.paramKeyList,experimentTags:a.experimentTags,searchFacetsState:s,updateSearchFacets:o}),"ARTIFACT"===X&&(0,ce.Hi)()&&(0,c.tZ)(Ql,{comparedRuns:v,viewState:b,updateViewState:V,updateSearchFacets:o,onDatasetSelected:ae}),te,G&&(0,c.tZ)(il.x,{isOpen:q,setIsOpen:Q,selectedDatasetWithRun:G,setSelectedDatasetWithRun:J})]})]})})),es={searchRunsApi:i.ht,loadMoreRunsApi:i.mx,searchRunsPayload:i.Yl,searchModelVersionsApi:Vr.nI},ts=(0,S.$j)(((e,t)=>({runsData:$(e,t)})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.experimentTagsByExperimentId===t.entities.experimentTagsByExperimentId&&e.entities.latestMetricsByRunUuid===t.entities.latestMetricsByRunUuid&&e.entities.modelVersionsByRunUuid===t.entities.modelVersionsByRunUuid&&e.entities.paramsByRunUuid===t.entities.paramsByRunUuid&&e.entities.runInfosByUuid===t.entities.runInfosByUuid&&e.entities.runUuidsMatchingFilter===t.entities.runUuidsMatchingFilter&&e.entities.tagsByRunUuid===t.entities.tagsByRunUuid})(Jl),ns=e=>{const{searchFacetsState:t}=Ie();return e.isLoading?(0,c.tZ)(m.Qck,{active:!0}):(0,c.tZ)(ts,{...e,modelVersionFilter:t.modelVersionFilter,lifecycleFilter:t.lifecycleFilter,datasetsFilter:t.datasetsFilter})},rs=e=>(0,c.tZ)(Ae,{actions:es,children:(0,c.tZ)(ns,{...e})}),as=r.memo(rs);var is={name:"1h8i7is",styles:"overflow-y:hidden;flex-shrink:0;transition:max-height .12s"};const ls=()=>{const e=(0,d.Z)(),t=de(),n=(a=t,(0,S.v9)((e=>a.map((t=>e.entities.experimentsById[t])).filter(Boolean)),((e,t)=>(0,s.isEqual)(e,t))));var a;const[o]=n,{fetchExperiments:u,isLoadingExperiment:p,requestError:f}=T(),{elementHeight:v,observeHeight:y}=(()=>{const[e,t]=(0,r.useState)(null),[n,a]=(0,r.useState)(void 0);return(0,r.useEffect)((()=>{if(!e||!window.ResizeObserver)return;const t=new ResizeObserver((e=>{let[t]=e;t.target.scrollHeight&&a(t.target.scrollHeight)}));return t.observe(e),()=>t.disconnect()}),[e]),{elementHeight:n,observeHeight:t}})(),[C,x]=(0,r.useState)(!1);(0,r.useEffect)((()=>{u(t)}),[u,t]),(0,r.useEffect)((()=>{const n=(0,i.wn)(t);e(n).catch((e=>{l.default.logErrorAndNotifyUser(e)}))}),[e,t]);const w=t.length>1;if(f&&f.getErrorCode()===h.SM.PERMISSION_DENIED)return(0,c.tZ)(b,{errorMessage:f.getMessageField()});if(f&&f.getErrorCode()===h.SM.RESOURCE_DOES_NOT_EXIST)return(0,c.tZ)(g.Z,{});const k=p||!n[0];return(0,c.BX)("div",{css:ss.experimentViewWrapper,children:[k?(0,c.tZ)(m.Qck,{title:!0,paragraph:!1,active:!0}):(0,c.tZ)(c.HY,{children:w?(0,c.tZ)(W,{experiments:n}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(V,{experiment:o}),(0,c.tZ)("div",{style:{maxHeight:C?0:v},css:is,children:(0,c.BX)("div",{ref:y,children:[(0,c.tZ)(Z,{experiment:o}),(0,c.tZ)(B,{experiment:o})]})})]})}),(0,c.tZ)(as,{experiments:n,isLoading:k,onMaximizedChange:x})]})},ss={experimentViewWrapper:{height:"100%",display:"flex",flexDirection:"column"}};const os={setExperimentTagApi:i.Yp,getExperimentApi:i.eu,setCompareExperiments:i.MY},ds=()=>{const{formatMessage:e}=(0,a.Z)();return(0,r.useEffect)((()=>{const t=e({id:"5GCYzy",defaultMessage:"Experiment Runs - Databricks"});l.default.updatePageTitle(t)}),[e]),(0,c.tZ)(p,{actions:os,children:(0,c.tZ)(ls,{})})};var cs=ds},9319:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(80004)).default;t.Z=a}}]);
//# sourceMappingURL=86.cb8be0d3.chunk.js.map